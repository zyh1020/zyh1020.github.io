"use strict";(self.webpackChunkvuepress_theme_hope_template=self.webpackChunkvuepress_theme_hope_template||[]).push([[5417],{5095:(s,i,a)=>{a.r(i),a.d(i,{comp:()=>l,data:()=>p});var n=a(641);const e={},l=(0,a(6262).A)(e,[["render",function(s,i){return(0,n.uX)(),(0,n.CE)("div",null,i[0]||(i[0]=[(0,n.Fv)('<h3 id="一-常见命令" tabindex="-1"><a class="header-anchor" href="#一-常见命令"><span>一，常见命令</span></a></h3><h4 id="_1-1-ls命令" tabindex="-1"><a class="header-anchor" href="#_1-1-ls命令"><span>1.1 ls命令</span></a></h4><p>ls命令：查看目录下的节点信息，</p><p>命令格式：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ls</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [-s] [-w] [-R] path</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>-s</code>：显示节点详情，包括状态信息</li><li><code>-w</code>：添加一个watch监视器</li><li><code>-R</code>：列举出节点的级联节点</li><li><code>path</code>：显示某目录下节点/文件</li></ul><p>例如：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 9] ls  /zookeeper </span></span>\n<span class="line"><span>[config, quota]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 11] ls -R /zookeeper </span></span>\n<span class="line"><span>/zookeeper</span></span>\n<span class="line"><span>/zookeeper/config</span></span>\n<span class="line"><span>/zookeeper/quota</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 10] ls -s /zookeeper </span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[config, quota]</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cZxid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0x0</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ctime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Thu</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jan</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 01</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UTC</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1970</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mZxid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0x0</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mtime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Thu</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jan</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 01</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 00:00:00</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UTC</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1970</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pZxid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0x0</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cversion</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -2</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dataVersion</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">aclVersion</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ephemeralOwner</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0x0</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dataLength</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">numChildren</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>cZxid：创建节点的事务 zxid 每次修改 ZooKeeper 状态都会产生一个 ZooKeeper 事务 ID。事务 ID 是 ZooKeeper 中所 有修改总的次序。每次修改都有唯一的 zxid，如果 zxid1 小于 zxid2，那么 zxid1 在 zxid2 之 前发生。</li><li>ctime：znode 被创建的毫秒数（从 1970 年开始）</li><li>mZxid：znode 最后更新的事务 zxid</li><li>mtime：znode 最后修改的毫秒数（从 1970 年开始）</li><li>pZxid：znode 最后更新的子节点 zxid 尚硅谷技术之</li><li>cversion：znode 子节点变化号，znode 子节点修改次数</li><li>dataversion：znode 数据变化号</li><li>aclVersion：znode 访问控制列表的变化号</li><li>ephemeralOwner：如果是临时节点，这个是 znode 拥有者的 session id。如果不是临时节点则是 0。</li><li>dataLength：znode 的数据长度</li><li>numChildren：znode 子节点数量</li></ul><blockquote><p>cZxid和mZxid和pZxid可以判断出请求执行的全局顺序</p><p>cversion和dataversion和aclVersion 基于CAS理论保证分布式数据的原子性</p></blockquote><h4 id="_1-2-stat命令" tabindex="-1"><a class="header-anchor" href="#_1-2-stat命令"><span>1.2 stat命令</span></a></h4><p>stat命令：查看节点状态。</p><p>命令格式：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>stat [-w] path</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>-w</code>：添加watch</li><li><code>path</code>：查看某目录下节点的状态</li></ul><p>例如：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 12] stat /zookeeper </span></span>\n<span class="line"><span>cZxid = 0x0</span></span>\n<span class="line"><span>ctime = Thu Jan 01 00:00:00 UTC 1970</span></span>\n<span class="line"><span>mZxid = 0x0</span></span>\n<span class="line"><span>mtime = Thu Jan 01 00:00:00 UTC 1970</span></span>\n<span class="line"><span>pZxid = 0x0</span></span>\n<span class="line"><span>cversion = -2</span></span>\n<span class="line"><span>dataVersion = 0</span></span>\n<span class="line"><span>aclVersion = 0</span></span>\n<span class="line"><span>ephemeralOwner = 0x0</span></span>\n<span class="line"><span>dataLength = 0</span></span>\n<span class="line"><span>numChildren = 2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>各个参数含义参考<code>ls -s</code> 输出信息。</p><h4 id="_2-3-create命令" tabindex="-1"><a class="header-anchor" href="#_2-3-create命令"><span>2.3 create命令</span></a></h4><p>create命令：创建节点，默认持久节点</p><p>命令格式：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>create [-s] [-e] [-c] [-t ttl] path [data] [acl]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><code>-s</code>：有序节点</li><li><code>-e</code>：临时节点，不加默认是持久节点</li><li><code>-t ttl</code>：带过期时间节点，比如：<code>create ‐t 10 /ttl</code>，默认禁用，需要在 zoo.cfg中添加 <code>extendedTypesEnabled=true</code> 开启。 注意：ttl不能用于临时节点 。</li></ul><p>Znode一般分为 4种类型：</p><ul><li>持久的（persistent）</li><li>临时的（ephemeral）</li><li>持久有序的（persistent_sequential）</li><li>临时有序的（ephemeral_sequential）</li></ul><p>例如：</p><p>创建持久节点：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 12] create /p_node1</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Created</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /p_node1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>创建临时节点：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 5] create -e /p_node1/e_node1</span></span>\n<span class="line"><span>Created /p_node1/e_node1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>创建顺序节点：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 16] create -s  /p_node1/</span></span>\n<span class="line"><span>Created /p_node1/0000000000</span></span>\n<span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 17] create -s  /p_node1/</span></span>\n<span class="line"><span>Created /p_node1/0000000001</span></span>\n<span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 18] create -s  /p_node1/seq_</span></span>\n<span class="line"><span>Created /p_node1/seq_0000000002</span></span>\n<span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 19] create -s  /p_node1/seq_</span></span>\n<span class="line"><span>Created /p_node1/seq_0000000003</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-4-set命令" tabindex="-1"><a class="header-anchor" href="#_2-4-set命令"><span>2.4 set命令</span></a></h4><p>set命令：修改节点内容</p><p>命令格式：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>set [-s] [-v version] path data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>-s：更新节点数据并显示节点状态信息</li><li>-v 指定数据版本号，如果指定的数据版本号和数据当前版本号不一致，则更新失败。</li></ul><p>例如：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 36] set /p_node1/e_node1 &quot;set data1&quot;</span></span>\n<span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 37] set -s /p_node1/e_node1 &quot;set data2&quot;</span></span>\n<span class="line"><span>cZxid = 0x6c</span></span>\n<span class="line"><span>ctime = Fri May 13 09:55:49 UTC 2022</span></span>\n<span class="line"><span>mZxid = 0x80</span></span>\n<span class="line"><span>mtime = Fri May 13 10:15:46 UTC 2022</span></span>\n<span class="line"><span>pZxid = 0x6c</span></span>\n<span class="line"><span>cversion = 0</span></span>\n<span class="line"><span>dataVersion = 6</span></span>\n<span class="line"><span>aclVersion = 0</span></span>\n<span class="line"><span>ephemeralOwner = 0x100002513c80001</span></span>\n<span class="line"><span>dataLength = 9</span></span>\n<span class="line"><span>numChildren = 0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-5-get命令" tabindex="-1"><a class="header-anchor" href="#_2-5-get命令"><span>2.5 get命令</span></a></h4><p>get命令：获取节点/文件内容</p><p>命令格式：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>get [-s] [-w] path</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>-s：查看节点数据以及节点状态信息</li><li>-w 添加一个watch，节点数据变更时，会通知客户端（通知是一次性的）。</li></ul><p>例如：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 38] get /p_node1/e_node1</span></span>\n<span class="line"><span>set data2</span></span>\n<span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 39] get -s /p_node1/e_node1</span></span>\n<span class="line"><span>set data2</span></span>\n<span class="line"><span>cZxid = 0x6c</span></span>\n<span class="line"><span>ctime = Fri May 13 09:55:49 UTC 2022</span></span>\n<span class="line"><span>mZxid = 0x80</span></span>\n<span class="line"><span>mtime = Fri May 13 10:15:46 UTC 2022</span></span>\n<span class="line"><span>pZxid = 0x6c</span></span>\n<span class="line"><span>cversion = 0</span></span>\n<span class="line"><span>dataVersion = 6</span></span>\n<span class="line"><span>aclVersion = 0</span></span>\n<span class="line"><span>ephemeralOwner = 0x100002513c80001</span></span>\n<span class="line"><span>dataLength = 9</span></span>\n<span class="line"><span>numChildren = 0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-6-删除节点" tabindex="-1"><a class="header-anchor" href="#_2-6-删除节点"><span>2.6 删除节点</span></a></h4><p>delete命令：只能删除没有子节点的节点。如果其有子节点时，无法删除</p><p>命令格式：<code>delete [-v version] path</code></p><p>deleteall命令：级联删除该节点和子节点。</p><p>命令格式：<code>deleteall path [-b batch size]</code></p><p>例如：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 43] delete /p_node2/seq_0000000002</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 44] ls -R /p_node2</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/p_node2</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/p_node2/0000000000</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/p_node2/0000000001</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/p_node2/seq_0000000003</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 45] deleteall /p_node2</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 46] ls -R /p_node2</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Node</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> does</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> exist:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /p_node2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-7-其它命令" tabindex="-1"><a class="header-anchor" href="#_2-7-其它命令"><span>2.7 其它命令</span></a></h4><ul><li>history：显示最近执行的11条命令的历史记录</li><li>getAllChildrenNumber：获取节点下的所有子孙节点数量</li><li>getEphemerals：获取当前客户端创建的所有临时节点</li></ul><h3 id="二-监听命令" tabindex="-1"><a class="header-anchor" href="#二-监听命令"><span>二，监听命令</span></a></h3><h4 id="_2-1-监听节点目录变化" tabindex="-1"><a class="header-anchor" href="#_2-1-监听节点目录变化"><span>2.1 监听节点目录变化</span></a></h4><p>监听节点目录变化：监听节点的子节点变化，当子节点发生改变时触发。</p><p>命令格式：<code>ls -w path</code></p><p>例如：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#创建节点</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 13] create /watch_node</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Created</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /watch_node</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#监听节点目录变化</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 14] ls -w /watch_node</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[]</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 15] create /watch_node/w1 data1</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WATCHER::</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WatchedEvent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state:SyncConnected</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type:NodeChildrenChanged</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> path:/watch_node</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Created</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /watch_node/w1</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 17] create /watch_node/w2 data2</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Created</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /watch_node/w2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>一次性监听，触发后会被删除，无法再次触发。</p><h4 id="_2-2-监听节点数据变化" tabindex="-1"><a class="header-anchor" href="#_2-2-监听节点数据变化"><span>2.2 监听节点数据变化</span></a></h4><p>监听节点数据变化：当该节点数据发生改变时触发。子节点的数据变化不会触发。</p><p>命令格式：<code>get -w path</code></p><p>例如：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 监听节点数据变化</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 18] get -w /watch_node </span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">null</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 19] set /watch_node data</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WATCHER::</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WatchedEvent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state:SyncConnected</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type:NodeDataChanged</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> path:/watch_node</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 20] set /watch_node data2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>一次性监听，触发后会被删除，无法再次触发。</p><h4 id="_2-3-永久监听" tabindex="-1"><a class="header-anchor" href="#_2-3-永久监听"><span>2.3 永久监听</span></a></h4><p>在 Zookeeper 3.6.0版本之后，客户端可以在节点上创建永久监听，永久监听在被触发后不会被删除。</p><p>命令格式：<code>addWatch [-m mode] path</code></p><p>永久监听在创建时可以通过 -m 指定模式，模式分为两种：</p><ul><li>PERSISTENT：该节点的数据变化以及子节点的变化会触发相应事件，子节点的数据变化不会触发。</li><li>PERSISTENT_RECURSIVE：该节点的数据变化以及所有子孙节点的目录或者数据变化都会触发相应事件，不指定默认使用 PERSISTENT_RECURSIVE模式。</li></ul><p>例如：</p><p>PERSISTENT模式：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 29] create /watch_node2</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 监听节点 PERSISTENT   </span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 30] addWatch -m PERSISTENT /watch_node2   </span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 31] set /watch_node2 data1</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WATCHER::</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WatchedEvent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state:SyncConnected</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type:NodeDataChanged</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> path:/watch_node2</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 32] create /watch_node2/w1 data</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WATCHER::Created</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /watch_node2/w1</span></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WatchedEvent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state:SyncConnected</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type:NodeChildrenChanged</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> path:/watch_node2</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#子节点的数据变化不会触发</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 33] set /watch_node2/w1 data1</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 34] delete /watch_node2/w1</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WATCHER::</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WatchedEvent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state:SyncConnected</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type:NodeChildrenChanged</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> path:/watch_node2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>PERSISTENT_RECURSIVE模式</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 39] create /watch_node3</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 监听节点 PERSISTENT_RECURSIVE  </span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 40] addWatch -m PERSISTENT_RECURSIVE /watch_node3</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 41] set /watch_node3 data1</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WATCHER::</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WatchedEvent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state:SyncConnected</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type:NodeDataChanged</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> path:/watch_node3</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 42] create /watch_node3/w1 </span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WATCHER::</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WatchedEvent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state:SyncConnected</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type:NodeCreated</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> path:/watch_node3/w1</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Created</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /watch_node3/w1</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#子节点的数据变化也会触发</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 43] set /watch_node3/w1 data1</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WATCHER::</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WatchedEvent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state:SyncConnected</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type:NodeDataChanged</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> path:/watch_node3/w1</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 44]  delete /watch_node3/w1</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WATCHER::</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WatchedEvent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state:SyncConnected</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type:NodeDeleted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> path:/watch_node3/w1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="三-acl命令" tabindex="-1"><a class="header-anchor" href="#三-acl命令"><span>三，ACL命令</span></a></h3><h4 id="_3-1-acl总体构成" tabindex="-1"><a class="header-anchor" href="#_3-1-acl总体构成"><span>3.1 ACL总体构成</span></a></h4><p>Zookeeper 的 ACL(Access Control List)，分为三个维度：scheme、id、permission。</p><p>通常表示为：<code>scheme:id:permission</code>来构成权限列表。</p><ul><li>scheme：代表采用某种权限机制</li><li>id：代表允许访问的用户</li><li>permissions：代表权限（组合字符串）</li></ul><h5 id="_3-1-1-scheme-权限策略" tabindex="-1"><a class="header-anchor" href="#_3-1-1-scheme-权限策略"><span>3.1.1 scheme：权限策略</span></a></h5><ul><li>world : world下只有一个id，即只有一个用户，也就是anyone，那么组合的写法就是<code>world:anyone:[permissions]</code>。 <code>world:anyone</code> 代表任何人，zookeeper 中对所有人有权限的结点就是属于<code> world:anyone</code> 的。</li><li>auth：代表认证登录，需要注册用户有权限就可以，使用的是明文密码，形式为<code>auth:user:password:[permissions]</code>。</li><li>它不需要 id, 只要是通过 authentication 的 user 都有权限（zookeeper 支持通过 kerberos来进行 authencation，也支持 username/password 形式的 authentication)。</li><li>digest：需要对密码加密才能访问，使用的是加密密码，组合形式为</li><li>digest: <code>username:BASE64(SHA1(password)):[permissions]</code>。</li><li>ip：它对应的 id 为客户机的 IP 地址，设置的时候可以设置一个 ip 段，此时限制ip进行访问。比如ip:192.168.1.1:[permissions]</li><li>super：代表超级管理员，拥有所有的权限</li></ul><h5 id="_3-1-2-id-用户" tabindex="-1"><a class="header-anchor" href="#_3-1-2-id-用户"><span>3.1.2 id：用户</span></a></h5><p>id 是验证模式，不同的 scheme，id 的值也不一样。默认为anyone。s</p><ul><li>scheme 为 auth 时，id为：<code>username:password</code></li><li>scheme 为 digest 时，id为：<code>username:BASE64(SHA1(password))</code></li><li>scheme 为 ip 时，id为：客户端的 ip 地址。</li><li>scheme 为 world 时，id为：anyone</li></ul><h5 id="_3-1-3-permission-权限" tabindex="-1"><a class="header-anchor" href="#_3-1-3-permission-权限"><span>3.1.3 permission：权限</span></a></h5><p>Zookeeper定义了五种权限：</p><ul><li>CREATE：创建子节点的权限。允许创建子节点；</li><li>DELETE：删除节点的权限。允许删除子节点；</li><li>READ：读取节点数据的权限。允许从节点获取数据并列出其子节点；</li><li>WRITE：修改节点数据的权限。允许为节点设置数据；</li><li>ADMIN：设置子节点权限的权限，允许为节点设置权限。</li></ul><p>CREATE、READ、WRITE、DELETE、ADMIN 也就是增、删、改、查、管理权限，这 5 种权限简写为 crwda（即单词的首字符缩写）。</p><h4 id="_3-2-acl命令操作" tabindex="-1"><a class="header-anchor" href="#_3-2-acl命令操作"><span>3.2 ACL命令操作</span></a></h4><h5 id="_3-2-1-getacl命令" tabindex="-1"><a class="header-anchor" href="#_3-2-1-getacl命令"><span>3.2.1 getAcl命令</span></a></h5><p>getAcl命令：查看指定节点 ACL信息</p><p>命令格式：<code>getAcl [-s] path</code>，-s：查看节点详细信息</p><p>例如：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 15] getAcl /p_node1 </span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&#39;world,&#39;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">anyone</span></span>\n<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cdrwa</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 17] getAcl -s /p_node1 </span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&#39;world,&#39;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">anyone</span></span>\n<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cdrwa</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cZxid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0x67</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ctime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Fri</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> May</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 13</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 09:53:38</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UTC</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2022</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mZxid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0x67</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mtime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Fri</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> May</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 13</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 09:53:38</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UTC</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2022</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pZxid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0x83</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cversion</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 6</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dataVersion</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">aclVersion</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ephemeralOwner</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0x0</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dataLength</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">numChildren</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-2-2-setacl命令" tabindex="-1"><a class="header-anchor" href="#_3-2-2-setacl命令"><span>3.2.2 setAcl命令</span></a></h5><p>setAcl命令：设置指定节点的ACL 信息</p><p>命令格式：<code>setAcl [-s] [-v version] [-R] path acl</code></p><p>例如：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 21] create /testAcl</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Created</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /testAcl</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 设置该节点的 acl 权限</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 22] setAcl /testAcl world:anyone:crwa </span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 23] getAcl /testAcl</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&#39;world,&#39;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">anyone</span></span>\n<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> crwa</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建子节点</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 24] create /testAcl/xyz </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot; xyz-data&quot;</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Created</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /testAcl/xyz</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 由于没有 d 权限，所以提示无法删除</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 25] delete /testAcl/xyz</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Insufficient</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> permission</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /testAcl/xyz</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-2-3-addauth命令" tabindex="-1"><a class="header-anchor" href="#_3-2-3-addauth命令"><span>3.2.3 addauth命令</span></a></h5><p>addauth命令：添加认证用户</p><p>命令格式：<code>addauth scheme auth</code></p><ul><li>scheme：（digest：是授权方式）格式为：<code>digest username:password</code></li><li>auth：就是分配权限， crwda。如果不写时表示创建用户，可以通过setAcl命令来设置权限</li></ul><p>案例1：我们创建一个用户，并分配权限：</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 27] addauth digest charge_admin:123456 crwda</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[zk: 192.168.198.110:2181(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">CONNECTED</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 28] addauth digest charge_crw:123456 crw</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>案例2：给某个节点，设置用户，用户只能在分配的权限内操作</p><div class="language-shs line-numbers-mode" data-highlighter="shiki" data-ext="shs" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shs"><span class="line"><span># 添加一个用户</span></span>\n<span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 13] addauth digest user1:123456</span></span>\n<span class="line"><span># 给节点设置用户权限</span></span>\n<span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 14] setAcl /testAcl auth:user1:123456:crwa</span></span>\n<span class="line"><span># 查看节点权限，密码是以密文的形式存储的</span></span>\n<span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 15] getAcl /testAcl</span></span>\n<span class="line"><span>&#39;digest,&#39;user1:HYGa7IZRm2PUBFiFFu8xY2pPP/s=</span></span>\n<span class="line"><span>: crwa</span></span>\n<span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 16] create /testAcl/ztest &quot;data&quot;</span></span>\n<span class="line"><span>Created /testAcl/ztest</span></span>\n<span class="line"><span># 由于用户没有 d 权限，所以提示无法删除</span></span>\n<span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 17] delete /testAcl/ztest</span></span>\n<span class="line"><span>Insufficient permission : /testAcl/ztest</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们 quit退出后，重新进入客户端，操作 /testAcl节点</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>#没有用户权限无法访问</span></span>\n<span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 0] ls /testAcl</span></span>\n<span class="line"><span>Insufficient permission : /testAcl</span></span>\n<span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 1] create /testAcl/ztest2</span></span>\n<span class="line"><span>Insufficient permission : /testAcl/ztest2</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span># 重新新增权限后可以访问了</span></span>\n<span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 2] addauth digest user1:123456</span></span>\n<span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 3] create /testAcl/ztest2</span></span>\n<span class="line"><span>Created /testAcl/ztest2</span></span>\n<span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 4] ls -R /testAcl</span></span>\n<span class="line"><span>/testAcl</span></span>\n<span class="line"><span>/testAcl/xyz</span></span>\n<span class="line"><span>/testAcl/ztest</span></span>\n<span class="line"><span>/testAcl/ztest2</span></span>\n<span class="line"><span># 由于用户没有 d 权限，所以提示无法删除</span></span>\n<span class="line"><span>[zk: 192.168.198.110:2181(CONNECTED) 5] delete /testAcl/ztest2</span></span>\n<span class="line"><span>Insufficient permission : /testAcl/ztest2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>转发：<a href="https://blog.csdn.net/qq_42402854/article/details/124775663" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/qq_42402854/article/details/124775663</a></p>',116)]))}]]),p=JSON.parse('{"path":"/blog/zookeeper/zookeeper%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4.html","title":"zookeeper常用命令","lang":"zh-CN","frontmatter":{"icon":"file-lines","title":"zookeeper常用命令","author":"Ms.Zyh","date":"2022-04-10T00:00:00.000Z","category":["zookeeper"],"tag":["必看","zookeeper"],"sticky":false,"star":false,"description":"一，常见命令 1.1 ls命令 ls命令：查看目录下的节点信息， 命令格式： -s：显示节点详情，包括状态信息 -w：添加一个watch监视器 -R：列举出节点的级联节点 path：显示某目录下节点/文件 例如： cZxid：创建节点的事务 zxid 每次修改 ZooKeeper 状态都会产生一个 ZooKeeper 事务 ID。事务 ID 是 Zoo...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"zookeeper常用命令\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-04-10T00:00:00.000Z\\",\\"dateModified\\":\\"2025-09-06T08:18:22.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Ms.Zyh\\"}]}"],["meta",{"property":"og:url","content":"http://img.zouyh.top/vuepress/blog/zookeeper/zookeeper%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4.html"}],["meta",{"property":"og:site_name","content":"Mr.Zyh"}],["meta",{"property":"og:title","content":"zookeeper常用命令"}],["meta",{"property":"og:description","content":"一，常见命令 1.1 ls命令 ls命令：查看目录下的节点信息， 命令格式： -s：显示节点详情，包括状态信息 -w：添加一个watch监视器 -R：列举出节点的级联节点 path：显示某目录下节点/文件 例如： cZxid：创建节点的事务 zxid 每次修改 ZooKeeper 状态都会产生一个 ZooKeeper 事务 ID。事务 ID 是 Zoo..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-09-06T08:18:22.000Z"}],["meta",{"property":"article:author","content":"Ms.Zyh"}],["meta",{"property":"article:tag","content":"zookeeper"}],["meta",{"property":"article:tag","content":"必看"}],["meta",{"property":"article:published_time","content":"2022-04-10T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-09-06T08:18:22.000Z"}]]},"git":{"createdTime":1755935409000,"updatedTime":1757146702000,"contributors":[{"name":"zyh1020","username":"zyh1020","email":"898362059@qq.pcom","commits":2,"url":"https://github.com/zyh1020"}]},"readingTime":{"minutes":9.38,"words":2813},"filePathRelative":"blog/zookeeper/zookeeper常用命令.md","excerpt":"<h3>一，常见命令</h3>\\n<h4>1.1 ls命令</h4>\\n<p>ls命令：查看目录下的节点信息，</p>\\n<p>命令格式：</p>\\n<div class=\\"language-sh line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"sh\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code class=\\"language-sh\\"><span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">ls</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> [-s] [-w] [-R] path</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div></div></div>","autoDesc":true}')}}]);