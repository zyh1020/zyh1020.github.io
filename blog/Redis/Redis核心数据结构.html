<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.24" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.94" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Redisæ ¸å¿ƒæ•°æ®ç»“æ„","image":["http://img.zouyh.top/article-img/20240917135015195.png","http://img.zouyh.top/article-img/20240917135016196.png","http://img.zouyh.top/article-img/20240917135016199.png","http://img.zouyh.top/article-img/20240917135016197.png","http://img.zouyh.top/article-img/20240917135014192.png","http://img.zouyh.top/article-img/20240917135013186.png"],"datePublished":"2022-04-10T00:00:00.000Z","dateModified":"2025-09-06T08:18:22.000Z","author":[{"@type":"Person","name":"Ms.Zyh"}]}</script><meta property="og:url" content="http://img.zouyh.top/blog/Redis/Redis%E6%A0%B8%E5%BF%83%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.html"><meta property="og:site_name" content="Mr.Zyh"><meta property="og:title" content="Redisæ ¸å¿ƒæ•°æ®ç»“æ„"><meta property="og:description" content="æ•°æ®ç±»å‹å’Œå¯¹åº”çš„æ•°æ®ç»“æ„ï¼š ä¸€ï¼ŒString 1.1 å¸¸è§å‘½ä»¤ redisçš„é”®æ˜¯Stringç±»å‹ï¼š redisçš„å€¼æ˜¯Stringç±»å‹ï¼š 1.2 åº”ç”¨åœºæ™¯ ç¼“å­˜å¯¹è±¡ï¼šç›´æ¥ç¼“å­˜æ•´ä¸ªå¯¹è±¡çš„ JSON æˆ–è€… é‡‡ç”¨å°† key è¿›è¡Œåˆ†ç¦»ä¸º user:ID:å±æ€§ å¸¸è§„è®¡æ•°: Redis å¤„ç†å‘½ä»¤æ˜¯å•çº¿ç¨‹ï¼Œæ‰€ä»¥æ‰§è¡Œå‘½ä»¤çš„è¿‡ç¨‹æ˜¯åŸå­æˆ–è€…ä½¿ç”¨luaè„šæœ¬æ‰§è¡Œå¤šæ¡å‘½ä»¤ä¹Ÿæ˜¯åŸå­..."><meta property="og:type" content="article"><meta property="og:image" content="http://img.zouyh.top/article-img/20240917135015195.png"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-09-06T08:18:22.000Z"><meta property="article:author" content="Ms.Zyh"><meta property="article:tag" content="Redis"><meta property="article:tag" content="æ¨è"><meta property="article:published_time" content="2022-04-10T00:00:00.000Z"><meta property="article:modified_time" content="2025-09-06T08:18:22.000Z"><link rel="icon" href="http://zouyh.top/favicon.png"><title>Redisæ ¸å¿ƒæ•°æ®ç»“æ„ | Mr.Zyh</title><meta name="description" content="æ•°æ®ç±»å‹å’Œå¯¹åº”çš„æ•°æ®ç»“æ„ï¼š ä¸€ï¼ŒString 1.1 å¸¸è§å‘½ä»¤ redisçš„é”®æ˜¯Stringç±»å‹ï¼š redisçš„å€¼æ˜¯Stringç±»å‹ï¼š 1.2 åº”ç”¨åœºæ™¯ ç¼“å­˜å¯¹è±¡ï¼šç›´æ¥ç¼“å­˜æ•´ä¸ªå¯¹è±¡çš„ JSON æˆ–è€… é‡‡ç”¨å°† key è¿›è¡Œåˆ†ç¦»ä¸º user:ID:å±æ€§ å¸¸è§„è®¡æ•°: Redis å¤„ç†å‘½ä»¤æ˜¯å•çº¿ç¨‹ï¼Œæ‰€ä»¥æ‰§è¡Œå‘½ä»¤çš„è¿‡ç¨‹æ˜¯åŸå­æˆ–è€…ä½¿ç”¨luaè„šæœ¬æ‰§è¡Œå¤šæ¡å‘½ä»¤ä¹Ÿæ˜¯åŸå­...">
    <link rel="stylesheet" href="/assets/css/styles.96075cde.css">
    <link rel="preload" href="/assets/js/runtime~app.5ca44e20.js" as="script"><link rel="preload" href="/assets/css/styles.96075cde.css" as="style"><link rel="preload" href="/assets/js/5967.f6df6183.js" as="script"><link rel="preload" href="/assets/js/app.5f1f45af.js" as="script">
    <link rel="prefetch" href="/assets/js/blog_zookeeper_zookeeperæºç è§£æ.html.794c4315.js" as="script"><link rel="prefetch" href="/assets/js/blog_Spring_springçš„AOPåŸç†è§£æ.html.ced3ccbc.js" as="script"><link rel="prefetch" href="/assets/js/blog_Spring_springçš„IOCåŠ è½½æ•´ä½“æµç¨‹.html.fceab284.js" as="script"><link rel="prefetch" href="/assets/js/blog_è®¾è®¡æ¨¡å¼_ç»“æ„æ¨¡å¼-ä»£ç†æ¨¡å¼.html.32e840fd.js" as="script"><link rel="prefetch" href="/assets/js/blog_Mybatis_mybatisæºç è§£æMappé…ç½®æ–‡ä»¶.html.2199732c.js" as="script"><link rel="prefetch" href="/assets/js/blog_Mybatis_mybatisæºç è§£ææ ¸å¿ƒé…ç½®æ–‡ä»¶.html.3c560625.js" as="script"><link rel="prefetch" href="/assets/js/blog_Mybatis_mybatisæºç è§£æsqlæ‰§è¡Œ.html.816eabb4.js" as="script"><link rel="prefetch" href="/assets/js/blog_MQ_RocketMQæ ¸å¿ƒæ“ä½œ.html.63357142.js" as="script"><link rel="prefetch" href="/assets/js/blog_Mybatis_mybatisç¼“å­˜.html.2651782d.js" as="script"><link rel="prefetch" href="/assets/js/blog_Spring_springçš„äº‹åŠ¡åŸç†è§£æ.html.769e0b7a.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringMvc_springMvcæºç è§£æ.html.c1b2865c.js" as="script"><link rel="prefetch" href="/assets/js/blog_Redis_rediså®ç°åˆ†å¸ƒå¼é”.html.7516eacc.js" as="script"><link rel="prefetch" href="/assets/js/blog_zookeeper_zookeeperå®ç°åˆ†å¸ƒå¼é”.html.1715db1d.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringBoot_SpringBootçš„runæ–¹æ³•.html.044d1817.js" as="script"><link rel="prefetch" href="/assets/js/blog_å¤šçº¿ç¨‹_ReentrantLockåŸç†è§£æ.html.80795b2f.js" as="script"><link rel="prefetch" href="/assets/js/blog_Mybatis_springæ•´åˆmybatisæºç è§£æ.html.5e3549b1.js" as="script"><link rel="prefetch" href="/assets/js/blog_zookeeper_æ‰‹å†™zookeeperé…ç½®ä¸­å¿ƒ.html.e694bc27.js" as="script"><link rel="prefetch" href="/assets/js/blog_Dubbo_dubboä¸­çš„spiæœºåˆ¶.html.aab57cc3.js" as="script"><link rel="prefetch" href="/assets/js/blog_Spring_springçš„å¾ªç¯ä¾èµ–.html.196cce1f.js" as="script"><link rel="prefetch" href="/assets/js/blog_MQ_RabbitMQçš„å„ç§é˜Ÿåˆ—.html.e5336c01.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringBoot_SpringBootäº‹ä»¶ç›‘å¬.html.54204757.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringCloud_nacosçš„æœåŠ¡æ²»ç†.html.f5575363.js" as="script"><link rel="prefetch" href="/assets/js/blog_Java_QLExpressè¡¨è¾¾å¼.html.5caa883b.js" as="script"><link rel="prefetch" href="/assets/js/blog_MQ_RabbitMQå…­ç§å·¥ä½œæ¨¡å¼.html.006bccad.js" as="script"><link rel="prefetch" href="/assets/js/blog_Mybatis_mybatisæ’ä»¶.html.0f19eed2.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringBoot_SpringBootè‡ªåŠ¨è£…é…åŸç†.html.01c96e27.js" as="script"><link rel="prefetch" href="/assets/js/blog_Java_Lambdaå’ŒStream.html.ddc91a9c.js" as="script"><link rel="prefetch" href="/assets/js/blog_å¤šçº¿ç¨‹_ReentrantReadWriteLockåŸç†.html.3cb0f79e.js" as="script"><link rel="prefetch" href="/assets/js/blog_å·¥ä½œæµ_flowableè¯·å‡æµç¨‹æ¡ˆä¾‹.html.ef47e01a.js" as="script"><link rel="prefetch" href="/assets/js/blog_MQ_RabbitMQæ¶ˆæ¯çš„å¯é ä¼ é€’.html.799c2508.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringBoot_SpringBootå†…åµŒtomcatåŸç†è§£æ.html.7c58b70e.js" as="script"><link rel="prefetch" href="/assets/js/blog_Dubbo_@DubboReferenceæ³¨è§£.html.491609cd.js" as="script"><link rel="prefetch" href="/assets/js/blog_å¤šçº¿ç¨‹_CASå’ŒAtomic.html.3cac4fe4.js" as="script"><link rel="prefetch" href="/assets/js/blog_zookeeper_æ‰‹å†™zookeeperæ³¨å†Œä¸­å¿ƒ.html.c2699d33.js" as="script"><link rel="prefetch" href="/assets/js/blog_å¤šçº¿ç¨‹_çº¿ç¨‹æ± ThreadPoolExecutor.html.acf341ac.js" as="script"><link rel="prefetch" href="/assets/js/blog_Jvm_jvmç±»åŠ è½½æœºåˆ¶.html.52f4f7f1.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringBoot_SpringBootå¤–ç½®tomcatåŸç†è§£æ.html.e9369841.js" as="script"><link rel="prefetch" href="/assets/js/blog_Netty_BIOï¼ŒNIOå’ŒAIOæ¨¡å‹.html.3810eea3.js" as="script"><link rel="prefetch" href="/assets/js/blog_Redis_Redisæ ¸å¿ƒæ•°æ®ç»“æ„.html.ecd8072b.js" as="script"><link rel="prefetch" href="/assets/js/blog_MQ_RabbitMQæ•´åˆSpringæˆ–SpringBoot.html.2bcbbe1a.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringMvc_SpringMvcä½¿ç”¨Validationå‚æ•°æ ¡éªŒ.html.91cbd938.js" as="script"><link rel="prefetch" href="/assets/js/blog_å¤šçº¿ç¨‹_SemaphoreåŸç†.html.33cc3124.js" as="script"><link rel="prefetch" href="/assets/js/blog_Mybatis_MybatisåŠ¨æ€æ•°æ®æº.html.30ff880e.js" as="script"><link rel="prefetch" href="/assets/js/blog_Java_HashMapåŸç†.html.7f355df7.js" as="script"><link rel="prefetch" href="/assets/js/blog_Java_åå°„.html.7d230d7e.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringCloud_OpenFeign.html.4b6f9068.js" as="script"><link rel="prefetch" href="/assets/js/blog_è®¾è®¡æ¨¡å¼_åˆ›å»ºæ¨¡å¼-å·¥å‚æ¨¡å¼.html.417ce16d.js" as="script"><link rel="prefetch" href="/assets/js/blog_Java_Stringå­—ç¬¦ä¸²å¸¸é‡æ± .html.3cae9b18.js" as="script"><link rel="prefetch" href="/assets/js/blog_Redis_Redisç¼“å­˜è®¾è®¡.html.3aa6631b.js" as="script"><link rel="prefetch" href="/assets/js/blog_Java_javaå¯¹è±¡çš„æ‹·è´.html.538e2d60.js" as="script"><link rel="prefetch" href="/assets/js/blog_Jvm_jvmå¯¹è±¡çš„ç»“æ„å’Œåˆ›å»º.html.d9b0bde7.js" as="script"><link rel="prefetch" href="/assets/js/blog_å¤šçº¿ç¨‹_ConcurrentHashMapåˆ†æ®µé”.html.81aeae43.js" as="script"><link rel="prefetch" href="/assets/js/blog_è®¾è®¡æ¨¡å¼_ç»“æ„æ¨¡å¼-é€‚é…å™¨æ¨¡å¼.html.fcb045e4.js" as="script"><link rel="prefetch" href="/assets/js/blog_Java_javaå¼‚å¸¸.html.296d8d81.js" as="script"><link rel="prefetch" href="/assets/js/blog_zookeeper_zookeeperå¸¸ç”¨å‘½ä»¤.html.bff011c4.js" as="script"><link rel="prefetch" href="/assets/js/blog_Spring_Springçš„@Conditionalæ³¨è§£.html.af1ec24a.js" as="script"><link rel="prefetch" href="/assets/js/blog_Redis_Redisä¸»ä»ï¼Œå“¨å…µå’Œé›†ç¾¤æ¨¡å¼.html.e0b74d88.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringCloud_Sentinelé™æµ.html.b96ddd60.js" as="script"><link rel="prefetch" href="/assets/js/blog_å·¥ä½œæµ_flowable ä¼šç­¾ã€è½¬æ´¾ã€å§”æ´¾ã€åŠ ç­¾.html.9497e0df.js" as="script"><link rel="prefetch" href="/assets/js/8300.507decb8.js" as="script"><link rel="prefetch" href="/assets/js/blog_å¤šçº¿ç¨‹_çº¿ç¨‹åŸºç¡€.html.580c695e.js" as="script"><link rel="prefetch" href="/assets/js/blog_Redis_Rediså‘å¸ƒè®¢é˜…ï¼Œé”å’Œäº‹åŠ¡.html.9db9aa86.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringBoot_SpringBootæ³¨å†ŒBeançš„6ç§æ–¹å¼.html.c8ef18b4.js" as="script"><link rel="prefetch" href="/assets/js/blog_å¤šçº¿ç¨‹_volatileçš„åŸç†.html.8b38e8c3.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringCloud_@SentinelResourceæ³¨è§£.html.f011930f.js" as="script"><link rel="prefetch" href="/assets/js/blog_è®¾è®¡æ¨¡å¼_å…³ç³»æ¨¡å¼-è´£ä»»é“¾æ¨¡å¼.html.34e56a07.js" as="script"><link rel="prefetch" href="/assets/js/blog_mysql_mysqlçš„é”.html.1d736003.js" as="script"><link rel="prefetch" href="/assets/js/blog_è®¾è®¡æ¨¡å¼_åˆ›å»ºæ¨¡å¼-ç”Ÿæˆå™¨æ¨¡å¼.html.42a65015.js" as="script"><link rel="prefetch" href="/assets/js/blog_è®¾è®¡æ¨¡å¼_å…³ç³»æ¨¡å¼-ç­–ç•¥æ¨¡å¼.html.d093ce54.js" as="script"><link rel="prefetch" href="/assets/js/blog_Jvm_jvmè°ƒä¼˜å·¥å…·.html.92fcb0eb.js" as="script"><link rel="prefetch" href="/assets/js/blog_mysql_MySQLçš„sqlæ‰§è¡Œæµç¨‹.html.0a0bbad7.js" as="script"><link rel="prefetch" href="/assets/js/blog_Jvm_jvmåƒåœ¾æ”¶é›†å™¨.html.a5df44c1.js" as="script"><link rel="prefetch" href="/assets/js/blog_mysql_mysqlçš„ç´¢å¼•.html.6d5cee74.js" as="script"><link rel="prefetch" href="/assets/js/blog_Java_æµ®ç‚¹ç²¾åº¦ï¼ˆfloatã€doubleï¼‰è¿ç®—ä¸ç²¾ç¡®çš„åŸå› .html.1fbc1f4c.js" as="script"><link rel="prefetch" href="/assets/js/blog_å¤šçº¿ç¨‹_CountDownLatchå’ŒCyclicBarrier.html.e26cc89c.js" as="script"><link rel="prefetch" href="/assets/js/blog_è®¾è®¡æ¨¡å¼_åˆ›å»ºæ¨¡å¼-å•ä¾‹æ¨¡å¼.html.8d3660c7.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringCloud_SpringCloudé¡¹ç›®åˆ›å»º.html.4c24b73e.js" as="script"><link rel="prefetch" href="/assets/js/blog_è®¾è®¡æ¨¡å¼_ç»“æ„æ¨¡å¼-è£…é¥°è€…æ¨¡å¼.html.9e3aa0f3.js" as="script"><link rel="prefetch" href="/assets/js/blog_Jvm_JVMçš„åƒåœ¾å›æ”¶æœºåˆ¶.html.5273223d.js" as="script"><link rel="prefetch" href="/assets/js/blog_Nginx_ä¸€ç¯‡æå®šnignx.html.9a3b439a.js" as="script"><link rel="prefetch" href="/assets/js/blog_MQ_RabbitMQå®‰è£….html.14b98da0.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringCloud_Sentinelç†”æ–­.html.97947c00.js" as="script"><link rel="prefetch" href="/assets/js/blog_å¤šçº¿ç¨‹_JMMæ¨¡å‹.html.da8cae07.js" as="script"><link rel="prefetch" href="/assets/js/blog_å·¥ä½œæµ_SpringBootæ•´åˆflowable.html.093828b6.js" as="script"><link rel="prefetch" href="/assets/js/blog_mysql_mysqlçš„äº‹åŠ¡.html.01537175.js" as="script"><link rel="prefetch" href="/assets/js/blog_MQ_å®‰è£…RocketMQ.html.4274dd1d.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringBoot_SpringBootè‡ªå®šä¹‰starter.html.bc8ca5db.js" as="script"><link rel="prefetch" href="/assets/js/blog_mysql_MySQLçš„MVCC.html.995ac143.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringCloud_nacosçš„å®‰è£….html.f6191ddf.js" as="script"><link rel="prefetch" href="/assets/js/blog_Redis_RedisæŒä¹…åŒ–.html.d27031d3.js" as="script"><link rel="prefetch" href="/assets/js/blog_å¤šçº¿ç¨‹_synchronizedåº•å±‚åŸç† .html.6183a6bd.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringCloud_nacoså¿«é€Ÿå¼€å§‹.html.30bbdac0.js" as="script"><link rel="prefetch" href="/assets/js/blog_Java_javaè¿ç®—ç¬¦ä¼˜å…ˆçº§.html.b5ebd699.js" as="script"><link rel="prefetch" href="/assets/js/blog_Docker_å®‰è£…nginx.html.b35574ef.js" as="script"><link rel="prefetch" href="/assets/js/blog_Java_javaè®¿é—®æƒé™ä¿®é¥°ç¬¦.html.985c6f1d.js" as="script"><link rel="prefetch" href="/assets/js/blog_mysql_äº‘æœåŠ¡å™¨MySQLæ•°æ®è‡ªåŠ¨å¤‡ä»½åˆ°ä¸ƒç‰›äº‘.html.2566c427.js" as="script"><link rel="prefetch" href="/assets/js/blog_zookeeper_å®‰è£…zookeeper.html.b0ce07c4.js" as="script"><link rel="prefetch" href="/assets/js/blog_Docker_linuxå®‰è£…docker.html.2fd80aef.js" as="script"><link rel="prefetch" href="/assets/js/blog_mysql_mysqlçš„Buffer Pool.html.50d9f0c1.js" as="script"><link rel="prefetch" href="/assets/js/blog_Nginx_SSLè¯ä¹¦å®‰è£….html.37924161.js" as="script"><link rel="prefetch" href="/assets/js/blog_å·¥å…·_NavicatPremium16çš„å®‰è£…ä¸æ¿€æ´».html.1c745755.js" as="script"><link rel="prefetch" href="/assets/js/blog_Docker_å®‰è£…mysqlå•æœºç‰ˆæœ¬.html.f887b50f.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringCloud_sentinelå¿«é€Ÿå¼€å§‹.html.88777019.js" as="script"><link rel="prefetch" href="/assets/js/blog_å·¥å…·_sshæœåŠ¡ç™»å½•linux.html.c9a5edc9.js" as="script"><link rel="prefetch" href="/assets/js/blog_å·¥å…·_Odsidianæ–‡æœ¬ç¼–è¾‘å™¨.html.fbf2f53b.js" as="script"><link rel="prefetch" href="/assets/js/blog_å·¥å…·_Jmeterçš„å®‰è£…ä½¿ç”¨.html.6d249a3c.js" as="script"><link rel="prefetch" href="/assets/js/blog_Java_æ—¥å¿—æ¶æ„å†å².html.87117f7f.js" as="script"><link rel="prefetch" href="/assets/js/blog_å·¥ä½œæµ_Flowableæµç¨‹å›¾.html.63661098.js" as="script"><link rel="prefetch" href="/assets/js/blog_å·¥å…·_å›¾åºŠç¥å™¨PicGo_ä¸ƒç‰›äº‘.html.0d5f632d.js" as="script"><link rel="prefetch" href="/assets/js/blog_Jvm_JVMè¿è¡Œæ—¶å†…å­˜åˆ’åˆ†.html.ce53c9ae.js" as="script"><link rel="prefetch" href="/assets/js/blog_å·¥å…·_xshell8å®‰è£….html.50022217.js" as="script"><link rel="prefetch" href="/assets/js/blog_Java_TCPä¸‰æ¬¡æ¡æ‰‹.html.d2cc462d.js" as="script"><link rel="prefetch" href="/assets/js/blog_Java_å¸¸è§é—®é¢˜.html.ba97e3ad.js" as="script"><link rel="prefetch" href="/assets/js/blog_å·¥å…·_idea2024.1.7çš„ä¸‹è½½å’Œæ¿€æ´».html.3c0189e8.js" as="script"><link rel="prefetch" href="/assets/js/blog_index.html.81e680d7.js" as="script"><link rel="prefetch" href="/assets/js/index.html.c7cb45ee.js" as="script"><link rel="prefetch" href="/assets/js/intro.html.e2c9d9a0.js" as="script"><link rel="prefetch" href="/assets/js/category_è®¾è®¡æ¨¡å¼_index.html.dcafc54b.js" as="script"><link rel="prefetch" href="/assets/js/tag_è®¾è®¡æ¨¡å¼_index.html.618e57d0.js" as="script"><link rel="prefetch" href="/assets/js/category_å¤šçº¿ç¨‹_index.html.ab6158ff.js" as="script"><link rel="prefetch" href="/assets/js/category_å·¥ä½œæµ_index.html.85a0aad0.js" as="script"><link rel="prefetch" href="/assets/js/tag_å·¥ä½œæµ_index.html.489d7bd5.js" as="script"><link rel="prefetch" href="/assets/js/tag_å¤šçº¿ç¨‹_index.html.8870c7c3.js" as="script"><link rel="prefetch" href="/assets/js/category_springcloud_index.html.6389c3f1.js" as="script"><link rel="prefetch" href="/assets/js/category_springboot_index.html.e8d20360.js" as="script"><link rel="prefetch" href="/assets/js/category_å·¥å…·_index.html.c51a1024.js" as="script"><link rel="prefetch" href="/assets/js/tag_springcloud_index.html.efa1833a.js" as="script"><link rel="prefetch" href="/assets/js/category_springmvc_index.html.c0dc42a9.js" as="script"><link rel="prefetch" href="/assets/js/category_zookeeper_index.html.38ae050a.js" as="script"><link rel="prefetch" href="/assets/js/tag_springboot_index.html.39c742d4.js" as="script"><link rel="prefetch" href="/assets/js/tag_ååƒ»_index.html.9b02071e.js" as="script"><link rel="prefetch" href="/assets/js/tag_åŸºç¡€_index.html.3d7e6149.js" as="script"><link rel="prefetch" href="/assets/js/tag_å·¥å…·_index.html.d63823d9.js" as="script"><link rel="prefetch" href="/assets/js/tag_å¿…çœ‹_index.html.c1a697ed.js" as="script"><link rel="prefetch" href="/assets/js/tag_å¸¸ç”¨_index.html.c851c927.js" as="script"><link rel="prefetch" href="/assets/js/tag_å¹²è´§_index.html.1e892cab.js" as="script"><link rel="prefetch" href="/assets/js/tag_æ¨è_index.html.a52644de.js" as="script"><link rel="prefetch" href="/assets/js/tag_è¿›é˜¶_index.html.926d17cf.js" as="script"><link rel="prefetch" href="/assets/js/tag_springmvc_index.html.a00465f5.js" as="script"><link rel="prefetch" href="/assets/js/tag_zookeeper_index.html.18fdf753.js" as="script"><link rel="prefetch" href="/assets/js/category_mybatis_index.html.ab0d8e05.js" as="script"><link rel="prefetch" href="/assets/js/category_docker_index.html.0b609a56.js" as="script"><link rel="prefetch" href="/assets/js/category_spring_index.html.69dd8d33.js" as="script"><link rel="prefetch" href="/assets/js/blog_è®¾è®¡æ¨¡å¼_index.html.92a02ba6.js" as="script"><link rel="prefetch" href="/assets/js/tag_mybatis_index.html.2ce597a0.js" as="script"><link rel="prefetch" href="/assets/js/category_dubbo_index.html.0a8208ff.js" as="script"><link rel="prefetch" href="/assets/js/category_mysql_index.html.fd9895b8.js" as="script"><link rel="prefetch" href="/assets/js/category_netty_index.html.3e7e720e.js" as="script"><link rel="prefetch" href="/assets/js/category_nginx_index.html.5da21e16.js" as="script"><link rel="prefetch" href="/assets/js/category_redis_index.html.ea9b64a2.js" as="script"><link rel="prefetch" href="/assets/js/tag_docker_index.html.7eb31738.js" as="script"><link rel="prefetch" href="/assets/js/tag_spring_index.html.83610514.js" as="script"><link rel="prefetch" href="/assets/js/404.html.59a49ed8.js" as="script"><link rel="prefetch" href="/assets/js/category_java_index.html.69febb12.js" as="script"><link rel="prefetch" href="/assets/js/tag_dubbo_index.html.6a2a9b3c.js" as="script"><link rel="prefetch" href="/assets/js/tag_mysql_index.html.29d8be0c.js" as="script"><link rel="prefetch" href="/assets/js/tag_redis_index.html.daf8d093.js" as="script"><link rel="prefetch" href="/assets/js/tag_netty_index.html.42683be4.js" as="script"><link rel="prefetch" href="/assets/js/tag_nginx_index.html.7d8b7b56.js" as="script"><link rel="prefetch" href="/assets/js/category_jvm_index.html.fee1a34f.js" as="script"><link rel="prefetch" href="/assets/js/tag_java_index.html.669228d3.js" as="script"><link rel="prefetch" href="/assets/js/category_mq_index.html.683da66f.js" as="script"><link rel="prefetch" href="/assets/js/blog_å¤šçº¿ç¨‹_index.html.03b49b5b.js" as="script"><link rel="prefetch" href="/assets/js/blog_å·¥ä½œæµ_index.html.1279bc70.js" as="script"><link rel="prefetch" href="/assets/js/tag_jvm_index.html.c6857c65.js" as="script"><link rel="prefetch" href="/assets/js/tag_mq_index.html.a686154b.js" as="script"><link rel="prefetch" href="/assets/js/timeline_index.html.91534fbf.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringCloud_index.html.17f3206d.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringBoot_index.html.08387927.js" as="script"><link rel="prefetch" href="/assets/js/category_index.html.8762da89.js" as="script"><link rel="prefetch" href="/assets/js/blog_å·¥å…·_index.html.fe78a7ea.js" as="script"><link rel="prefetch" href="/assets/js/blog_SpringMvc_index.html.845e4251.js" as="script"><link rel="prefetch" href="/assets/js/article_index.html.986e6fea.js" as="script"><link rel="prefetch" href="/assets/js/blog_zookeeper_index.html.e43b13bf.js" as="script"><link rel="prefetch" href="/assets/js/tag_index.html.4672dabe.js" as="script"><link rel="prefetch" href="/assets/js/star_index.html.7b606cdf.js" as="script"><link rel="prefetch" href="/assets/js/blog_Mybatis_index.html.bf65bb84.js" as="script"><link rel="prefetch" href="/assets/js/blog_Docker_index.html.9c5a487f.js" as="script"><link rel="prefetch" href="/assets/js/blog_Spring_index.html.7a8a77ab.js" as="script"><link rel="prefetch" href="/assets/js/blog_Dubbo_index.html.0fedf4ae.js" as="script"><link rel="prefetch" href="/assets/js/blog_Netty_index.html.6d27af6d.js" as="script"><link rel="prefetch" href="/assets/js/blog_Nginx_index.html.839b919c.js" as="script"><link rel="prefetch" href="/assets/js/blog_Redis_index.html.bf3cac54.js" as="script"><link rel="prefetch" href="/assets/js/blog_mysql_index.html.2fcd2215.js" as="script"><link rel="prefetch" href="/assets/js/blog_Java_index.html.55365ce3.js" as="script"><link rel="prefetch" href="/assets/js/blog_Jvm_index.html.3c70e7cd.js" as="script"><link rel="prefetch" href="/assets/js/blog_MQ_index.html.238eafd0.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar auto-hide" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="å¸¦æˆ‘å›å®¶"><!----><!----><span class="vp-site-name">Mr.Zyh</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="ä¸»é¡µ"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:house" sizing="height" height="1em"></iconify-icon><!--]-->ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/blog/" aria-label="æ–‡ç« "><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:book-open" sizing="height" height="1em"></iconify-icon><!--]-->æ–‡ç« <!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/category/" aria-label="åˆ†ç±»"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:bookmark" sizing="height" height="1em"></iconify-icon><!--]-->åˆ†ç±»<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/timeline/" aria-label="æ—¶é—´è½´"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:calendar" sizing="height" height="1em"></iconify-icon><!--]-->æ—¶é—´è½´<!----></a></div></nav><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><p class="vp-sidebar-header active"><iconify-icon class="vp-icon" icon="fa6-solid:folder-open" sizing="both" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">æ–‡ç« ç›®å½•</span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Docker</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Dubbo</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Java</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Jvm</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">MQ</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Mybatis</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Mysql</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Netty</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Nginx</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Redis</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/blog/Redis/Redis%E4%B8%BB%E4%BB%8E%EF%BC%8C%E5%93%A8%E5%85%B5%E5%92%8C%E9%9B%86%E7%BE%A4%E6%A8%A1%E5%BC%8F.html" aria-label="Redisä¸»ä»ï¼Œå“¨å…µå’Œé›†ç¾¤æ¨¡å¼"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:file-lines" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->Redisä¸»ä»ï¼Œå“¨å…µå’Œé›†ç¾¤æ¨¡å¼<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/blog/Redis/Redis%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%EF%BC%8C%E9%94%81%E5%92%8C%E4%BA%8B%E5%8A%A1.html" aria-label="Rediså‘å¸ƒè®¢é˜…ï¼Œé”å’Œäº‹åŠ¡"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:file-lines" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->Rediså‘å¸ƒè®¢é˜…ï¼Œé”å’Œäº‹åŠ¡<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/blog/Redis/redis%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81.html" aria-label="rediså®ç°åˆ†å¸ƒå¼é”"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:file-lines" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->rediså®ç°åˆ†å¸ƒå¼é”<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/blog/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96.html" aria-label="RedisæŒä¹…åŒ–"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:file-lines" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->RedisæŒä¹…åŒ–<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/blog/Redis/Redis%E6%A0%B8%E5%BF%83%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.html" aria-label="Redisæ ¸å¿ƒæ•°æ®ç»“æ„"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:file-lines" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->Redisæ ¸å¿ƒæ•°æ®ç»“æ„<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/blog/Redis/Redis%E7%BC%93%E5%AD%98%E8%AE%BE%E8%AE%A1.html" aria-label="Redisç¼“å­˜è®¾è®¡"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:file-lines" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->Redisç¼“å­˜è®¾è®¡<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Spring</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Spring Boot</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Spring Cloud</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Spring Mvc</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Zookeeper</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">å¤šçº¿ç¨‹</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">å·¥ä½œæµ</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">å·¥å…·</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">è®¾è®¡æ¨¡å¼</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><iconify-icon class="vp-icon" icon="fa6-solid:file-lines" sizing="height" height="1em"></iconify-icon>Redisæ ¸å¿ƒæ•°æ®ç»“æ„</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">Ms.Zyh</span></span><span property="author" content="Ms.Zyh"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2022/4/10</span><meta property="datePublished" content="2022-04-10T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 24 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT24M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color3 clickable" role="navigation">Redis</span><!--]--><meta property="articleSection" content="Redis"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color5 clickable" role="navigation">æ¨è</span><span class="page-tag-item color3 clickable" role="navigation">Redis</span><!--]--><meta property="keywords" content="æ¨è,Redis"></span></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><p>æ•°æ®ç±»å‹å’Œå¯¹åº”çš„æ•°æ®ç»“æ„ï¼š</p><table><thead><tr><th>æ•°æ®ç±»å‹</th><th>åº•å±‚ç»“æ„</th></tr></thead><tbody><tr><td>String</td><td>SDS</td></tr><tr><td>List</td><td>åŒå‘åˆ—è¡¨ï¼Œå‹ç¼©åˆ—è¡¨</td></tr><tr><td>Hash</td><td>å‹ç¼©åˆ—è¡¨ï¼ŒHashè¡¨</td></tr><tr><td>Set</td><td>æ•´æ•°é›†åˆï¼ŒHashè¡¨</td></tr><tr><td>SortedSet</td><td>å‹ç¼©åˆ—è¡¨ï¼Œè·³è¡¨</td></tr></tbody></table><h3 id="ä¸€-string" tabindex="-1"><a class="header-anchor" href="#ä¸€-string"><span>ä¸€ï¼ŒString</span></a></h3><h4 id="_1-1-å¸¸è§å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#_1-1-å¸¸è§å‘½ä»¤"><span>1.1 å¸¸è§å‘½ä»¤</span></a></h4><p>redisçš„é”®æ˜¯Stringç±»å‹ï¼š</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹å½“å‰åº“ä¸­çš„æ‰€æœ‰key</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">keys</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹keyæ˜¯å¦å­˜åœ¨</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">exists</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹keyçš„ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹keyå¯¹åº”å€¼çš„åº•å±‚ç¼–ç </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">object</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> encoding</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åˆ é™¤æŒ‡å®šçš„key</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">del</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># éé˜»å¡åˆ é™¤keyçš„value</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">unlink</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è®¾ç½®è¿‡æœŸæ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">expire</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> æ—¶é—´ã€å•ä½</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ç§’ã€‘</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹è¿˜æœ‰å¤šå°‘ç§’è¿‡æœŸï¼Œ-1è¡¨ç¤ºæ°¸ä¸è¿‡æœŸï¼›-2è¡¨ç¤ºå·²ç»è¿‡æœŸï¼›</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ttl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹keyçš„æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dbsize</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ¸…ç©ºå½“å‰åº“</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">flushdb</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># é€šæ€å…¨éƒ¨åº“</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">flushall</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>redisçš„å€¼æ˜¯Stringç±»å‹ï¼š</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å­˜å‚¨</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> value</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è®¾ç½®å¤šä¸ªå€¼</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mset</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> value1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> value2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ...</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å­˜å‚¨çš„æ—¶å€™è®¾ç½®è¿‡æœŸæ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">setex</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> è¿‡æœŸæ—¶é—´ã€å•ä½</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ç§’ã€‘</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> value</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è·å–</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è·å–å¤šä¸ªå€¼</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è·å–valueçš„éƒ¨åˆ†å€¼</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getrange</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> èµ·å§‹ä½ç½®</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ç»“æŸä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è·å–åŸæ¥çš„ï¼Œå¹¶æ”¾ç½®ä¸€ä¸ªæ–°çš„</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getset</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> value</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å­˜åœ¨ä¸å¢åŠ ï¼Œä¸å­˜åœ¨æ·»åŠ </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">setnx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> value</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ•°å€¼é€’å¢</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">incr</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ•°å€¼é€’å¢ï¼Œå¹¶æŒ‡å®šæ­¥é•¿</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">incrby</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> increment</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ•°å€¼é€’å‡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">decr</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ•°å€¼é€’å‡ï¼Œå¹¶æŒ‡å®šæ­¥é•¿ï¼š</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">decrby</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> decrement</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å‘å°¾éƒ¨è¿½åŠ å€¼</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">append</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> value</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è·å–å­—ç¬¦ä¸²é•¿åº¦</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">strlen</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1-2-åº”ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#_1-2-åº”ç”¨åœºæ™¯"><span>1.2 åº”ç”¨åœºæ™¯</span></a></h4><ul><li>ç¼“å­˜å¯¹è±¡ï¼šç›´æ¥ç¼“å­˜æ•´ä¸ªå¯¹è±¡çš„ JSON æˆ–è€… é‡‡ç”¨å°† key è¿›è¡Œåˆ†ç¦»ä¸º <code>user:ID:</code>å±æ€§</li><li>å¸¸è§„è®¡æ•°: Redis å¤„ç†å‘½ä»¤æ˜¯å•çº¿ç¨‹ï¼Œæ‰€ä»¥æ‰§è¡Œå‘½ä»¤çš„è¿‡ç¨‹æ˜¯åŸå­æˆ–è€…ä½¿ç”¨luaè„šæœ¬æ‰§è¡Œå¤šæ¡å‘½ä»¤ä¹Ÿæ˜¯åŸå­çš„ï¼Œå› æ­¤é€‚åˆè®¡æ•°åœºæ™¯ï¼Œæ¯”å¦‚è®¡ç®—è®¿é—®æ¬¡æ•°ã€ç‚¹èµã€è½¬å‘ã€åº“å­˜æ•°é‡ç­‰ç­‰ã€‚</li><li>åˆ†å¸ƒå¼é”ï¼šå¯ä»¥ç”¨å®ƒæ¥å®ç°åˆ†å¸ƒå¼é”ã€‚</li><li>å…±äº« Session ä¿¡æ¯ï¼šå°†Session IDä½œä¸ºkeyã€‚</li></ul><h4 id="_1-3-æ•°æ®ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_1-3-æ•°æ®ç»“æ„"><span>1.3 æ•°æ®ç»“æ„</span></a></h4><p>redis ä¸­æ‰€æœ‰çš„ key éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™äº›å­—ç¬¦ä¸²æ˜¯é€šè¿‡ä¸€ä¸ªåä¸ºç®€å•åŠ¨æ€å­—ç¬¦ä¸² SDS çš„æ•°æ®ç»“æ„å®ç°çš„ã€‚</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sdshdr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">?</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // SDS headerï¼Œ[?] å¯ä»¥ä¸º 8, 16, 32, 64</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    uint?</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">_t len;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          // å·²ç”¨ç©ºé—´ï¼Œå­—ç¬¦ä¸²çš„å®é™…é•¿åº¦</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    uint?</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">_t alloc;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // å·²åˆ†é…ç©ºé—´ï¼Œä¸åŒ…å«&#39;\0&#39;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    unsigned</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> char</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> flags;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // ç±»å‹æ ‡è®°ï¼ŒæŒ‡æ˜äº† len ä¸ alloc çš„å®é™…ç±»å‹ï¼Œå¯ä»¥é€šè¿‡ sds[-1] è·å–</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    char</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> buf</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">[]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           // å­—ç¬¦æ•°ç»„ï¼Œä¿å­˜ä»¥&#39;\0&#39;ç»“å°¾çš„å­—ç¬¦ä¸²ï¼Œä¸ä¼ ç»Ÿ C è¯­è¨€ä¸­çš„å­—ç¬¦ä¸²çš„è¡¨è¾¾æ–¹å¼ä¿æŒä¸€è‡´</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å†…å­˜å¸ƒå±€å¦‚ä¸‹ï¼š</p><img src="http://img.zouyh.top/article-img/20240917135015194.png" alt="image-20230306142129744" style="zoom:80%;"><p>â€‹ å¦‚æœé€šè¿‡<code>append key value</code>å‘å­—ç¬¦ä¸²è¿½åŠ å€¼ï¼Œå¯ä»¥é€šè¿‡ <code>alloc - len</code>è®¡ç®—å‡ºå‰©ä½™çš„ç©ºé—´å¤§å°ï¼Œç”¨æ¥åˆ¤æ–­ç©ºé—´æ˜¯å¦å¯ä»¥å­˜æ”¾ï¼Œå¦‚æœä¸æ»¡è¶³çš„è¯ï¼Œå°±ä¼šè‡ªåŠ¨è¿›è¡Œæ‰©å®¹ï¼Œæ‰©å®¹çš„ç©ºé—´ä¸€èˆ¬è¦é«˜äºå®é™…æ‰€éœ€ç©ºé—´ï¼Œé‡‡ç”¨é¢„åˆ†é…å†—ä½™ç©ºé—´çš„æ–¹å¼æ¥å‡å°‘å†…å­˜çš„é¢‘ç¹åˆ†é…ã€‚å½“å­—ç¬¦ä¸²é•¿åº¦å°äº1Mæ—¶ï¼Œæ‰©å®¹éƒ½æ˜¯åŠ å€ç°æœ‰çš„ç©ºé—´ï¼Œå¦‚æœè¶…è¿‡1Mï¼Œæ‰©å®¹æ—¶ä¸€æ¬¡åªä¼šå¤šæ‰©1Mçš„ç©ºé—´ã€‚éœ€è¦æ³¨æ„çš„æ˜¯å­—ç¬¦ä¸²æœ€å¤§é•¿åº¦ä¸º512Mã€‚</p><h3 id="äºŒ-list" tabindex="-1"><a class="header-anchor" href="#äºŒ-list"><span>äºŒï¼ŒList</span></a></h3><h4 id="_2-1-å¸¸è§å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#_2-1-å¸¸è§å‘½ä»¤"><span>2.1 å¸¸è§å‘½ä»¤</span></a></h4><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ä»å·¦è¾¹æˆ–å³è¾¹æ’å…¥å€¼</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lpush/rpush</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> value1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> value2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> value3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .....</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ä»å·¦è¾¹æˆ–å³è¾¹å–å‡ºä¸€ä¸ªå€¼ï¼Œå–å‡ºçš„å€¼å°±ä¸åœ¨listä¸­</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lpop/rpop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ä»key1Listå³è¾¹å–å€¼ï¼Œå–å‡ºçš„å€¼æ·»åŠ åˆ°key2Listå·¦è¾¹</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rpoplpush</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key2</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ä»ä¸‹æ ‡ä¸ºindexï¼Œå–lené•¿åº¦çš„å€¼ã€‚  index = 0 len = -1è¡¨ç¤ºæŸ¥è¯¢æ‰€æœ‰</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lrange</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> len</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å–æŸä¸ªä¸‹æ ‡å€¼</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lindex</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> index</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è·å–åˆ—è¡¨çš„é•¿åº¦</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">llen</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åœ¨æŸä¸ªå€¼valueçš„å‰é¢æˆ–åé¢æ’å…¥æ–°å€¼newvalue</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">linsert</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> before/afert</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> value</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> newvalue</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è¡¨ç¤ºåˆ é™¤å·¦è¾¹lenä¸ªå€¼ä¸ºvalueçš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lrem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> len</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> value</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å°†ä¸‹æ ‡ä¸ºindexçš„å€¼æ›¿æ¢ä¸ºnewvalue</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lset</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> index</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> newvalue</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-2-åº”ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#_2-2-åº”ç”¨åœºæ™¯"><span>2.2 åº”ç”¨åœºæ™¯</span></a></h4><ul><li>é˜Ÿåˆ—ï¼šæŒ‰å…ˆè¿›å…ˆå‡ºçš„é¡ºåºå¯¹æ•°æ®è¿›è¡Œå­˜å–çš„ï¼Œä»å·¦è¾¹æˆ–å³è¾¹æ’å…¥å€¼<code>lpush/rpush</code>ï¼Œç„¶åä»å³è¾¹æˆ–å·¦è¾¹å–å€¼<code>rpop/lpop</code>ï¼Œä½¿ç”¨<code>brpop</code>å‘½ä»¤ä¹Ÿç§°ä¸ºé˜»å¡å¼è¯»å–ï¼Œå®¢æˆ·ç«¯åœ¨æ²¡æœ‰è¯»åˆ°é˜Ÿåˆ—æ•°æ®æ—¶ï¼Œè‡ªåŠ¨é˜»å¡ï¼Œç›´åˆ°æœ‰æ–°çš„æ•°æ®å†™å…¥é˜Ÿåˆ—ï¼Œå†å¼€å§‹è¯»å–æ–°æ•°æ®å’Œæ¶ˆè´¹è€…ç¨‹åºè‡ªå·±ä¸åœåœ°è°ƒç”¨RPOPå‘½ä»¤ç›¸æ¯”ï¼Œè¿™ç§æ–¹å¼èƒ½èŠ‚çœCPUå¼€é”€ã€‚ç¼ºç‚¹æ˜¯List ä¸æ”¯æŒå¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹åŒä¸€æ¡æ¶ˆæ¯ï¼Œå› ä¸ºä¸€æ—¦æ¶ˆè´¹è€…æ‹‰å–ä¸€æ¡æ¶ˆæ¯åï¼Œè¿™æ¡æ¶ˆæ¯å°±ä» List ä¸­åˆ é™¤äº†ï¼Œæ— æ³•è¢«å…¶å®ƒæ¶ˆè´¹è€…å†æ¬¡æ¶ˆè´¹ã€‚</li><li>æ ˆï¼šæŒ‰å…ˆè¿›åå‡ºçš„é¡ºåºå¯¹æ•°æ®è¿›è¡Œå­˜å–çš„ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°å¦‚æˆ‘ä»¬å…³æ³¨äº†è®¢é˜…å·ï¼Œå½“ç‚¹å¼€è®¢é˜…å·æ¶ˆæ¯æ—¶ï¼Œè®¢é˜…å·éƒ½ä¼šæ˜¾ç¤ºæœ€è¿‘å‘è¡¨çš„å‰1~4æ¡æ–‡ç« ï¼Œåå‘è¡¨çš„æ–‡ç« å…ˆå‡ºç°</li></ul><h4 id="_2-3-æ•°æ®ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_2-3-æ•°æ®ç»“æ„"><span>2.3 æ•°æ®ç»“æ„</span></a></h4><h5 id="_2-3-1-åŒå‘é“¾è¡¨linkedlist" tabindex="-1"><a class="header-anchor" href="#_2-3-1-åŒå‘é“¾è¡¨linkedlist"><span>2.3.1 åŒå‘é“¾è¡¨LinkedList</span></a></h5><p>åŒå‘é“¾è¡¨LinkedListçš„æ•°æ®ç»“æ„ï¼š</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> list {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    listNode </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">head;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // é“¾è¡¨å¤´èŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    listNode </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">tail;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // é“¾è¡¨å°¾èŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    void</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">dup)(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">void</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ptr);</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// èŠ‚ç‚¹å€¼å¤åˆ¶å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    void</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">free)(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">void</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ptr);</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// èŠ‚ç‚¹å€¼é‡Šæ”¾å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">match)(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">void</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ptr, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">void</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">key);</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// èŠ‚ç‚¹å€¼æ¯”è¾ƒå‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    unsigned</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> long</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> len;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// é“¾è¡¨èŠ‚ç‚¹æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} list;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é“¾è¡¨èŠ‚ç‚¹çš„æ•°æ®ç»“æ„ï¼š</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> listNode {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> listNode </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">prev;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // å‰ç½®èŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> listNode </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">next;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // åç½®èŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        void</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">value;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           // èŠ‚ç‚¹å€¼</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} listNode;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å†…å­˜å¸ƒå±€å¦‚ä¸‹ï¼š</p><img src="http://img.zouyh.top/article-img/20240917135014190.png" alt="image-20230306144726943" style="zoom:80%;"><p>é“¾è¡¨æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯ç»´æŠ¤èµ·æ¥æ¯”è¾ƒç®€å•ï¼Œç¼ºç‚¹æ˜¯é“¾è¡¨æ¯ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„å†…å­˜éƒ½æ˜¯ä¸è¿ç»­çš„ï¼Œæ„å‘³ç€æ— æ³•å¾ˆå¥½åˆ©ç”¨ CPU ç¼“å­˜ï¼Œè¿˜æœ‰ä¸€ç‚¹ï¼Œå°±æ˜¯å†…å­˜å¼€é”€è¾ƒå¤§ï¼Œå› æ­¤Redis 3.0 çš„ List å¯¹è±¡åœ¨æ•°æ®é‡æ¯”è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼Œä¼šé‡‡ç”¨ã€Œå‹ç¼©åˆ—è¡¨ã€ä½œä¸ºåº•å±‚æ•°æ®ç»“æ„çš„å®ç°ï¼Œå®ƒçš„ä¼˜åŠ¿æ˜¯èŠ‚çœå†…å­˜ç©ºé—´ï¼Œå¹¶ä¸”æ˜¯å†…å­˜ç´§å‡‘å‹çš„æ•°æ®ç»“æ„ã€‚</p><h5 id="_2-3-2-å‹ç¼©åˆ—è¡¨ziplist" tabindex="-1"><a class="header-anchor" href="#_2-3-2-å‹ç¼©åˆ—è¡¨ziplist"><span>2.3.2 å‹ç¼©åˆ—è¡¨zipList</span></a></h5><p>å‹ç¼©åˆ—è¡¨zipListçš„æ•°æ®ç»“æ„:</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">typedf </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ziplist</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">T</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    int32 zlbytes;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // å‹ç¼©åˆ—è¡¨å ç”¨å­—ç¬¦æ•°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    int32 zltail_offset;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // æœ€åä¸€ä¸ªå…ƒç´ è·ç¦»èµ·å§‹ä½ç½®çš„åç§»é‡ï¼Œç”¨äºå¿«é€Ÿå®šä½æœ€åä¸€ä¸ªèŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    int16 zllength;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // å…ƒç´ ä¸ªæ•°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    T</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">[]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> entries;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // å…ƒç´ å†…å®¹entry</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    int8 zlend;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // ç»“æŸä½ 0xFF</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}ziplist</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹é¢æ˜¯entryçš„æ•°æ®ç»“æ„:</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">typede </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> entry{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">var</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> prelen;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // å‰ä¸€ä¸ªentryçš„é•¿åº¦</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">var</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> encoding;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // å…ƒç´ ç±»å‹ç¼–ç </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    optional byte</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">[]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> content;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // å…ƒç´ å†…å®¹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}entry</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å†…å­˜å¸ƒå±€å¦‚ä¸‹ï¼š</p><img src="http://img.zouyh.top/article-img/20240917135013187.png" alt="image-20230306152843403" style="zoom:80%;"><p><strong>è¿é”æ›´æ–°</strong></p><p>entryä¸­æœ‰ä¸€ä¸ªprelenå­—æ®µï¼Œå®ƒçš„é•¿åº¦è¦ä¹ˆæ˜¯1ä¸ªå­—èŠ‚ï¼Œè¦ä¹ˆéƒ½æ˜¯5ä¸ªå­—èŠ‚ï¼š</p><ul><li>å‰ä¸€ä¸ªèŠ‚ç‚¹çš„é•¿åº¦å°äº254ä¸ªå­—èŠ‚ï¼Œåˆ™prelené•¿åº¦ä¸º1å­—èŠ‚ï¼›</li><li>å‰ä¸€ä¸ªèŠ‚ç‚¹çš„é•¿åº¦å¤§äº254å­—èŠ‚ï¼Œåˆ™prelené•¿åº¦ä¸º5å­—èŠ‚ï¼›</li></ul><p>â€‹ å‡è®¾ç°åœ¨æœ‰ä¸€ç»„å‹ç¼©åˆ—è¡¨ï¼Œentryçš„é•¿åº¦éƒ½åœ¨250<sub>253å­—èŠ‚ä¹‹é—´ï¼Œç°åœ¨çªç„¶æ–°å¢ä¸€ä¸ªentryèŠ‚ç‚¹ï¼Œè¿™ä¸ªentryèŠ‚ç‚¹é•¿åº¦å¤§äº254å­—èŠ‚ã€‚ç”±äºæ–°çš„entryèŠ‚ç‚¹å¤§äºç­‰äº254å­—èŠ‚ï¼Œè¿™ä¸ªæ–°å¢entryèŠ‚ç‚¹åé¢entryçš„prelenå°±å˜æˆä¸º5ä¸ªå­—èŠ‚ï¼Œè€Œä»–æœ¬èº«å°±æ˜¯åœ¨250</sub>253å­—èŠ‚ä¹‹é—´ï¼Œå½“entryçš„prelenå°±å˜æˆä¸º5ä¸ªå­—èŠ‚ï¼Œå¿…å®šä¼šè¶…è¿‡254ä¸ªèŠ‚ç‚¹ï¼Œé‚£éšåä¼šå¯¼è‡´å…¶ä½™çš„æ‰€æœ‰entryèŠ‚ç‚¹çš„prelenå¢å¤§ä¸º5å­—èŠ‚ã€‚</p><p>ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><img src="http://img.zouyh.top/article-img/20240917135013188.png" alt="image-20230306154239686" style="zoom:80%;"><p>åŒæ ·åœ°ï¼Œåˆ é™¤æ“ä½œä¹Ÿä¼šå¯¼è‡´å‡ºç°è¿é”æ›´æ–°è¿™ç§æƒ…å†µã€‚</p><p>åŒå‘é“¾è¡¨å’Œå‹ç¼©åˆ—è¡¨å¯¹æ¯”ï¼š</p><ul><li>åŒå‘é“¾è¡¨LinkedListä¾¿äºåœ¨è¡¨çš„ä¸¤ç«¯è¿›è¡Œpushå’Œpopæ“ä½œï¼Œåœ¨æ’å…¥èŠ‚ç‚¹ä¸Šå¤æ‚åº¦å¾ˆä½ï¼Œä½†æ˜¯å®ƒçš„å†…å­˜å¼€é”€æ¯”è¾ƒå¤§ã€‚é¦–å…ˆï¼Œå®ƒåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šé™¤äº†è¦ä¿å­˜æ•°æ®ä¹‹å¤–ï¼Œè¿˜æœ‰é¢å¤–ä¿å­˜ä¸¤ä¸ªæŒ‡é’ˆï¼›å…¶æ¬¡ï¼ŒåŒå‘é“¾è¡¨çš„å„ä¸ªèŠ‚ç‚¹éƒ½æ˜¯å•ç‹¬çš„å†…å­˜å—ï¼Œåœ°å€ä¸è¿ç»­ï¼Œå®¹æ˜“å½¢æˆå†…å­˜ç¢ç‰‡</li><li>zipListå­˜å‚¨åœ¨ä¸€å—è¿ç»­çš„å†…å­˜ä¸Šï¼Œæ‰€ä»¥å­˜å‚¨æ•ˆç‡å¾ˆé«˜ã€‚ä½†æ˜¯å®ƒä¸åˆ©äºä¿®æ”¹æ“ä½œï¼Œæ’å…¥å’Œåˆ é™¤æ“ä½œéœ€è¦é¢‘ç¹åœ°ç”³è¯·å’Œé‡Šæ”¾å†…å­˜ã€‚ç‰¹åˆ«æ˜¯å½“zipListé•¿åº¦å¾ˆé•¿æ—¶ï¼Œä¸€æ¬¡reallocå¯èƒ½ä¼šå¯¼è‡´å¤§é‡çš„æ•°æ®æ‹·è´</li></ul><h5 id="_2-3-3-å¿«é€Ÿåˆ—è¡¨-quicklist" tabindex="-1"><a class="header-anchor" href="#_2-3-3-å¿«é€Ÿåˆ—è¡¨-quicklist"><span>2.3.3 å¿«é€Ÿåˆ—è¡¨ quickList</span></a></h5><p>åœ¨Redis3.2ç‰ˆæœ¬ä¹‹åï¼Œlistçš„åº•å±‚å®ç°æ–¹å¼åˆå¤šäº†ä¸€ç§ï¼ŒquickListã€‚qucikListæ˜¯ç”±zipListå’ŒåŒå‘é“¾è¡¨linkedListç»„æˆçš„æ··åˆä½“ã€‚å®ƒå°†linkedListæŒ‰æ®µåˆ‡åˆ†ï¼Œå•ä¸ªèŠ‚ç‚¹ä½¿ç”¨zipListæ¥ç´§å‡‘å­˜å‚¨ï¼Œå¤šä¸ªzipListä¹‹é—´ä½¿ç”¨åŒå‘æŒ‡é’ˆä¸²æ¥èµ·æ¥ã€‚</p><p>qucikListçš„æ•°æ®ç»“æ„ï¼š</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">typedf </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> quicklist{</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    quicklistNode</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> head;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // æŒ‡å‘å¤´ç»“ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    quicklistNode</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> tail;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // æŒ‡å‘å°¾èŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    long</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> count;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // å…ƒç´ æ€»æ•°</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nodes;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // quicklistNodeèŠ‚ç‚¹çš„ä¸ªæ•°</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> compressDepth;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // å‹ç¼©ç®—æ³•æ·±åº¦		</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    ...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}quickList</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>quicklistNodeçš„æ•°æ®ç»“æ„ï¼š</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">typedf </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> quicklistNode{</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    quicklistNode</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> prev;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // å‰ä¸€ä¸ªèŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    quicklistNode</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> next;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // åä¸€ä¸ªèŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    ziplist</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> zl;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // å‹ç¼©åˆ—è¡¨	</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    int32 size;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	// ziplistå¤§å°	</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    int16 count;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // ziplist ä¸­å…ƒç´ æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    int2 encoding;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// ç¼–ç å½¢å¼ å­˜å‚¨ ziplist è¿˜æ˜¯è¿›è¡Œ LZF å‹ç¼©å‚¨å­˜çš„zipList	</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    ...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}quickListNode</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure><img src="http://img.zouyh.top/article-img/20240917135015195.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æ‰“å¼€redis.confæ–‡ä»¶:</p><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-properties"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># quickListä¸­æ¯ä¸ªziplistèŠ‚ç‚¹å¯ä»¥å­˜å‚¨å¤šä¸ªå…ƒç´ ,quickListå†…éƒ¨é»˜è®¤å•ä¸ªzipListé•¿åº¦ä¸º8kå­—èŠ‚ï¼Œå³list-max-ziplist-sizeä¸º -2ï¼Œè¶…å‡ºäº†è¿™ä¸ªé˜ˆå€¼ï¼Œå°±ä¼šé‡æ–°ç”Ÿæˆä¸€ä¸ªzipListæ¥å­˜å‚¨æ•°æ®ã€‚æ€§èƒ½æœ€å¥½çš„æ—¶å€™å°±æ˜¯å°±æ˜¯list-max-ziplist-sizeä¸º-1å’Œ-2ï¼Œå³åˆ†åˆ«æ˜¯4kbå’Œ8kbçš„æ—¶å€™ï¼Œå½“ç„¶ï¼Œè¿™ä¸ªå€¼ä¹Ÿå¯ä»¥è¢«è®¾ç½®ä¸ºæ­£æ•°ï¼Œå½“list-max-ziplist-szieä¸ºæ­£æ•°næ—¶ï¼Œè¡¨ç¤ºæ¯ä¸ªquickListèŠ‚ç‚¹ä¸Šçš„zipListæœ€å¤šåŒ…å«nä¸ªæ•°æ®é¡¹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">list-max-ziplist-size -2</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å‹ç¼©æ·±åº¦,quickListä¸­å¯ä»¥ä½¿ç”¨å‹ç¼©ç®—æ³•å¯¹zipListè¿›è¡Œè¿›ä¸€æ­¥çš„å‹ç¼©ï¼Œè¿™ä¸ªç®—æ³•å°±æ˜¯LZFç®—æ³•ï¼Œè¿™æ˜¯ä¸€ç§æ— æŸå‹ç¼©ç®—æ³•,list-compress-depthè¿™ä¸ªå‚æ•°è¡¨ç¤ºä¸€ä¸ªquickListä¸¤ç«¯ä¸è¢«å‹ç¼©çš„èŠ‚ç‚¹ä¸ªæ•°,ä¾‹å¦‚list-compress-depthä¸º1ï¼Œè¡¨ç¤ºquickListçš„ä¸¤ç«¯å„æœ‰1ä¸ªèŠ‚ç‚¹ä¸è¿›è¡Œå‹ç¼©ï¼Œä¸­é—´ç»“ç‚¹å¼€å§‹è¿›è¡Œå‹ç¼©ï¼›</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">list-compress-depth 0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä¸‰-hash" tabindex="-1"><a class="header-anchor" href="#ä¸‰-hash"><span>ä¸‰ï¼ŒHash</span></a></h3><h4 id="_3-1-å¸¸ç”¨å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#_3-1-å¸¸ç”¨å‘½ä»¤"><span>3.1 å¸¸ç”¨å‘½ä»¤</span></a></h4><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ’å€¼ï¼šç»™&lt;key&gt;é›†åˆä¸­çš„&lt;field&gt;é”®èµ‹å€¼&lt;value&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hset</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">fiel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">d&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">valu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å–å€¼ï¼šä»&lt;key&gt;é›†åˆ&lt;field&gt;å–å‡ºvalue</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">fiel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">d&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ‰¹é‡æ’å€¼ï¼šæ‰¹é‡è®¾ç½®hashçš„å€¼</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hmset</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">1&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">field</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">1&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">1&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">field</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">2&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">2&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">...</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åˆ¤æ–­filedæ˜¯å¦å­˜åœ¨ï¼šæŸ¥çœ‹å“ˆå¸Œè¡¨ key ä¸­ï¼Œç»™å®šåŸŸ field æ˜¯å¦å­˜åœ¨</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hexists</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">fiel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">d&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è·å–ä¸€ä¸ªhashç±»å‹çš„keyä¸­çš„æ‰€æœ‰çš„fieldå’Œvalue</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hgetall</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è·å–æ‰€æœ‰çš„filedï¼šåˆ—å‡ºè¯¥hashé›†åˆçš„æ‰€æœ‰field</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hkeys</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è·å–æ‰€æœ‰çš„valueï¼šåˆ—å‡ºè¯¥hashé›†åˆçš„æ‰€æœ‰value</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hvals</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å¢é‡ï¼šä¸ºå“ˆå¸Œè¡¨ key ä¸­çš„åŸŸ field çš„å€¼åŠ ä¸Šæ­¥é•¿</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hincrby</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">fiel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">d&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">æ­¥é•¿</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ä¸å­˜åœ¨ï¼Œæ’å€¼ï¼šå°†å“ˆå¸Œè¡¨ key ä¸­çš„åŸŸ field çš„å€¼è®¾ç½®ä¸º value ï¼Œå½“ä¸”ä»…å½“åŸŸ field ä¸å­˜åœ¨</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hsetnx</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">fiel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">d&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">valu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-åº”ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#_3-2-åº”ç”¨åœºæ™¯"><span>3.2 åº”ç”¨åœºæ™¯</span></a></h4><p>ç”µå•†ç³»ç»Ÿè´­ç‰©è½¦æ•°æ®å­˜å‚¨ï¼Œå­˜å‚¨çš„ç»“æ„ä¸º ç”¨æˆ·IDä¸ºkeyï¼Œå•†å“IDä¸ºfieldï¼Œå•†å“æ•°é‡ä¸ºvalueã€‚è´­ç‰©è½¦å•†å“æ•°é‡+1ä½¿ç”¨<code>hincrby &lt;key&gt; &lt;field&gt; æ­¥é•¿</code>ã€‚</p><h4 id="_3-3-æ•°æ®ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_3-3-æ•°æ®ç»“æ„"><span>3.3 æ•°æ®ç»“æ„</span></a></h4><p>å½“æ•°æ®é‡æ¯”è¾ƒå°ï¼Œæˆ–è€…å•ä¸ªå…ƒç´ æ¯”è¾ƒå°æ—¶ï¼Œåº•å±‚ç”¨ziplistå­˜å‚¨ï¼Œè¯¦æƒ…å‚è€ƒä¸Šæ–¹ã€‚</p><p>Hash æ•°æ®ç»“æ„åº•å±‚å®ç°å­—å…¸dictæ•°æ®ç»“æ„ï¼š</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> dict {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	dictType </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">type;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     // ç±»å‹å‡½æ•°ï¼Œç”¨äºå®ç°å¤šæ€</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	void</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">privdata;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     // ç§æœ‰æ•°æ®ï¼Œç”¨äºå®ç°å¤šæ€</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	dictht </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ht</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       // å“ˆå¸Œè¡¨ï¼Œå­—å…¸ä½¿ç”¨ ht[0] ä½œä¸ºå“ˆå¸Œè¡¨ï¼Œht[1] ç”¨äºè¿›è¡Œ rehash</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> rehashidx;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      // rehashç´¢å¼•ï¼Œå½“æ²¡æœ‰æ‰§è¡Œ rehash æ—¶ï¼Œå…¶å€¼ä¸º -1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} dict;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å“ˆå¸Œè¡¨æ•°æ®ç»“æ„ï¼š</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> dictht {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	dictEntry </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">**</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">table;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      // å“ˆå¸Œè¡¨æ•°ç»„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå•å‘é“¾è¡¨</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	unsigned</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> long</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> size;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     // å“ˆå¸Œè¡¨æ•°ç»„å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	unsigned</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> long</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sizemask;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // å“ˆå¸Œæ©ç ï¼Œç”¨äºè®¡ç®—ç´¢å¼•</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	unsigned</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> long</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> used;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     // å·²æœ‰èŠ‚ç‚¹æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} dictht;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å“ˆå¸Œè¡¨èŠ‚ç‚¹æ•°æ®ç»“æ„ï¼š</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> dictEntry {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	void*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> key;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // é”®</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	union</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     // å€¼ï¼Œå¯ä»¥ä¸ºæŒ‡é’ˆã€æœ‰ç¬¦å·é•¿æ•´ï¼Œæ— ç¬¦å·é•¿æ•´ï¼ŒåŒç²¾åº¦æµ®ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">		void</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">val;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">		uint64_t</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> u64;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">		int64_t</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> s64;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">		double</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> d;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	} v;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> dictEntry </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">next;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} dictEntry;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ•´ä½“å­˜å‚¨ç»“æ„ï¼š</p><figure><img src="http://img.zouyh.top/article-img/20240917135016196.png" alt="image-20230306162901314" tabindex="0" loading="lazy"><figcaption>image-20230306162901314</figcaption></figure><h5 id="_3-2-1-æ¸è¿›å¼rehash" tabindex="-1"><a class="header-anchor" href="#_3-2-1-æ¸è¿›å¼rehash"><span>3.2.1 æ¸è¿›å¼rehash</span></a></h5><p>â€‹ dictæ•°æ®ç»“æ„ä¸­å“ˆå¸Œè¡¨å®šä¹‰äº†ä¸¤ä¸ª<code>dictht ht[2]</code>ï¼Œä¹‹æ‰€ä»¥å®šä¹‰äº† 2 ä¸ªå“ˆå¸Œè¡¨ï¼Œæ˜¯å› ä¸ºè¿›è¡Œ rehash çš„æ—¶å€™ï¼Œéœ€è¦å°†å“ˆå¸Œè¡¨ 1ä¸­çš„æ‰€æœ‰å€¼è¿ç§»åˆ°å“ˆå¸Œè¡¨2ä¸­ã€‚</p><p>â€‹ â‘ ï¼Œrehash çš„æ­¥éª¤ï¼šæ¯æ¬¡å“ˆå¸Œè¡¨å…ƒç´ è¿›è¡Œæ–°å¢ã€åˆ é™¤ã€æŸ¥æ‰¾æˆ–è€…æ›´æ–°æ“ä½œæ—¶ï¼ŒRedisé™¤äº†ä¼šæ‰§è¡Œå¯¹åº”çš„æ“ä½œä¹‹å¤–ï¼Œè¿˜ä¼šé¡ºåºå°†å“ˆå¸Œè¡¨ 1ä¸­ç´¢å¼•ä½ç½®ä¸Šçš„æ‰€æœ‰ key-value è¿ç§»åˆ°å“ˆå¸Œè¡¨ 2ä¸Šï¼›éšç€å¤„ç†å®¢æˆ·ç«¯å‘èµ·çš„å“ˆå¸Œè¡¨æ“ä½œè¯·æ±‚æ•°é‡è¶Šå¤šï¼Œæœ€ç»ˆåœ¨æŸä¸ªæ—¶é—´ç‚¹ä¼šæŠŠå“ˆå¸Œè¡¨ 1çš„æ‰€æœ‰ key-value è¿ç§»åˆ°å“ˆå¸Œè¡¨2ï¼Œä»è€Œå®Œæˆrehash æ“ä½œï¼Œè¿™æ ·å°±å·§å¦™åœ°æŠŠä¸€æ¬¡æ€§å¤§é‡æ•°æ®è¿ç§»å·¥ä½œçš„å¼€é”€ï¼Œåˆ†æ‘Šåˆ°äº†å¤šæ¬¡å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­ï¼Œé¿å…äº†ä¸€æ¬¡æ€§ rehash çš„è€—æ—¶æ“ä½œã€‚<br> â€‹ â‘¡ï¼Œrehash è§¦å‘æ¡ä»¶ï¼šrehash çš„è§¦å‘æ¡ä»¶è·Ÿè´Ÿè½½å› å­æœ‰å…³ï¼Œè´Ÿè½½å› å­ = hashè¡¨å·²ä¿å­˜çš„èŠ‚ç‚¹æ•°é‡ / hashè¡¨å¤§å°</p><ul><li>å½“è´Ÿè½½å› å­å¤§äºç­‰äº 1 æ—¶ï¼ŒRedis æ²¡æœ‰åœ¨æ‰§è¡Œ bgsave å‘½ä»¤æˆ–è€… bgrewiteaof å‘½ä»¤ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰æ‰§è¡Œ RDB å¿«ç…§æˆ–æ²¡æœ‰è¿›è¡Œ AOF é‡å†™çš„æ—¶å€™ï¼Œå°±ä¼šè¿›è¡Œ rehash æ“ä½œ</li><li>å½“è´Ÿè½½å› å­å¤§äºç­‰äº 5 æ—¶ï¼Œæ­¤æ—¶è¯´æ˜å“ˆå¸Œå†²çªéå¸¸ä¸¥é‡äº†ï¼Œä¸ç®¡Redis æœ‰æ²¡æœ‰åœ¨æ‰§è¡Œ RDB å¿«ç…§æˆ– AOF é‡å†™ï¼Œéƒ½ä¼šå¼ºåˆ¶è¿›è¡Œ rehash æ“ä½œ</li></ul><h3 id="å››-set" tabindex="-1"><a class="header-anchor" href="#å››-set"><span>å››ï¼ŒSet</span></a></h3><h4 id="_4-1-å¸¸ç”¨å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#_4-1-å¸¸ç”¨å‘½ä»¤"><span>4.1 å¸¸ç”¨å‘½ä»¤</span></a></h4><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ·»åŠ ï¼šå°†ä¸€ä¸ªæˆ–å¤šä¸ª member å…ƒç´ åŠ å…¥åˆ°é›†åˆ key ä¸­ï¼Œå·²ç»å­˜åœ¨çš„ member å…ƒç´ å°†è¢«å¿½ç•¥</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sadd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">1&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">2&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.....</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å–å‡ºè¯¥é›†åˆçš„æ‰€æœ‰å€¼</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">smembers</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åˆ¤æ–­é›†åˆ&lt;key&gt;æ˜¯å¦ä¸ºå«æœ‰è¯¥&lt;value&gt;å€¼ï¼Œæœ‰1ï¼Œæ²¡æœ‰0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sismember</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">valu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è¿”å›è¯¥é›†åˆçš„å…ƒç´ ä¸ªæ•°</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">scard</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åˆ é™¤é›†åˆä¸­çš„å…ƒç´ </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">srem</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">1&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">2&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.....</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># éšæœºä»è¯¥é›†åˆä¸­å–å‡ºnä¸ªå€¼ï¼Œå–å‡ºçš„å€¼ä¼šä»é›†åˆä¸­åˆ é™¤</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">spop</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;n&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># éšæœºä»è¯¥é›†åˆä¸­å–å‡ºnä¸ªå€¼ï¼Œå–å‡ºçš„å€¼ä¸ä¼šä»é›†åˆä¸­åˆ é™¤</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">srandmember</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;n&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŠŠé›†åˆä¸­ä¸€ä¸ªå€¼ä»ä¸€ä¸ªé›†åˆç§»åŠ¨åˆ°å¦ä¸€ä¸ªé›†åˆ</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">smove</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">sourc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">destinatio</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">n&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">value</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è¿”å›ä¸¤ä¸ªé›†åˆçš„äº¤é›†å…ƒç´ </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sinter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">1&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">2&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è¿”å›ä¸¤ä¸ªé›†åˆçš„å¹¶é›†å…ƒç´ </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sunion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">1&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">2&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è¿”å›ä¸¤ä¸ªé›†åˆçš„å·®é›†å…ƒç´ (key1ä¸­çš„ï¼Œä¸åŒ…å«key2ä¸­çš„)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sdiff</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">1&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">2&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-2-åº”ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#_4-2-åº”ç”¨åœºæ™¯"><span>4.2 åº”ç”¨åœºæ™¯</span></a></h4><ul><li>æŠ½å¥–æ´»åŠ¨ï¼šä¸€æ¬¡æŠ½å¥–å¤šä¸ªç”¨æˆ·ï¼Œä¾‹å¦‚å‚ä¸æŠ½å¥–çš„ç”¨æˆ·æœ‰10ä¸ªï¼Œä¸€æ¬¡æŠ½å–2ä¸ªç”¨æˆ·ä½œä¸ºä¸­å¥–ç”¨æˆ·ï¼Œä½¿ç”¨<code>smembers key</code>æŸ¥çœ‹æ‰€æœ‰æŠ½å¥–æˆå‘˜ï¼Œä½¿ç”¨<code>srandmember &lt;key&gt; &lt;n&gt;</code>æŠ½å–nä¸ªæˆå‘˜ï¼Œå¦‚æœå¤šæ¬¡æŠ½å¥–ï¼Œè¢«å¼€å¥–çš„ç”¨æˆ·ä¸å¯å†æ¬¡å‚ä¸ï¼Œå¯ä»¥ä½¿ç”¨<code>srandmember &lt;key&gt; &lt;n&gt;</code>æŠ½å–æˆå‘˜ä½œä¸ºå¼€å¥–ç”¨æˆ·ï¼ŒåŒæ—¶ä¼šç§»é™¤å·²å¼€å¥–çš„ç”¨æˆ·ã€‚</li><li>æœ‹å‹åœˆæ¶ˆæ¯ç‚¹èµæˆå‘˜åˆ—è¡¨ï¼šåœ¨å¾®ä¿¡æœ‹å‹åœˆå½“æˆ‘ç‚¹èµæœ‹å‹çš„ä¸€æ¡æ¶ˆæ¯æ—¶ï¼Œä¼šåœ¨ä¸‹æ–¹æ˜¾ç¤ºç‚¹èµæˆå‘˜åˆ—è¡¨ï¼Œè¿™ä¸ªåˆ—è¡¨åªæ˜¾ç¤ºä¸æˆ‘æ˜¯å¥½å‹ç‚¹èµæˆå‘˜ï¼Œä¸æ˜¯å¥½å‹åˆ™ä¸æ˜¾ç¤ºã€‚é‚£ä¹ˆæ­¤æ—¶å¯ä»¥ä½¿ç”¨äº¤é›†<code>sinter &lt;key1&gt; &lt;key2&gt;</code>æŸ¥è¯¢</li><li>æŸ¥è¯¢æ¡ä»¶äº¤é›†ï¼Œä¾‹å¦‚ç”µå•†ç³»ç»Ÿè´­ä¹°ç”µè„‘æ—¶é…ç½®é€‰æ‹©ï¼Œ</li></ul><h4 id="_4-3-æ•°æ®ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_4-3-æ•°æ®ç»“æ„"><span>4.3 æ•°æ®ç»“æ„</span></a></h4><p>â€‹ æ•´æ•°é›†åˆæ˜¯ Set å¯¹è±¡çš„åº•å±‚å®ç°ä¹‹ä¸€ï¼Œå½“ä¸€ä¸ª Set å¯¹è±¡åªåŒ…å«æ•´æ•°å€¼å…ƒç´ ï¼Œå¹¶ä¸”å…ƒç´ æ•°é‡ä¸å¤§æ—¶ï¼Œå°±ä¼šä½¿ç”¨æ•´æ•°é›†è¿™ä¸ªæ•°æ®ç»“æ„ä½œä¸ºåº•å±‚å®ç°ï¼Œæ•´æ•°é›†åˆæ•°æ®ç»“æ„ï¼š</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> intset {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	uint32_t</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> encoding;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // ç¼–ç æ–¹å¼ï¼ŒæŒ‡ç¤ºå…ƒç´ çš„å®é™…ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	uint32_t</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> length;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // å…ƒç´ æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	int8_t</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> contents</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">[]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // å…ƒç´ æ•°ç»„ï¼Œå…ƒç´ å®é™…ç±»å‹å¯èƒ½ä¸º int16_t,int32_t,int64_t,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} intset;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯¥æ•°æ®ç»“æ„æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š</p><ul><li>æœ‰åºï¼šå…ƒç´ æ•°ç»„ä¸­çš„å…ƒç´ æŒ‰ç…§ä»å°åˆ°å¤§æ’åˆ—ï¼Œä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦ä¸º <code>O(logN)</code></li><li>å‡çº§ï¼šå½“æœ‰æ–°å…ƒç´ åŠ å…¥é›†åˆï¼Œä¸”æ–°å…ƒç´ æ¯”æ‰€æœ‰ç°æœ‰å…ƒç´ ç±»å‹éƒ½é•¿æ—¶ï¼Œé›†åˆéœ€è¦è¿›è¡Œå‡çº§</li></ul><p>å‡çº§æ“ä½œï¼š</p><p>â€‹ æ•´æ•°é›†åˆä¼šæœ‰ä¸€ä¸ªå‡çº§è§„åˆ™ï¼Œå°±æ˜¯å½“æˆ‘ä»¬å°†ä¸€ä¸ªæ–°å…ƒç´ åŠ å…¥åˆ°æ•´æ•°é›†åˆé‡Œé¢ï¼Œå¦‚æœæ–°å…ƒç´ çš„ç±»å‹ï¼ˆint32_tï¼‰æ¯”æ•´æ•°é›†åˆç°æœ‰æ‰€æœ‰å…ƒç´ çš„ç±»å‹ï¼ˆint16_tï¼‰éƒ½è¦é•¿æ—¶ï¼Œæ•´æ•°é›†åˆéœ€è¦å…ˆè¿›è¡Œå‡çº§ï¼Œä¹Ÿå°±æ˜¯æŒ‰æ–°å…ƒç´ çš„ç±»å‹ï¼ˆint32_tï¼‰æ‰©å±• contents æ•°ç»„çš„ç©ºé—´å¤§å°ï¼Œç„¶åæ‰èƒ½å°†æ–°å…ƒç´ åŠ å…¥åˆ°æ•´æ•°é›†åˆé‡Œï¼Œå½“ç„¶å‡çº§çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿè¦ç»´æŒæ•´æ•°é›†åˆçš„æœ‰åºæ€§ã€‚</p><p>â€‹ æ•´æ•°é›†åˆå‡çº§çš„è¿‡ç¨‹ä¸ä¼šé‡æ–°åˆ†é…ä¸€ä¸ªæ–°ç±»å‹çš„æ•°ç»„ï¼Œè€Œæ˜¯åœ¨åŸæœ¬çš„æ•°ç»„ä¸Šæ‰©å±•ç©ºé—´ï¼Œç„¶ååœ¨å°†æ¯ä¸ªå…ƒç´ æŒ‰é—´éš”ç±»å‹å¤§å°åˆ†å‰²ï¼Œå¦‚æœ encoding å±æ€§å€¼ä¸º INTSET_ENC_INT16ï¼Œåˆ™æ¯ä¸ªå…ƒç´ çš„é—´éš”å°±æ˜¯ 16 ä½ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æœ‰ä¸€ä¸ªæ•´æ•°é›†åˆé‡Œæœ‰ 3 ä¸ªç±»å‹ä¸º int16_t çš„å…ƒç´ ï¼š</p><img src="http://img.zouyh.top/article-img/20240917135015193.png" alt="image-20230306170045177" style="zoom:67%;"><p>ç°åœ¨ï¼Œå¾€è¿™ä¸ªæ•´æ•°é›†åˆä¸­åŠ å…¥ä¸€ä¸ªæ–°å…ƒç´  65535ï¼Œè¿™ä¸ªæ–°å…ƒç´ éœ€è¦ç”¨ int32_t ç±»å‹æ¥ä¿å­˜ï¼Œæ‰€ä»¥æ•´æ•°é›†åˆè¦è¿›è¡Œå‡çº§æ“ä½œï¼Œé¦–å…ˆéœ€è¦ä¸º contents æ•°ç»„æ‰©å®¹ï¼Œåœ¨åŸæœ¬ç©ºé—´çš„å¤§å°ä¹‹ä¸Šå†æ‰©å®¹å¤š 80 ä½ï¼ˆ4x32-3x16=80ï¼‰ï¼Œè¿™æ ·å°±èƒ½ä¿å­˜ä¸‹ 4 ä¸ªç±»å‹ä¸º int32_t çš„å…ƒç´ <br><img src="http://img.zouyh.top/article-img/20240917135012185.png" alt="image-20230306170258098" style="zoom:67%;"></p><p>æ‰©å®¹å®Œ contents æ•°ç»„ç©ºé—´å¤§å°åï¼Œéœ€è¦å°†ä¹‹å‰çš„ä¸‰ä¸ªå…ƒç´ è½¬æ¢ä¸º int32_t ç±»å‹ï¼Œå¹¶å°†è½¬æ¢åçš„å…ƒç´ æ”¾ç½®åˆ°æ­£ç¡®çš„ä½ä¸Šé¢ï¼Œå¹¶ä¸”éœ€è¦ç»´æŒåº•å±‚æ•°ç»„çš„æœ‰åºæ€§ä¸å˜ï¼Œæ•´ä¸ªè½¬æ¢è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><img src="http://img.zouyh.top/article-img/20240917135016198.png" alt="315b8745582c4e108431324c0b364225" style="zoom:80%;"><p>æ•´æ•°é›†åˆå‡çº§çš„å¥½å¤„æ˜¯èŠ‚çœå†…å­˜èµ„æºï¼Œä¸æ”¯æŒé™çº§æ“ä½œï¼Œå½“ä¸¤ä¸ªæ¡ä»¶ä»»æ„æ»¡è¶³æ—¶Setå°†ç”¨hashtableå­˜å‚¨æ•°æ®ï¼Œä¸åœ¨ä½¿ç”¨æ•´æ•°é›†åˆï¼š</p><ul><li>å…ƒç´ ä¸ªæ•°å¤§äºé…ç½®æ–‡ä»¶é…ç½®çš„æ•°å€¼512ä¸ªå­—èŠ‚æ—¶ï¼Œ <code>set-max-intset-entries 512</code>,</li><li>å…ƒç´ æ— æ³•ç”¨æ•´å½¢è¡¨ç¤º</li></ul><h3 id="äº”-sortedset" tabindex="-1"><a class="header-anchor" href="#äº”-sortedset"><span>äº”ï¼ŒSortedSet</span></a></h3><h4 id="_5-1-å¸¸ç”¨å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#_5-1-å¸¸ç”¨å‘½ä»¤"><span>5.1 å¸¸ç”¨å‘½ä»¤</span></a></h4><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ’å€¼ï¼šå°†ä¸€ä¸ªæˆ–å¤šä¸ª member å…ƒç´ åŠå…¶ score å€¼åŠ å…¥åˆ°æœ‰åºé›† key å½“ä¸­ã€‚</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">zaddÂ </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;key&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">score</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">1&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">1&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">score</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">2&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">2&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">....</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è¿”å›æœ‰åºé›† key ä¸­ï¼Œä¸‹æ ‡åœ¨&lt;start&gt; &lt;stop&gt;ä¹‹é—´çš„å…ƒç´ ï¼Œ start=0åˆ°stop=-1å°±æ˜¯è¿”å›å…¨éƒ¨çš„å…ƒç´ ï¼Œä»å°åˆ°å¤§æ’åˆ—,å¸¦withscoresï¼Œå¯ä»¥è®©åˆ†æ•°ä¸€èµ·å’Œå€¼è¿”å›åˆ°ç»“æœé›†ã€‚</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">zrange</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">star</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">sto</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">p&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Â  [withscores]Â Â </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è¿”å›æœ‰åºé›† key ä¸­ï¼Œæ‰€æœ‰ score å€¼ä»‹äº min å’Œ max ä¹‹é—´(åŒ…æ‹¬ç­‰äº min æˆ– max )çš„æˆå‘˜ã€‚æœ‰åºé›†æˆå‘˜æŒ‰ score å€¼é€’å¢(ä»å°åˆ°å¤§)æ¬¡åºæ’åˆ—ã€‚</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">zrangebyscore</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> min</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [withscores] </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è¿”å›æœ‰åºé›† key ä¸­ï¼Œæ‰€æœ‰ score å€¼ä»‹äº min å’Œ max ä¹‹é—´(åŒ…æ‹¬ç­‰äº min æˆ– max )çš„æˆå‘˜ï¼Œæ”¹ä¸ºä»å¤§åˆ°å°æ’åˆ—ã€‚</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">zrevrangebyscore</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> key</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> max</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> min</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [withscores]Â Â Â </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å¢é‡ï¼šä¸ºé”®keyä¸ºï¼Œå€¼ä¸ºvalueçš„ scoreåŠ ä¸Šincrementçš„å¢é‡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">zincrby</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">incremen</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">valu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Â Â </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åˆ é™¤ï¼šåˆ é™¤è¯¥é›†åˆä¸‹ï¼ŒæŒ‡å®šå€¼çš„å…ƒç´ </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">zremÂ </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;key&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">valu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ç»Ÿè®¡è¯¥é›†åˆï¼Œåˆ†æ•°åŒºé—´å†…çš„å…ƒç´ ä¸ªæ•°</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">zcount</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">mi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">n&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ma</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">x&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ’åï¼šè¿”å›è¯¥å€¼åœ¨é›†åˆä¸­çš„æ’åï¼Œä»0å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">zrank</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">valu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-2-åº”ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#_5-2-åº”ç”¨åœºæ™¯"><span>5.2 åº”ç”¨åœºæ™¯</span></a></h4><p>â€‹ ä½“è‚²èµ›äº‹æ’è¡Œæ¦œã€æ–°é—»çƒ­åº¦æ’è¡Œæ¦œï¼Œçƒ­ç‚¹æ’è¡Œæ¦œã€‚æˆ‘ä»¬ä»»æ„æ‰“å¼€ä¸€ä¸ªæ–°é—»ç½‘ç«™ï¼Œæ€»æœ‰å—åŒºåŸŸæ˜¾ç¤ºæ’è¡Œå‰10çš„æ–°é—»ï¼Œæ’è¡Œç‰ˆä¸€èˆ¬éƒ½æ˜¯æ ¹æ®ç‚¹å‡»æ•°æ¥æ’è¡Œçš„ï¼Œè¿™ä¸ªç‚¹å‡»æ•°å°±å¯ä»¥ä½¿ç”¨<code>zincrby &lt;key&gt; &lt;increment&gt; &lt;value&gt; </code>æŒ‡ä»¤æ¥å®ç°</p><h4 id="_5-3-æ•°æ®ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_5-3-æ•°æ®ç»“æ„"><span>5.3 æ•°æ®ç»“æ„</span></a></h4><p>zsetæ•°æ®ç»“æ„ï¼š</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> zset {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    dict </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">dict;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      // ç»´æŠ¤ member -&gt; score çš„æ˜ å°„ï¼ŒæŸ¥æ‰¾ç»™çš„æˆå‘˜çš„åˆ†å€¼</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    zskiplist </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">zsl;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // æŒ‰ score å¤§å°ä¿å­˜äº†æ‰€æœ‰é›†åˆå…ƒç´ ï¼Œæ”¯æŒèŒƒå›´æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} zset;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è·³è¡¨zskiplistæ•°æ®ç»“æ„ï¼š</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> zskiplist {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> zskiplistNode </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">header, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">tail;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    unsigned</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> long</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> length;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // è·³è¡¨çš„èŠ‚ç‚¹çš„ä¸ªæ•°ï¼ˆä¸åŒ…å«å¤´èŠ‚ç‚¹ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> level;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // è·³è¡¨çš„èŠ‚ç‚¹çš„æœ€å¤§é«˜åº¦ï¼ˆä¸åŒ…æ‹¬å¤´èŠ‚ç‚¹ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} zskiplist;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>èŠ‚ç‚¹æ•°æ®ç»“æ„ï¼š</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typedef</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> zskiplistNode {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    sds ele;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // è¯¥èŠ‚ç‚¹æ‰€å­˜å‚¨çš„å­—ç¬¦ä¸²å€¼</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    double</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> score;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // è¯¥èŠ‚ç‚¹æ’åºçš„åˆ†å€¼</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> zskiplistNode </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">backward;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // å½“å‰èŠ‚ç‚¹æœ€åº•å±‚çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¤´èŠ‚ç‚¹å’Œç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„backwardæŒ‡å‘NULL</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> zskiplistLevel {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> zskiplistNode </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">forward;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // æŒ‡å‘åŒä¸€å±‚çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°¾èŠ‚ç‚¹çš„forwardæŒ‡å‘NULL</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        unsigned</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> long</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> span;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // forwardæŒ‡å‘çš„èŠ‚ç‚¹ä¸æœ¬èŠ‚ç‚¹ä¹‹é—´çš„èŠ‚ç‚¹çš„ä¸ªæ•°ï¼Œspanè¶Šå¤§è¯´æ˜è·³è¿‡çš„èŠ‚ç‚¹çš„ä¸ªæ•°è¶Šå¤š</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    } level</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">[]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} zskiplistNode;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å­˜å‚¨ç»“æ„ï¼š</p><figure><img src="http://img.zouyh.top/article-img/20240917135016199.png" alt="image-20230307105530039" tabindex="0" loading="lazy"><figcaption>image-20230307105530039</figcaption></figure><p>æŸ¥æ‰¾å’Œæ’å…¥èŠ‚ç‚¹çš„æ–¹å¼ï¼š</p><ul><li>æŸ¥æ‰¾æ—¶å€™ä»è®°å½•çš„æœ€é«˜levelæŸ¥æ‰¾ï¼Œå¦‚æœforwardæŒ‡å‘NULLå°±å‘ä¸‹ä¸€å±‚æŸ¥è¯¢ã€‚</li><li>æ’å…¥èŠ‚ç‚¹çš„é«˜åº¦æ˜¯éšæœºçš„ï¼Œè°ƒç”¨zslRandomLevelå‡½æ•°ä¸ºèŠ‚ç‚¹éšæœºç”Ÿæˆé«˜åº¦ã€‚</li></ul><p>æœ‰åºé›†åˆå¯¹è±¡æœ‰2ç§ç¼–ç æ–¹æ¡ˆï¼Œå½“åŒæ—¶æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ—¶ï¼Œé›†åˆå¯¹è±¡é‡‡ç”¨ziplistç¼–ç ï¼Œå¦åˆ™é‡‡ç”¨skiplistç¼–ç ï¼š</p><ul><li><code>zset-max-ziplist-value</code> ï¼šå½“ member çš„é•¿åº¦éƒ½å°äºè¯¥å€¼æ—¶ä½¿ç”¨ ziplist ç¼–ç ï¼ˆé»˜è®¤ä¸º 64å­—èŠ‚ï¼‰</li><li><code>zset-max-ziplist-entries</code> ï¼šå½“ zset ä¸­çš„å…ƒç´ æ•°é‡å°äºè¯¥å€¼æ—¶ä½¿ç”¨ ziplist ç¼–ç ï¼ˆé»˜è®¤ä¸º 128ä¸ª)</li></ul><h3 id="å…­-bitmaps" tabindex="-1"><a class="header-anchor" href="#å…­-bitmaps"><span>å…­ï¼ŒBitMaps</span></a></h3><h4 id="_6-1-å¸¸ç”¨å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#_6-1-å¸¸ç”¨å‘½ä»¤"><span>6.1 å¸¸ç”¨å‘½ä»¤</span></a></h4><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è®¾ç½®å€¼ valueï¼šè®¾ç½®Bitmapsä¸­æŸä¸ªåç§»é‡çš„å€¼ï¼ˆ0æˆ–1ï¼‰offsetï¼šåç§»é‡ï¼Œä»0å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">setbit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">offse</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">valu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å–å€¼ offsetï¼šåç§»é‡ï¼Œä»0å¼€å§‹</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getbit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">offse</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ç»Ÿè®¡ ç»Ÿè®¡å­—ç¬¦ä¸²ä»startå­—èŠ‚åˆ°endå­—èŠ‚æ¯”ç‰¹å€¼ä¸º1çš„æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bitcount</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; [start </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">end]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#bitopæ˜¯ä¸€ä¸ªå¤åˆæ“ä½œ,å®ƒå¯ä»¥åšå¤šä¸ªBitmapsçš„and(äº¤é›†),or(å¹¶é›†),not(é),xor(å¼‚æˆ–) æ“ä½œå¹¶å°†ç»“æœä¿å­˜åœ¨destkeyä¸­ã€‚</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">bitopÂ </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (and/or/not/xor) &lt;destkey&gt; [keyâ€¦]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-2-å®ç°ç»†èŠ‚" tabindex="-1"><a class="header-anchor" href="#_6-2-å®ç°ç»†èŠ‚"><span>6.2 å®ç°ç»†èŠ‚</span></a></h4><p>â€‹ ç°ä»£è®¡ç®—æœºç”¨äºŒè¿›åˆ¶ï¼ˆä½ï¼‰ ä½œä¸ºä¿¡æ¯çš„åŸºç¡€å•ä½ï¼Œ 1ä¸ªå­—èŠ‚ç­‰äº8ä½ï¼Œ ä¾‹å¦‚â€œabcâ€å­—ç¬¦ä¸²æ˜¯ç”±3ä¸ªå­—èŠ‚ç»„æˆï¼Œ ä½†å®é™…åœ¨è®¡ç®—æœºå­˜å‚¨æ—¶å°†å…¶ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œ â€œabcâ€åˆ†åˆ«å¯¹åº”çš„ASCIIç åˆ†åˆ«æ˜¯97ã€ 98ã€ 99ï¼Œ å¯¹åº”çš„äºŒè¿›åˆ¶åˆ†åˆ«æ˜¯01100001ã€ 01100010å’Œ01100011ï¼Œå¦‚ä¸‹å›¾ï¼š</p><figure><img src="http://img.zouyh.top/article-img/20240917135016197.png" alt="image-20230307110352968" tabindex="0" loading="lazy"><figcaption>image-20230307110352968</figcaption></figure><p>åˆç†åœ°ä½¿ç”¨æ“ä½œä½èƒ½å¤Ÿæœ‰æ•ˆåœ°æé«˜å†…å­˜ä½¿ç”¨ç‡å’Œå¼€å‘æ•ˆç‡ã€‚Redisæä¾›äº†Bitmapsè¿™ä¸ªâ€œæ•°æ®ç±»å‹â€å¯ä»¥å®ç°å¯¹ä½çš„æ“ä½œã€‚</p><p>â€‹ Bitmapsæœ¬èº«ä¸æ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œ å®é™…ä¸Šå®ƒå°±æ˜¯å­—ç¬¦ä¸²ï¼ˆkey-valueï¼‰ ï¼Œ ä½†æ˜¯å®ƒå¯ä»¥å¯¹å­—ç¬¦ä¸²çš„ä½è¿›è¡Œæ“ä½œï¼ŒBitmapså•ç‹¬æä¾›äº†ä¸€å¥—å‘½ä»¤ï¼Œ æ‰€ä»¥åœ¨Redisä¸­ä½¿ç”¨Bitmapså’Œä½¿ç”¨å­—ç¬¦ä¸²çš„æ–¹æ³•ä¸å¤ªç›¸åŒã€‚ å¯ä»¥æŠŠBitmapsæƒ³è±¡æˆä¸€ä¸ªä»¥ä½ä¸ºå•ä½çš„æ•°ç»„ï¼Œ æ•°ç»„çš„æ¯ä¸ªå•å…ƒåªèƒ½å­˜å‚¨0å’Œ1ï¼Œ æ•°ç»„çš„ä¸‹æ ‡åœ¨Bitmapsä¸­å«åšåç§»é‡ã€‚</p><blockquote><p>Bitmapsç»å¸¸ç”¨æ¥ç»Ÿè®¡è¾ƒå¤§ç”¨æˆ·çš„æ—¥æ´»è·ƒã€‚</p></blockquote><h3 id="ä¸ƒ-geospatial" tabindex="-1"><a class="header-anchor" href="#ä¸ƒ-geospatial"><span>ä¸ƒï¼ŒGeospatial</span></a></h3><h4 id="_7-1-å¸¸ç”¨å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#_7-1-å¸¸ç”¨å‘½ä»¤"><span>7.1 å¸¸ç”¨å‘½ä»¤</span></a></h4><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ·»åŠ åœ°ç†ä½ç½®ï¼ˆç»åº¦ï¼Œçº¬åº¦ï¼Œåç§°ï¼‰ï¼Œä¸¤ææ— æ³•ç›´æ¥æ·»åŠ ï¼Œä¸€èˆ¬ä¼šä¸‹è½½åŸå¸‚æ•°æ®ï¼Œç›´æ¥é€šè¿‡ Java ç¨‹åºä¸€æ¬¡æ€§å¯¼å…¥ï¼Œå·²ç»æ·»åŠ çš„æ•°æ®ï¼Œæ˜¯æ— æ³•å†æ¬¡å¾€é‡Œé¢æ·»åŠ çš„ï¼Œæœ‰æ•ˆçš„ç»åº¦ä» -180 åº¦åˆ° 180 åº¦ã€‚æœ‰æ•ˆçš„çº¬åº¦ä» -85.05112878 åº¦åˆ° 85.05112878 åº¦ã€‚å½“åæ ‡ä½ç½®è¶…å‡ºæŒ‡å®šèŒƒå›´æ—¶ï¼Œè¯¥å‘½ä»¤å°†ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">geoadd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">longitud</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">latitud</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">membe</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">r&gt; [longitude </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">latitude</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> member...]Â </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># geopos è·å–æŸä¸ªå…ƒç´ çš„åœ°ç†ä½ç½®ç»çº¬åº¦</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">geoadd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">membe</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">r&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è·å–ä¸¤ä¸ªä½ç½®ä¹‹é—´çš„ç›´çº¿è·ç¦»</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">geodist</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">member</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">1&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">member</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">2&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Â  [m|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">km</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ft</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mi]Â </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ä»¥ç»™å®šçš„ç»çº¬åº¦ä¸ºä¸­å¿ƒï¼Œæ‰¾å‡ºæŸä¸€åŠå¾„å†…çš„å…ƒç´  </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">georadius</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">longitud</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">latitud</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">åŠå¾„</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> m</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">km</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ft</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mi</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># georadiusbymember è·Ÿ georadius å‘½ä»¤ä¸€æ ·ï¼Œéƒ½å¯ä»¥æ‰¾å‡ºä½äºæŒ‡å®šèŒƒå›´çš„ä½ç½®å…ƒç´ ï¼Œä½†æ˜¯è¿™é‡Œä¸æ˜¯æŒ‡å®šä¸­å¿ƒç‚¹åæ ‡ï¼Œè€Œæ˜¯æŒ‡å®šä»¥å“ªä¸ªå…ƒç´ ä¸ºä¸­å¿ƒç‚¹ã€‚</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">georadius</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">membe</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">r&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">åŠå¾„</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> m</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">km</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ft</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mi</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7-2-å®ç°ç»†èŠ‚" tabindex="-1"><a class="header-anchor" href="#_7-2-å®ç°ç»†èŠ‚"><span>7.2 å®ç°ç»†èŠ‚</span></a></h4><blockquote><p>geo åº•å±‚åŸç†æ˜¯ä½¿ç”¨è·³è¡¨å®ç°ï¼Œåˆ†å€¼æ˜¯æ ¹æ®ç»çº¬åº¦è¿›è¡Œgeohashçš„å¾—åˆ°å€¼ã€‚</p></blockquote><p>geohash æ˜¯ 2008 å¹´ Gustavo Niemeye å‘æ˜ç”¨æ¥ç¼–ç ç»çº¬åº¦ä¿¡æ¯çš„ä¸€ç§ç¼–ç æ–¹å¼ï¼Œæ¯”å¦‚åŒ—äº¬å¸‚ä¸­å¿ƒçš„ç»çº¬åº¦åæ ‡æ˜¯ 116.404844,39.912279ï¼Œé€šè¿‡ 12 ä½ geohash ç¼–ç åå°±å˜æˆäº† wx4g0cg3vkndï¼Œå®ƒç©¶ç«Ÿæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿå…¶å®åŸç†éå¸¸ç®€å•ï¼Œå°±æ˜¯äºŒåˆ†ï¼Œæ•´ä¸ªç¼–ç è¿‡ç¨‹å¯ä»¥åˆ†ä¸ºå¦‚ä¸‹å‡ æ­¥ï¼š</p><p><strong>ç¬¬ä¸€æ­¥ï¼šè½¬äºŒè¿›åˆ¶</strong></p><p>â€‹ ä¸Šè¿‡åˆä¸­åœ°ç†çš„æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œåœ°çƒä¸Šä»»ä½•ä¸€ä¸ªç‚¹éƒ½å¯ä»¥æ ‡è¯†ä¸ºæŸä¸ªç»çº¬åº¦åæ ‡ï¼Œç»åº¦çš„å–å€¼èŒƒå›´æ˜¯ä¸œç» 0-180 åº¦å’Œè¥¿ç» 0-180 åº¦ï¼Œçº¬åº¦çš„å–å€¼èŒƒå›´æ˜¯åŒ—çº¬ 0-90 å’Œå—çº¬ 0-90 åº¦ã€‚å»æ‰ä¸œè¥¿å—åŒ—ï¼Œå¯ä»¥åˆ†åˆ«è®¤ä¸ºç»åº¦å’Œçº¬åº¦çš„å–å€¼èŒƒå›´ä¸º[-180,180]å’Œ[-90,90]ã€‚</p><img src="http://img.zouyh.top/article-img/20240917135014191.png" alt="image-20230307112411274" style="zoom:80%;"><p>æˆ‘ä»¬å…ˆæ¥çœ‹ç»åº¦ï¼Œ[-180,180]å¯ä»¥ç®€å•åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†[-180,0]å’Œ[0,180]ï¼Œå¯¹äºç»™å®šçš„ä¸€ä¸ªå…·ä½“å€¼ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªbit æ¥æ ‡è¯†æ˜¯åœ¨[-180,0]è¿˜æ˜¯[0,180]åŒºé—´é‡Œã€‚ç„¶åæˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸¤ä¸ªå­åŒºé—´ç»§ç»­ç»†åˆ†ï¼Œç”¨æ›´å¤šçš„ bit æ¥æ ‡è¯†æ˜¯è¿™ä¸ªå€¼æ˜¯åœ¨å“ªä¸ªå­åŒºé—´é‡Œã€‚å°±å¥½æ¯”ç”¨äºŒåˆ†æŸ¥æ‰¾ï¼Œè®°å½•ä¸‹æ¯æ¬¡æŸ¥æ‰¾çš„è·¯å¾„ï¼Œå¾€å·¦å°±æ˜¯ 0 å¾€å³æ˜¯ 1ï¼ŒæŸ¥æ‰¾å®Œåæˆ‘ä»¬å°±ä¼šå¾—åˆ°ä¸€ä¸ª 0101 çš„ä¸²ï¼Œè¿™ä¸ªä¸²å°±å¯ä»¥ç”¨æ¥æ ‡è¯†è¿™ä¸ªç»åº¦å€¼ã€‚</p><figure><img src="http://img.zouyh.top/article-img/20240917135014192.png" alt="image-20230307112648832" tabindex="0" loading="lazy"><figcaption>image-20230307112648832</figcaption></figure><p>åŒç†çº¬åº¦ä¹Ÿæ˜¯ä¸€æ ·ï¼Œåªä¸è¿‡ä»–çš„å–å€¼è¿”å›å˜æˆäº†[-90,90]è€Œå·²ã€‚é€šè¿‡è¿™ä¸¤ç§æ–¹å¼ç¼–ç å®Œæˆåï¼Œä»»æ„ç»çº¬åº¦æˆ‘ä»¬éƒ½å¯ä»¥å¾—åˆ°ä¸¤ä¸ªç”±0å’Œ1ç»„æˆçš„ä¸²ã€‚</p><figure><img src="http://img.zouyh.top/article-img/20240917135013186.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>ç¬¬äºŒæ­¥ï¼šç»çº¬åº¦äºŒè¿›åˆ¶åˆå¹¶</strong></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦å°†ä¸Šè¿°äºŒè¿›åˆ¶äº¤é”™åˆå¹¶æˆä¸€ä¸ªå³å¯ï¼Œè¿™é‡Œæ³¨æ„ç»åº¦å å¶æ•°ä½ï¼Œçº¬åº¦å å¥‡æ•°ä½ï¼Œå¾—åˆ°æœ€ç»ˆçš„äºŒè¿›åˆ¶</p><img src="http://img.zouyh.top/article-img/20240917135017200.png" alt="37c0b60c6dfbaf8bfecd34995f7c47ef" style="zoom:80%;"><p>1110011101001000111100000010110111100011</p><p><strong>ç¬¬ä¸‰æ­¥ï¼šå°†åˆå¹¶åçš„äºŒè¿›åˆ¶åš base32 ç¼–ç </strong></p><p>æœ€åæˆ‘ä»¬å°†åˆå¹¶åçš„äºŒè¿›åˆ¶åš base32 ç¼–ç ï¼Œå°†è¿ç»­ 5 ä½è½¬åŒ–ä¸ºä¸€ä¸ª 0-31 çš„åè¿›åˆ¶æ•°ï¼Œç„¶åç”¨å¯¹åº”çš„å­—ç¬¦ä»£æ›¿ï¼Œå°†æ‰€æœ‰äºŒè¿›åˆ¶ä½å¤„ç†å®Œåæˆ‘ä»¬å°±å®Œæˆäº† base32 ç¼–ç ã€‚ç¼–ç è¡¨å¦‚ä¸‹ï¼š</p><img src="http://img.zouyh.top/article-img/20240917135013189.png" alt="image-20230307113028421" style="zoom:80%;"><p>æœ€ç»ˆå¾—åˆ° geohash å€¼ã€‚</p><h3 id="å…«-hyperloglog" tabindex="-1"><a class="header-anchor" href="#å…«-hyperloglog"><span>å…«ï¼ŒHyperLogLog</span></a></h3><h5 id="_8-1-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#_8-1-ç®€ä»‹"><span>8.1 ç®€ä»‹</span></a></h5><p>â€‹ åœ¨å·¥ä½œå½“ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸ç»Ÿè®¡ç›¸å…³çš„åŠŸèƒ½éœ€æ±‚ï¼Œæ¯”å¦‚ç»Ÿè®¡ç½‘ç«™PVï¼ˆPageViewé¡µé¢è®¿é—®é‡ï¼‰,å¯ä»¥ä½¿ç”¨Redisçš„incrã€incrbyè½»æ¾å®ç°ã€‚ä½†åƒUVï¼ˆUniqueVisitorï¼Œç‹¬ç«‹è®¿å®¢ï¼‰ã€ç‹¬ç«‹IPæ•°ã€æœç´¢è®°å½•æ•°ç­‰éœ€è¦å»é‡å’Œè®¡æ•°çš„é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿè¿™ç§æ±‚é›†åˆä¸­ä¸é‡å¤å…ƒç´ ä¸ªæ•°çš„é—®é¢˜ç§°ä¸ºåŸºæ•°é—®é¢˜ã€‚</p><p>è§£å†³åŸºæ•°é—®é¢˜æœ‰å¾ˆå¤šç§æ–¹æ¡ˆï¼š</p><ul><li>æ•°æ®å­˜å‚¨åœ¨MySQLè¡¨ä¸­ï¼Œä½¿ç”¨distinct countè®¡ç®—ä¸é‡å¤ä¸ªæ•°</li><li>ä½¿ç”¨Redisæä¾›çš„hashã€setã€bitmapsç­‰æ•°æ®ç»“æ„æ¥å¤„ç†</li></ul><p>ä»¥ä¸Šçš„æ–¹æ¡ˆç»“æœç²¾ç¡®ï¼Œä½†éšç€æ•°æ®ä¸æ–­å¢åŠ ï¼Œå¯¼è‡´å ç”¨ç©ºé—´è¶Šæ¥è¶Šå¤§ï¼Œå¯¹äºéå¸¸å¤§çš„æ•°æ®é›†æ˜¯ä¸åˆ‡å®é™…çš„ã€‚</p><p>èƒ½å¦èƒ½å¤Ÿé™ä½ä¸€å®šçš„ç²¾åº¦æ¥å¹³è¡¡å­˜å‚¨ç©ºé—´ï¼ŸRedisæ¨å‡ºäº†HyperLogLog</p><p>â€‹ Redis HyperLogLog æ˜¯ç”¨æ¥åšåŸºæ•°ç»Ÿè®¡çš„ç®—æ³•ï¼ŒHyperLogLog çš„ä¼˜ç‚¹æ˜¯ï¼Œåœ¨è¾“å…¥å…ƒç´ çš„æ•°é‡æˆ–è€…ä½“ç§¯éå¸¸éå¸¸å¤§æ—¶ï¼Œè®¡ç®—åŸºæ•°æ‰€éœ€çš„ç©ºé—´æ€»æ˜¯å›ºå®šçš„ã€å¹¶ä¸”æ˜¯å¾ˆå°çš„ã€‚</p><p>â€‹ åœ¨ Redis é‡Œé¢ï¼Œæ¯ä¸ª HyperLogLog é”®åªéœ€è¦èŠ±è´¹ 12 KB å†…å­˜ï¼Œå°±å¯ä»¥è®¡ç®—æ¥è¿‘ 2^64 ä¸ªä¸åŒå…ƒç´ çš„åŸºæ•°ã€‚è¿™å’Œè®¡ç®—åŸºæ•°æ—¶ï¼Œå…ƒç´ è¶Šå¤šè€—è´¹å†…å­˜å°±è¶Šå¤šçš„é›†åˆå½¢æˆé²œæ˜å¯¹æ¯”ã€‚</p><p>â€‹ ä½†æ˜¯ï¼Œå› ä¸º HyperLogLog åªä¼šæ ¹æ®è¾“å…¥å…ƒç´ æ¥è®¡ç®—åŸºæ•°ï¼Œè€Œä¸ä¼šå‚¨å­˜è¾“å…¥å…ƒç´ æœ¬èº«ï¼Œæ‰€ä»¥ HyperLogLog ä¸èƒ½åƒé›†åˆé‚£æ ·ï¼Œè¿”å›è¾“å…¥çš„å„ä¸ªå…ƒç´ ã€‚</p><p>ä»€ä¹ˆæ˜¯åŸºæ•°?</p><p>æ¯”å¦‚æ•°æ®é›† {1, 3, 5, 7, 5, 7, 8}ï¼Œ é‚£ä¹ˆè¿™ä¸ªæ•°æ®é›†çš„åŸºæ•°é›†ä¸º {1, 3, 5 ,7, 8}, åŸºæ•°(ä¸é‡å¤å…ƒç´ )ä¸º5ã€‚ åŸºæ•°ä¼°è®¡å°±æ˜¯åœ¨è¯¯å·®å¯æ¥å—çš„èŒƒå›´å†…ï¼Œå¿«é€Ÿè®¡ç®—åŸºæ•°ã€‚</p><h5 id="_8-2-å¸¸ç”¨å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#_8-2-å¸¸ç”¨å‘½ä»¤"><span>8.2 å¸¸ç”¨å‘½ä»¤</span></a></h5><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ·»åŠ æŒ‡å®šå…ƒç´ åˆ° HyperLogLogä¸­ï¼Œå°†æ‰€æœ‰å…ƒç´ æ·»åŠ åˆ°æŒ‡å®šHyperLogLogæ•°æ®ç»“æ„ä¸­ã€‚å¦‚æœæ‰§è¡Œå‘½ä»¤åHLLä¼°è®¡çš„è¿‘ä¼¼åŸºæ•°å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è¿”å›1ï¼Œå¦åˆ™è¿”å›0ã€‚</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pfadd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt;&lt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">elemen</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt; [element </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">...]Â Â </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è®¡ç®—HLLçš„è¿‘ä¼¼åŸºæ•°ï¼Œå¯ä»¥è®¡ç®—å¤šä¸ªHLLï¼Œæ¯”å¦‚ç”¨HLLå­˜å‚¨æ¯å¤©çš„UVï¼Œè®¡ç®—ä¸€å‘¨çš„UVå¯ä»¥ä½¿ç”¨7å¤©çš„UVåˆå¹¶è®¡ç®—å³å¯</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pfcount</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ke</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">y&gt; [key </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">...]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å°†ä¸€ä¸ªæˆ–å¤šä¸ªHLLåˆå¹¶åçš„ç»“æœå­˜å‚¨åœ¨å¦ä¸€ä¸ªHLLä¸­ï¼Œæ¯”å¦‚æ¯æœˆæ´»è·ƒç”¨æˆ·å¯ä»¥ä½¿ç”¨æ¯å¤©çš„æ´»è·ƒç”¨æˆ·æ¥åˆå¹¶è®¡ç®—å¯å¾—</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pfmerge</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;destkey&gt;&lt;sourcekey&gt; [sourcekey </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">...]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><!----><!----></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">æœ€è¿‘æ›´æ–°</span><time class="vp-meta-info" datetime="2025-09-06T08:18:22.000Z" data-allow-mismatch>2025/9/6 08:18</time></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 898362059@qq.pcom">zyh1020</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/blog/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96.html" aria-label="RedisæŒä¹…åŒ–"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><iconify-icon class="vp-icon" icon="fa6-solid:file-lines" sizing="height" height="1em"></iconify-icon>RedisæŒä¹…åŒ–</div></a><a class="route-link auto-link next" href="/blog/Redis/Redis%E7%BC%93%E5%AD%98%E8%AE%BE%E8%AE%A1.html" aria-label="Redisç¼“å­˜è®¾è®¡"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">Redisç¼“å­˜è®¾è®¡<iconify-icon class="vp-icon" icon="fa6-solid:file-lines" sizing="height" height="1em"></iconify-icon></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">è±«ICPå¤‡2022026603å·</div><div class="vp-copyright">Copyright Â© 2025 Ms.Zyh </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.5ca44e20.js" defer></script><script src="/assets/js/5967.f6df6183.js" defer></script><script src="/assets/js/app.5f1f45af.js" defer></script>
  </body>
</html>
