<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.24" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.94" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Redisä¸»ä»ï¼Œå“¨å…µå’Œé›†ç¾¤æ¨¡å¼","image":["http://img.zouyh.top/article-img/20240917135019208.png","http://img.zouyh.top/article-img/20240917135018205.png","http://img.zouyh.top/article-img/20240917135019210.png","http://img.zouyh.top/article-img/20240917135018206.png"],"datePublished":"2022-04-24T00:00:00.000Z","dateModified":"2025-09-06T08:18:22.000Z","author":[{"@type":"Person","name":"Ms.Zyh"}]}</script><meta property="og:url" content="http://img.zouyh.top/vuepress/blog/Redis/Redis%E4%B8%BB%E4%BB%8E%EF%BC%8C%E5%93%A8%E5%85%B5%E5%92%8C%E9%9B%86%E7%BE%A4%E6%A8%A1%E5%BC%8F.html"><meta property="og:site_name" content="Mr.Zyh"><meta property="og:title" content="Redisä¸»ä»ï¼Œå“¨å…µå’Œé›†ç¾¤æ¨¡å¼"><meta property="og:description" content="ä¸€ï¼ŒRedisçš„ä¸»ä»å¤åˆ¶ â€‹ ä¸»æœºæ•°æ®æ›´æ–°åæ ¹æ®é…ç½®å’Œç­–ç•¥ï¼Œ è‡ªåŠ¨åŒæ­¥åˆ°å¤‡æœºçš„master/slaveræœºåˆ¶ï¼ŒMasterä»¥å†™ä¸ºä¸»ï¼ŒSlaveä»¥è¯»ä¸ºä¸»ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯è¯»å†™åˆ†ç¦»ï¼Œæ€§èƒ½æ‰©å±•ï¼Œå®¹ç¾å¿«é€Ÿæ¢å¤ã€‚ image-20230303101109512 1.1 ç¯å¢ƒæ­å»º å¦‚æœä½ çš„redisåœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥ä¸çœ‹åŒä¸€å°æœåŠ¡å™¨ä¸Šå¯åŠ¨å¤šä¸ªredisçš„å®ç°æ­¥éª¤..."><meta property="og:type" content="article"><meta property="og:image" content="http://img.zouyh.top/article-img/20240917135019208.png"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-09-06T08:18:22.000Z"><meta property="article:author" content="Ms.Zyh"><meta property="article:tag" content="Redis"><meta property="article:tag" content="æ¨è"><meta property="article:published_time" content="2022-04-24T00:00:00.000Z"><meta property="article:modified_time" content="2025-09-06T08:18:22.000Z"><link rel="icon" href="http://zouyh.top/favicon.png"><title>Redisä¸»ä»ï¼Œå“¨å…µå’Œé›†ç¾¤æ¨¡å¼ | Mr.Zyh</title><meta name="description" content="ä¸€ï¼ŒRedisçš„ä¸»ä»å¤åˆ¶ â€‹ ä¸»æœºæ•°æ®æ›´æ–°åæ ¹æ®é…ç½®å’Œç­–ç•¥ï¼Œ è‡ªåŠ¨åŒæ­¥åˆ°å¤‡æœºçš„master/slaveræœºåˆ¶ï¼ŒMasterä»¥å†™ä¸ºä¸»ï¼ŒSlaveä»¥è¯»ä¸ºä¸»ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯è¯»å†™åˆ†ç¦»ï¼Œæ€§èƒ½æ‰©å±•ï¼Œå®¹ç¾å¿«é€Ÿæ¢å¤ã€‚ image-20230303101109512 1.1 ç¯å¢ƒæ­å»º å¦‚æœä½ çš„redisåœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥ä¸çœ‹åŒä¸€å°æœåŠ¡å™¨ä¸Šå¯åŠ¨å¤šä¸ªredisçš„å®ç°æ­¥éª¤...">
    <link rel="stylesheet" href="/vuepress/assets/css/styles.e906e378.css">
    <link rel="preload" href="/vuepress/assets/js/runtime~app.60ce2f83.js" as="script"><link rel="preload" href="/vuepress/assets/css/styles.e906e378.css" as="style"><link rel="preload" href="/vuepress/assets/js/5967.2f754431.js" as="script"><link rel="preload" href="/vuepress/assets/js/app.d77a90c1.js" as="script">
    <link rel="prefetch" href="/vuepress/assets/js/blog_zookeeper_zookeeperæºç è§£æ.html.64dea8e4.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Spring_springçš„AOPåŸç†è§£æ.html.7dc3542f.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Spring_springçš„IOCåŠ è½½æ•´ä½“æµç¨‹.html.1439cc75.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_è®¾è®¡æ¨¡å¼_ç»“æ„æ¨¡å¼-ä»£ç†æ¨¡å¼.html.714c4bd3.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Mybatis_mybatisæºç è§£æMappé…ç½®æ–‡ä»¶.html.a4ee15ed.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Mybatis_mybatisæºç è§£ææ ¸å¿ƒé…ç½®æ–‡ä»¶.html.ff2dc7c5.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Mybatis_mybatisæºç è§£æsqlæ‰§è¡Œ.html.88009be6.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_MQ_RocketMQæ ¸å¿ƒæ“ä½œ.html.e9fc9d32.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Mybatis_mybatisç¼“å­˜.html.8409acf7.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Spring_springçš„äº‹åŠ¡åŸç†è§£æ.html.104bb9af.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringMvc_springMvcæºç è§£æ.html.1bf0903b.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Redis_rediså®ç°åˆ†å¸ƒå¼é”.html.44def7ae.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_zookeeper_zookeeperå®ç°åˆ†å¸ƒå¼é”.html.dd8904f4.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringBoot_SpringBootçš„runæ–¹æ³•.html.0be9ca4d.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å¤šçº¿ç¨‹_ReentrantLockåŸç†è§£æ.html.ae03795e.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Mybatis_springæ•´åˆmybatisæºç è§£æ.html.aab62ad9.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_zookeeper_æ‰‹å†™zookeeperé…ç½®ä¸­å¿ƒ.html.1f479ece.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Dubbo_dubboä¸­çš„spiæœºåˆ¶.html.6f12e297.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Spring_springçš„å¾ªç¯ä¾èµ–.html.5c63b173.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_MQ_RabbitMQçš„å„ç§é˜Ÿåˆ—.html.d9b7c06f.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringBoot_SpringBootäº‹ä»¶ç›‘å¬.html.770ca541.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringCloud_nacosçš„æœåŠ¡æ²»ç†.html.f847c41e.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Java_QLExpressè¡¨è¾¾å¼.html.40590012.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_MQ_RabbitMQå…­ç§å·¥ä½œæ¨¡å¼.html.e9501b3b.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Mybatis_mybatisæ’ä»¶.html.2523ced9.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringBoot_SpringBootè‡ªåŠ¨è£…é…åŸç†.html.0bc4fdf6.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Java_Lambdaå’ŒStream.html.9eca621f.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å¤šçº¿ç¨‹_ReentrantReadWriteLockåŸç†.html.06be09fe.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å·¥ä½œæµ_flowableè¯·å‡æµç¨‹æ¡ˆä¾‹.html.0950d216.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_MQ_RabbitMQæ¶ˆæ¯çš„å¯é ä¼ é€’.html.6a6e0c35.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringBoot_SpringBootå†…åµŒtomcatåŸç†è§£æ.html.3433ff14.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Dubbo_@DubboReferenceæ³¨è§£.html.337fe802.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å¤šçº¿ç¨‹_CASå’ŒAtomic.html.fdacb10f.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_zookeeper_æ‰‹å†™zookeeperæ³¨å†Œä¸­å¿ƒ.html.a47b4818.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å¤šçº¿ç¨‹_çº¿ç¨‹æ± ThreadPoolExecutor.html.b17da62d.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Jvm_jvmç±»åŠ è½½æœºåˆ¶.html.78cead5e.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringBoot_SpringBootå¤–ç½®tomcatåŸç†è§£æ.html.af4cc56f.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Netty_BIOï¼ŒNIOå’ŒAIOæ¨¡å‹.html.5d418015.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Redis_Redisæ ¸å¿ƒæ•°æ®ç»“æ„.html.f10bac4b.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_MQ_RabbitMQæ•´åˆSpringæˆ–SpringBoot.html.bed3ce00.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringMvc_SpringMvcä½¿ç”¨Validationå‚æ•°æ ¡éªŒ.html.9aecb829.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å¤šçº¿ç¨‹_SemaphoreåŸç†.html.5b60370f.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Mybatis_MybatisåŠ¨æ€æ•°æ®æº.html.fe6cf2ff.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Java_HashMapåŸç†.html.b013b053.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Java_åå°„.html.f750ed74.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringCloud_OpenFeign.html.72690f93.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_è®¾è®¡æ¨¡å¼_åˆ›å»ºæ¨¡å¼-å·¥å‚æ¨¡å¼.html.c886839f.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Java_Stringå­—ç¬¦ä¸²å¸¸é‡æ± .html.9f2fde91.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Redis_Redisç¼“å­˜è®¾è®¡.html.f66e2b31.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Java_javaå¯¹è±¡çš„æ‹·è´.html.881b76a1.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Jvm_jvmå¯¹è±¡çš„ç»“æ„å’Œåˆ›å»º.html.89c78c31.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å¤šçº¿ç¨‹_ConcurrentHashMapåˆ†æ®µé”.html.3402edf3.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_è®¾è®¡æ¨¡å¼_ç»“æ„æ¨¡å¼-é€‚é…å™¨æ¨¡å¼.html.6f31a933.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Java_javaå¼‚å¸¸.html.95cff4c4.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_zookeeper_zookeeperå¸¸ç”¨å‘½ä»¤.html.69be617e.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Spring_Springçš„@Conditionalæ³¨è§£.html.5ddf3c15.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Redis_Redisä¸»ä»ï¼Œå“¨å…µå’Œé›†ç¾¤æ¨¡å¼.html.12bf077e.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringCloud_Sentinelé™æµ.html.b67116c7.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å·¥ä½œæµ_flowable ä¼šç­¾ã€è½¬æ´¾ã€å§”æ´¾ã€åŠ ç­¾.html.1368b145.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/8300.507decb8.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å¤šçº¿ç¨‹_çº¿ç¨‹åŸºç¡€.html.e72d8abc.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Redis_Rediså‘å¸ƒè®¢é˜…ï¼Œé”å’Œäº‹åŠ¡.html.7771dbf8.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringBoot_SpringBootæ³¨å†ŒBeançš„6ç§æ–¹å¼.html.54af3b4d.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å¤šçº¿ç¨‹_volatileçš„åŸç†.html.44bae7e9.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringCloud_@SentinelResourceæ³¨è§£.html.97a54b7d.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_è®¾è®¡æ¨¡å¼_å…³ç³»æ¨¡å¼-è´£ä»»é“¾æ¨¡å¼.html.a40292e1.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_mysql_mysqlçš„é”.html.74cc942b.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_è®¾è®¡æ¨¡å¼_åˆ›å»ºæ¨¡å¼-ç”Ÿæˆå™¨æ¨¡å¼.html.bd835d4a.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_è®¾è®¡æ¨¡å¼_å…³ç³»æ¨¡å¼-ç­–ç•¥æ¨¡å¼.html.2ce1ae6c.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Jvm_jvmè°ƒä¼˜å·¥å…·.html.e0af0511.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_mysql_MySQLçš„sqlæ‰§è¡Œæµç¨‹.html.f062a1c0.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Jvm_jvmåƒåœ¾æ”¶é›†å™¨.html.ec00e757.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_mysql_mysqlçš„ç´¢å¼•.html.0e4935e3.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Java_æµ®ç‚¹ç²¾åº¦ï¼ˆfloatã€doubleï¼‰è¿ç®—ä¸ç²¾ç¡®çš„åŸå› .html.05716b9e.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å¤šçº¿ç¨‹_CountDownLatchå’ŒCyclicBarrier.html.14912d85.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_è®¾è®¡æ¨¡å¼_åˆ›å»ºæ¨¡å¼-å•ä¾‹æ¨¡å¼.html.4b8ceed2.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringCloud_SpringCloudé¡¹ç›®åˆ›å»º.html.a7c45837.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_è®¾è®¡æ¨¡å¼_ç»“æ„æ¨¡å¼-è£…é¥°è€…æ¨¡å¼.html.1551c1bc.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Jvm_JVMçš„åƒåœ¾å›æ”¶æœºåˆ¶.html.95127e39.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Nginx_ä¸€ç¯‡æå®šnignx.html.a8b38cb5.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_MQ_RabbitMQå®‰è£….html.bddcd944.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringCloud_Sentinelç†”æ–­.html.1f04935b.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å¤šçº¿ç¨‹_JMMæ¨¡å‹.html.b2b50b98.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å·¥ä½œæµ_SpringBootæ•´åˆflowable.html.2bcc9441.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_mysql_mysqlçš„äº‹åŠ¡.html.7fc6d6bd.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_MQ_å®‰è£…RocketMQ.html.67c5dd69.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringBoot_SpringBootè‡ªå®šä¹‰starter.html.99e8201a.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_mysql_MySQLçš„MVCC.html.78c5fcf2.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringCloud_nacosçš„å®‰è£….html.f9620cd6.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Redis_RedisæŒä¹…åŒ–.html.7ef7ee8f.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å¤šçº¿ç¨‹_synchronizedåº•å±‚åŸç† .html.6e095d82.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringCloud_nacoså¿«é€Ÿå¼€å§‹.html.e21b959b.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Java_javaè¿ç®—ç¬¦ä¼˜å…ˆçº§.html.ff672314.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Docker_å®‰è£…nginx.html.4dd2d315.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Java_javaè®¿é—®æƒé™ä¿®é¥°ç¬¦.html.1178dac3.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_mysql_äº‘æœåŠ¡å™¨MySQLæ•°æ®è‡ªåŠ¨å¤‡ä»½åˆ°ä¸ƒç‰›äº‘.html.09d0d546.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_zookeeper_å®‰è£…zookeeper.html.b08bbd55.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Docker_linuxå®‰è£…docker.html.c4529fd2.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_mysql_mysqlçš„Buffer Pool.html.9cef4ece.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Nginx_SSLè¯ä¹¦å®‰è£….html.cba72a68.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å·¥å…·_NavicatPremium16çš„å®‰è£…ä¸æ¿€æ´».html.61c0ff89.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Docker_å®‰è£…mysqlå•æœºç‰ˆæœ¬.html.caf49b7a.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringCloud_sentinelå¿«é€Ÿå¼€å§‹.html.587961c1.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å·¥å…·_sshæœåŠ¡ç™»å½•linux.html.c26e083a.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å·¥å…·_Odsidianæ–‡æœ¬ç¼–è¾‘å™¨.html.55cbbcf5.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å·¥å…·_Jmeterçš„å®‰è£…ä½¿ç”¨.html.7ef29473.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Java_æ—¥å¿—æ¶æ„å†å².html.4b13f6b0.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å·¥ä½œæµ_Flowableæµç¨‹å›¾.html.3ef6e359.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å·¥å…·_å›¾åºŠç¥å™¨PicGo_ä¸ƒç‰›äº‘.html.9db74719.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Jvm_JVMè¿è¡Œæ—¶å†…å­˜åˆ’åˆ†.html.8caaf66e.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å·¥å…·_xshell8å®‰è£….html.7580712a.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Java_TCPä¸‰æ¬¡æ¡æ‰‹.html.f3a8893d.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Java_å¸¸è§é—®é¢˜.html.e4be10d9.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å·¥å…·_idea2024.1.7çš„ä¸‹è½½å’Œæ¿€æ´».html.4c49b2a7.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_index.html.5ca8a91b.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/index.html.0df8171a.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/intro.html.331682a3.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_è®¾è®¡æ¨¡å¼_index.html.7475e48e.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_è®¾è®¡æ¨¡å¼_index.html.bd8df728.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_å¤šçº¿ç¨‹_index.html.1dcab7d9.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_å·¥ä½œæµ_index.html.ff9853ce.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_å·¥ä½œæµ_index.html.06249df1.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_å¤šçº¿ç¨‹_index.html.5d75ae46.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_springcloud_index.html.ea7c554c.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_springboot_index.html.fd07892a.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_å·¥å…·_index.html.03d78dc5.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_springcloud_index.html.224c45c4.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_springmvc_index.html.ed7d9ade.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_zookeeper_index.html.c7fa04d7.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_springboot_index.html.c63879f2.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_ååƒ»_index.html.26a3f51a.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_åŸºç¡€_index.html.f28c3eb5.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_å·¥å…·_index.html.c5171f35.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_å¿…çœ‹_index.html.65195973.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_å¸¸ç”¨_index.html.e3c655db.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_å¹²è´§_index.html.54241831.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_æ¨è_index.html.c863d18a.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_è¿›é˜¶_index.html.4f25c8ec.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_springmvc_index.html.7e9a9f72.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_zookeeper_index.html.6fffec96.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_mybatis_index.html.a2c0c728.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_docker_index.html.ea2daa11.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_spring_index.html.020ccba4.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_è®¾è®¡æ¨¡å¼_index.html.dbd347a7.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_mybatis_index.html.0770c906.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_dubbo_index.html.a9e48a1d.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_mysql_index.html.bfcda2d7.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_netty_index.html.042bb132.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_nginx_index.html.57e79921.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_redis_index.html.c090a810.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_docker_index.html.9d12998e.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_spring_index.html.762ef73d.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/404.html.57fac949.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_java_index.html.f7270835.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_dubbo_index.html.61d1f7df.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_mysql_index.html.5bafde00.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_redis_index.html.5f915c28.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_netty_index.html.d0232965.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_nginx_index.html.177fd13a.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_jvm_index.html.9d84b417.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_java_index.html.855e1b27.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_mq_index.html.f17da645.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å¤šçº¿ç¨‹_index.html.78eeb90d.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å·¥ä½œæµ_index.html.00cd55ac.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_jvm_index.html.6354515c.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_mq_index.html.0c9f2ea0.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/timeline_index.html.6a6748f0.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringCloud_index.html.9cd6eede.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringBoot_index.html.72282e6b.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/category_index.html.2e11b212.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_å·¥å…·_index.html.1cac8984.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_SpringMvc_index.html.a492930e.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/article_index.html.d9e68ca1.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_zookeeper_index.html.526715d4.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/tag_index.html.f00b68bc.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/star_index.html.fc974875.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Mybatis_index.html.4a7162db.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Docker_index.html.d97d1b41.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Spring_index.html.e741c490.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Dubbo_index.html.ac7059df.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Netty_index.html.6b332e02.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Nginx_index.html.97e98841.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Redis_index.html.41eed3b0.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_mysql_index.html.4c47783f.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Java_index.html.857a99cb.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_Jvm_index.html.1822c4c2.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/blog_MQ_index.html.2b0b76b6.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar auto-hide" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/vuepress/" aria-label="å¸¦æˆ‘å›å®¶"><!----><!----><span class="vp-site-name">Mr.Zyh</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/vuepress/" aria-label="ä¸»é¡µ"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:house" sizing="height" height="1em"></iconify-icon><!--]-->ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/vuepress/blog/" aria-label="æ–‡ç« "><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:book-open" sizing="height" height="1em"></iconify-icon><!--]-->æ–‡ç« <!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/vuepress/category/" aria-label="åˆ†ç±»"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:bookmark" sizing="height" height="1em"></iconify-icon><!--]-->åˆ†ç±»<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/vuepress/timeline/" aria-label="æ—¶é—´è½´"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:calendar" sizing="height" height="1em"></iconify-icon><!--]-->æ—¶é—´è½´<!----></a></div></nav><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><p class="vp-sidebar-header active"><iconify-icon class="vp-icon" icon="fa6-solid:folder-open" sizing="both" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">æ–‡ç« ç›®å½•</span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Docker</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Dubbo</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Java</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Jvm</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">MQ</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Mybatis</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Mysql</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Netty</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Nginx</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Redis</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/vuepress/blog/Redis/Redis%E4%B8%BB%E4%BB%8E%EF%BC%8C%E5%93%A8%E5%85%B5%E5%92%8C%E9%9B%86%E7%BE%A4%E6%A8%A1%E5%BC%8F.html" aria-label="Redisä¸»ä»ï¼Œå“¨å…µå’Œé›†ç¾¤æ¨¡å¼"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:file-lines" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->Redisä¸»ä»ï¼Œå“¨å…µå’Œé›†ç¾¤æ¨¡å¼<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/vuepress/blog/Redis/Redis%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%EF%BC%8C%E9%94%81%E5%92%8C%E4%BA%8B%E5%8A%A1.html" aria-label="Rediså‘å¸ƒè®¢é˜…ï¼Œé”å’Œäº‹åŠ¡"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:file-lines" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->Rediså‘å¸ƒè®¢é˜…ï¼Œé”å’Œäº‹åŠ¡<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/vuepress/blog/Redis/redis%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81.html" aria-label="rediså®ç°åˆ†å¸ƒå¼é”"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:file-lines" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->rediså®ç°åˆ†å¸ƒå¼é”<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/vuepress/blog/Redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96.html" aria-label="RedisæŒä¹…åŒ–"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:file-lines" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->RedisæŒä¹…åŒ–<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/vuepress/blog/Redis/Redis%E6%A0%B8%E5%BF%83%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.html" aria-label="Redisæ ¸å¿ƒæ•°æ®ç»“æ„"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:file-lines" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->Redisæ ¸å¿ƒæ•°æ®ç»“æ„<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/vuepress/blog/Redis/Redis%E7%BC%93%E5%AD%98%E8%AE%BE%E8%AE%A1.html" aria-label="Redisç¼“å­˜è®¾è®¡"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:file-lines" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->Redisç¼“å­˜è®¾è®¡<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Spring</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Spring Boot</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Spring Cloud</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Spring Mvc</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Zookeeper</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">å¤šçº¿ç¨‹</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">å·¥ä½œæµ</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">å·¥å…·</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">è®¾è®¡æ¨¡å¼</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><iconify-icon class="vp-icon" icon="fa6-solid:file-lines" sizing="height" height="1em"></iconify-icon>Redisä¸»ä»ï¼Œå“¨å…µå’Œé›†ç¾¤æ¨¡å¼</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">Ms.Zyh</span></span><span property="author" content="Ms.Zyh"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2022/4/24</span><meta property="datePublished" content="2022-04-24T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 20 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT20M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color3 clickable" role="navigation">Redis</span><!--]--><meta property="articleSection" content="Redis"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color5 clickable" role="navigation">æ¨è</span><span class="page-tag-item color3 clickable" role="navigation">Redis</span><!--]--><meta property="keywords" content="æ¨è,Redis"></span></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><h3 id="ä¸€-redisçš„ä¸»ä»å¤åˆ¶" tabindex="-1"><a class="header-anchor" href="#ä¸€-redisçš„ä¸»ä»å¤åˆ¶"><span>ä¸€ï¼ŒRedisçš„ä¸»ä»å¤åˆ¶</span></a></h3><p>â€‹ ä¸»æœºæ•°æ®æ›´æ–°åæ ¹æ®é…ç½®å’Œç­–ç•¥ï¼Œ è‡ªåŠ¨åŒæ­¥åˆ°å¤‡æœºçš„master/slaveræœºåˆ¶ï¼ŒMasterä»¥å†™ä¸ºä¸»ï¼ŒSlaveä»¥è¯»ä¸ºä¸»ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯è¯»å†™åˆ†ç¦»ï¼Œæ€§èƒ½æ‰©å±•ï¼Œå®¹ç¾å¿«é€Ÿæ¢å¤ã€‚</p><img src="http://img.zouyh.top/article-img/20240917135019207.png" alt="image-20230303101109512" style="zoom:80%;"><h4 id="_1-1-ç¯å¢ƒæ­å»º" tabindex="-1"><a class="header-anchor" href="#_1-1-ç¯å¢ƒæ­å»º"><span>1.1 ç¯å¢ƒæ­å»º</span></a></h4><p>å¦‚æœä½ çš„redisåœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥ä¸çœ‹åŒä¸€å°æœåŠ¡å™¨ä¸Šå¯åŠ¨å¤šä¸ªredisçš„å®ç°æ­¥éª¤ï¼š</p><p>å°†redisçš„é…ç½®æ–‡ä»¶redis.confåˆ°/myredisæ–‡ä»¶å¤¹ä¸­ï¼š</p><div class="language-cmd line-numbers-mode" data-highlighter="shiki" data-ext="cmd" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cmd"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">cp redis.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">conf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">myredis</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/redis.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç¼–è¾‘æ‹·è´åçš„redis.confæ–‡ä»¶ï¼ŒæŸ¥æ‰¾<code>bing 127.0.0.1</code>é…ç½®æœ‰æ²¡æœ‰æ³¨é‡Šæ‰ï¼Œæ²¡æœ‰çš„è¯ï¼Œè‡ªå·±æ³¨é‡Šäº†</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>vi /myredis/redis.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>åœ¨/myredisæ–‡ä»¶å¤¹ä¸­ï¼Œæ–°å»ºredis6379.confï¼Œå¡«å†™ä»¥ä¸‹å†…å®¹ï¼š</p><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-properties"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">include /myredis/redis.conf</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">pidfile /var/run/redis_6379.pid</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">daemonize yes</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">port 6379</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">logfile </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;6379.log&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">dir ./6379</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è§£é‡Šï¼š</p><ul><li><code>daemonize yes</code>ï¼šdaemonizeå®ˆæŠ¤çº¿ç¨‹ï¼Œé»˜è®¤æ˜¯NOã€daemonizeæ˜¯ç”¨æ¥æŒ‡å®šredisæ˜¯å¦è¦ç”¨å®ˆæŠ¤çº¿ç¨‹çš„æ–¹å¼å¯åŠ¨ï¼Œ</li><li><code>include</code>ï¼šè¡¨ç¤ºå¼•å…¥redis.confçš„é…ç½®ã€‚</li><li><code>pidfile</code> ï¼šä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶å¯åŠ¨åï¼Œredisçš„çº¿ç¨‹idã€‚</li><li><code>port</code>ï¼š ä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶å¯åŠ¨åï¼Œredisçš„ç«¯å£ã€‚</li><li><code>logfile</code>ï¼šä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶å¯åŠ¨åï¼Œæ—¥å¿—ç”Ÿæˆæ–‡ä»¶åç§°ã€‚</li><li><code>dir</code>ï¼šä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶å¯åŠ¨åï¼ŒRDBå’ŒAOFæ•°æ®æŒä¹…åŒ–ç”Ÿæˆçš„æ–‡ä»¶è·¯å¾„ã€‚</li></ul><p>åŒæ ·çš„æ–¹å¼åœ¨/myredisæ–‡ä»¶å¤¹ä¸­ï¼Œæ–°å»ºredis6380.confï¼Œå¡«å†™ä»¥ä¸‹å†…å®¹ï¼š</p><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-properties"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">include /myredis/redis.conf</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">pidfile /var/run/redis_6380.pid</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">daemonize yes</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">port 6380</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">logfile </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;6379.log&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">dir ./6379</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨/myredisæ–‡ä»¶å¤¹ä¸­ï¼Œæ–°å»ºredis6381.confï¼Œå¡«å†™ä»¥ä¸‹å†…å®¹ï¼š</p><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-properties"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">include /myredis/redis.conf</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">pidfile /var/run/redis_6381.pid</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">daemonize yes</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">port 6381</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">logfile </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;6381.log&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">dir ./6381</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯åŠ¨ä¸‰å°redisæœåŠ¡å™¨åœ¨/myredisæ–‡ä»¶å¤¹ä¸­ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">redis-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> redis6379.conf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">redis-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> redis6380.conf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">redis-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> redis6381.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥çœ‹ç³»ç»Ÿè¿›ç¨‹ï¼Œçœ‹çœ‹ä¸‰å°æœåŠ¡å™¨æ˜¯å¦å¯åŠ¨ï¼š</p><div class="language-cmd line-numbers-mode" data-highlighter="shiki" data-ext="cmd" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cmd"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ps</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ef</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | grep redis</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>åˆ°è¿™å°±é€šè¿‡ç”Ÿæˆä¸‰ä¸ªä¸åŒçš„redis.confæ–‡ä»¶å¯åŠ¨äº†ï¼Œä¸‰å°ä¸åŒçš„redisã€‚</p><p><strong>é…ç½®ä¸»ä»å…³ç³»</strong></p><p>åœ¨é…ç½®ä¸»ä»å…³ç³»ä¹‹å‰ï¼Œå…ˆæŸ¥çœ‹ä¸‰å°ä¸»æœºè¿è¡Œæƒ…å†µï¼Œé€šè¿‡å¦‚ä¸‹å‘½ä»¤è¿æ¥ä¸‰å°ä¸»æœºï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>redis-cli -p ç«¯å£</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿æ¥æˆåŠŸåï¼Œé€šè¿‡å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹å½“å‰redisçš„ä¸»ä»å¤åˆ¶çš„ç›¸å…³ä¿¡æ¯ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>info replication</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="http://img.zouyh.top/article-img/20240917135019208.png" alt="image-20230303104649136" tabindex="0" loading="lazy"><figcaption>image-20230303104649136</figcaption></figure><p>å¯ä»¥çœ‹å‡ºåœ¨æ²¡æœ‰é…ç½®ï¼Œä¸»ä»å…³ç³»å‰ï¼Œä¸Šå›¾ä¸­<code>role:master</code>éƒ½æ˜¯ä¸»åº“.</p><p>é…ç½®ä¸»ä»å…³ç³»ï¼Œåªéœ€è¦é…ç½®ä»åº“ä¸éœ€è¦ä¸»åº“ï¼Œä¹Ÿå°±æ˜¯è¯´ä»åº“åªéœ€è¦è®¤ä¸»å³å¯ï¼Œè®¤ä¸»çš„å‘½ä»¤æ˜¯ï¼š</p><div class="language-cmd line-numbers-mode" data-highlighter="shiki" data-ext="cmd" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cmd"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-- </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5.</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">0ä¹‹å‰å‘½ä»¤</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">slaveof</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Â &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ip</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-- </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5.</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">0ä¹‹åå‘½ä»¤</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">replicaof</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ip</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡å‘½ä»¤çš„æ–¹å¼ï¼Œåªæ˜¯åœ¨å½“å‰é“¾æ¥æœ‰æ•ˆï¼Œé‡å¯redisåå°±ä¸è¡Œäº†ï¼Œå¦‚æœæƒ³è¦ä¸€ç›´ç”Ÿæ•ˆï¼Œå¯ä»¥åœ¨å¯¹åº”çš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-properties"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 5.0ä¹‹å‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">slaveofÂ &lt;ip&gt; &lt;port&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 5.0ä¹‹å</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">replicaof &lt;ip&gt; &lt;port&gt; </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">replica-read-only yes</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‡è®¾åœ¨6380å’Œ6381ä¸Šæ‰§è¡Œå‘½ä»¤æˆ–è€…åœ¨redis6380.confå’Œredis6381.confæ–‡ä»¶ä¸­æ·»åŠ äº†å†…å®¹åï¼š</p><figure><img src="http://img.zouyh.top/article-img/20240917135018205.png" alt="image-20230303105610726" tabindex="0" loading="lazy"><figcaption>image-20230303105610726</figcaption></figure><p>ä»ä¸Šæˆªå›¾å¯ä»¥çœ‹åˆ°6380å’Œ6381çš„è§’è‰²å˜æˆäº†slaveã€‚</p><h4 id="_1-2-åŸç†è§£æ" tabindex="-1"><a class="header-anchor" href="#_1-2-åŸç†è§£æ"><span>1.2 åŸç†è§£æ</span></a></h4><p>â€‹ å¦‚æœä½ ä¸ºmasteré…ç½®äº†ä¸€ä¸ªslaveï¼Œä¸ç®¡è¿™ä¸ªslaveæ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡è¿æ¥ä¸ŠMasterï¼Œå®ƒéƒ½ä¼šå‘é€ä¸€ä¸ªPSYNCå‘½ä»¤ç»™masterè¯·æ±‚å¤åˆ¶æ•°æ®ã€‚masteræ”¶åˆ°PSYNCå‘½ä»¤åï¼Œä¼šåœ¨åå°è¿›è¡Œæ•°æ®æŒä¹…åŒ–é€šè¿‡bgsaveç”Ÿæˆæœ€æ–°çš„rdbå¿«ç…§æ–‡ä»¶ï¼ŒæŒä¹…åŒ–æœŸé—´ï¼Œmasterä¼šç»§ç»­æ¥æ”¶å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå®ƒä¼šæŠŠè¿™äº›å¯èƒ½ä¿®æ”¹æ•°æ®é›†çš„è¯·æ±‚ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚å½“æŒä¹…åŒ–è¿›è¡Œå®Œæ¯•ä»¥åï¼Œmasterä¼šæŠŠè¿™ä»½rdbæ–‡ä»¶æ•°æ®é›†å‘é€ç»™slaveï¼Œslaveä¼šæŠŠæ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡ŒæŒä¹…åŒ–ç”Ÿæˆrdbï¼Œç„¶åå†åŠ è½½åˆ°å†…å­˜ä¸­ã€‚ç„¶åï¼Œmasterå†å°†ä¹‹å‰ç¼“å­˜åœ¨å†…å­˜ä¸­çš„å‘½ä»¤å‘é€ç»™slaveã€‚</p><p>â€‹ å½“masterä¸slaveä¹‹é—´çš„è¿æ¥ç”±äºæŸäº›åŸå› è€Œæ–­å¼€æ—¶ï¼Œslaveèƒ½å¤Ÿè‡ªåŠ¨é‡è¿Masterï¼Œå¦‚æœmasteræ”¶åˆ°äº†å¤šä¸ªslaveå¹¶å‘è¿æ¥è¯·æ±‚ï¼Œå®ƒåªä¼šè¿›è¡Œä¸€æ¬¡æŒä¹…åŒ–ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªè¿æ¥ä¸€æ¬¡ï¼Œç„¶åå†æŠŠè¿™ä¸€ä»½æŒä¹…åŒ–çš„æ•°æ®å‘é€ç»™å¤šä¸ªå¹¶å‘è¿æ¥çš„slaveã€‚</p><p>å…¨é‡å¤åˆ¶ï¼š</p><img src="http://img.zouyh.top/article-img/20240917135018204.png" alt="image-20230303105900585" style="zoom:67%;"><p>â€‹ å½“masterå’Œslaveæ–­å¼€é‡è¿åï¼Œä¸€èˆ¬éƒ½ä¼šå¯¹æ•´ä»½æ•°æ®è¿›è¡Œå¤åˆ¶ã€‚ä½†ä»redis2.8ç‰ˆæœ¬å¼€å§‹ï¼Œredisæ”¹ç”¨å¯ä»¥æ”¯æŒéƒ¨åˆ†æ•°æ®å¤åˆ¶çš„å‘½ä»¤PSYNCå»masteråŒæ­¥æ•°æ®ï¼Œslaveä¸masterèƒ½å¤Ÿåœ¨ç½‘ç»œè¿æ¥æ–­å¼€é‡è¿ååªè¿›è¡Œéƒ¨åˆ†æ•°æ®å¤åˆ¶(æ–­ç‚¹ç»­ä¼ )ã€‚</p><p>â€‹ masterä¼šåœ¨å…¶å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªå¤åˆ¶æ•°æ®ç”¨çš„ç¼“å­˜é˜Ÿåˆ—ï¼Œç¼“å­˜æœ€è¿‘ä¸€æ®µæ—¶é—´çš„æ•°æ®ï¼Œmasterå’Œå®ƒæ‰€æœ‰çš„slaveéƒ½ç»´æŠ¤äº†å¤åˆ¶çš„æ•°æ®ä¸‹æ ‡offsetå’Œmasterçš„è¿›ç¨‹idï¼Œå› æ­¤ï¼Œå½“ç½‘ç»œè¿æ¥æ–­å¼€åï¼Œslaveä¼šè¯·æ±‚masterç»§ç»­è¿›è¡Œæœªå®Œæˆçš„å¤åˆ¶ï¼Œä»æ‰€è®°å½•çš„æ•°æ®ä¸‹æ ‡å¼€å§‹ã€‚å¦‚æœmasterè¿›ç¨‹idå˜åŒ–äº†ï¼Œæˆ–è€…ä»èŠ‚ç‚¹æ•°æ®ä¸‹æ ‡offsetå¤ªæ—§ï¼Œå·²ç»ä¸åœ¨masterçš„ç¼“å­˜é˜Ÿåˆ—é‡Œäº†ï¼Œé‚£ä¹ˆå°†ä¼šè¿›è¡Œä¸€æ¬¡å…¨é‡æ•°æ®çš„å¤åˆ¶ã€‚</p><p>éƒ¨åˆ†å¤åˆ¶ï¼Œæ–­ç‚¹ç»­ä¼ æµç¨‹å›¾ï¼š</p><img src="http://img.zouyh.top/article-img/20240917135020211.png" alt="image-20230303110008991" style="zoom:67%;"><p>â€‹ å¦‚æœæœ‰å¾ˆå¤šä»èŠ‚ç‚¹ï¼Œä¸ºäº†ç¼“è§£ä¸»ä»å¤åˆ¶é£æš´(å¤šä¸ªä»èŠ‚ç‚¹åŒæ—¶å¤åˆ¶ä¸»èŠ‚ç‚¹å¯¼è‡´ä¸»èŠ‚ç‚¹å‹åŠ›è¿‡å¤§)ï¼Œå¯ä»¥åšå¦‚ä¸‹æ¶æ„ï¼Œä¸Šä¸€ä¸ªSlaveå¯ä»¥æ˜¯ä¸‹ä¸€ä¸ªslaveçš„Masterï¼ŒSlaveåŒæ ·å¯ä»¥æ¥æ”¶å…¶ä»– slavesçš„è¿æ¥å’ŒåŒæ­¥è¯·æ±‚ï¼Œé‚£ä¹ˆè¯¥slaveä½œä¸ºäº†é“¾æ¡ä¸­ä¸‹ä¸€ä¸ªçš„master, å¯ä»¥æœ‰æ•ˆå‡è½»masterçš„å†™å‹åŠ›,å»ä¸­å¿ƒåŒ–é™ä½é£</p><img src="http://img.zouyh.top/article-img/20240917135019209.png" alt="image-20230303110309672" style="zoom:67%;"><h3 id="äºŒ-redisçš„å“¨å…µæ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#äºŒ-redisçš„å“¨å…µæ¨¡å¼"><span>äºŒï¼ŒRedisçš„å“¨å…µæ¨¡å¼</span></a></h3><p>â€‹ ä¸»ä»å¤åˆ¶çš„å¥½å¤„æ˜¯è¯»å†™åˆ†ç¦»ï¼Œæ€§èƒ½æ‰©å±•ï¼Œå®¹ç¾å¿«é€Ÿæ¢å¤ï¼Œä½†æ˜¯åªæœ‰ä¸€ä¸ªMasterï¼Œä¹Ÿåªæœ‰å®ƒèƒ½å¤Ÿå†™æ•°æ®ï¼Œå½“è¿™ä¸ªMasterä¸èƒ½å·¥ä½œæ—¶ï¼Œä¸»ä»å¤åˆ¶çš„é›†ç¾¤å°±ä¸èƒ½å·¥ä½œäº†ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œrediså¼•å…¥äº†å“¨å…µæ¨¡å¼ã€‚</p><figure><img src="http://img.zouyh.top/article-img/20240917135019210.png" alt="image-20230303115108125" tabindex="0" loading="lazy"><figcaption>image-20230303115108125</figcaption></figure><p>â€‹ sentinelå“¨å…µæ˜¯ç‰¹æ®Šçš„redisæœåŠ¡ï¼Œä¸æä¾›è¯»å†™æœåŠ¡ï¼Œä¸»è¦ç”¨æ¥ç›‘æ§rediså®ä¾‹èŠ‚ç‚¹ã€‚å“¨å…µæ¶æ„ä¸‹clientç«¯ç¬¬ä¸€æ¬¡ä»å“¨å…µæ‰¾å‡ºredisçš„ä¸»èŠ‚ç‚¹ï¼Œåç»­å°±ç›´æ¥è®¿é—®redisçš„ä¸»èŠ‚ç‚¹ï¼Œä¸ä¼šæ¯æ¬¡éƒ½é€šè¿‡sentinelä»£ç†è®¿é—®redisçš„ä¸»èŠ‚ç‚¹ï¼Œå½“redisçš„ä¸»èŠ‚ç‚¹å‘ç”Ÿå˜åŒ–ï¼Œå“¨å…µä¼šç¬¬ä¸€æ—¶é—´æ„ŸçŸ¥åˆ°ï¼Œå¹¶ä¸”å°†æ–°çš„redisä¸»èŠ‚ç‚¹é€šçŸ¥ç»™clientç«¯(è¿™é‡Œé¢redisçš„clientç«¯ä¸€èˆ¬éƒ½å®ç°äº†è®¢é˜…åŠŸèƒ½ï¼Œè®¢é˜…sentinelå‘å¸ƒçš„èŠ‚ç‚¹å˜åŠ¨æ¶ˆæ¯)</p><h4 id="_2-1-ç¯å¢ƒæ­å»º" tabindex="-1"><a class="header-anchor" href="#_2-1-ç¯å¢ƒæ­å»º"><span>2.1 ç¯å¢ƒæ­å»º</span></a></h4><p>åœ¨/myredisç›®å½•ä¸‹æ–°å»ºå¤šä¸ªsentinel.confæ–‡ä»¶ï¼š</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /myredis/sentinel-26379.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-properties"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">port 26379</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">daemonize yes</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">pidfile </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/var/run/redis-sentinel-26379.pid&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">logfile </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;26379.log&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">dir </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;./26379&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">sentinel monitor mymaster 166.66.66.66 6379 2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>daemonize yes</code>ï¼šdaemonizeå®ˆæŠ¤çº¿ç¨‹ï¼Œé»˜è®¤æ˜¯NOã€daemonizeæ˜¯ç”¨æ¥æŒ‡å®šredisæ˜¯å¦è¦ç”¨å®ˆæŠ¤çº¿ç¨‹çš„æ–¹å¼å¯åŠ¨ï¼Œå¯ä»¥æŸ¥çœ‹redis.confæ˜¯å¦‚ä½•é…ç½®çš„å¦‚æœæ˜¯NOï¼Œæ”¹ä¸ºyesã€‚</li><li><code>pidfile</code> ï¼šä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶å¯åŠ¨åï¼Œredisçš„çº¿ç¨‹idã€‚</li><li><code>port</code>ï¼š ä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶å¯åŠ¨åï¼Œredisçš„ç«¯å£ã€‚</li><li><code>logfile</code>ï¼šä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶å¯åŠ¨åï¼Œæ—¥å¿—ç”Ÿæˆæ–‡ä»¶åç§°ã€‚</li><li><code>dir</code>ï¼šä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶å¯åŠ¨åï¼ŒRDBå’ŒAOFæ•°æ®æŒä¹…åŒ–ç”Ÿæˆçš„æ–‡ä»¶è·¯å¾„ã€‚</li><li><code>sentinel monitor</code>ï¼šè¡¨ç¤ºå½“å‰redisæ˜¯å“¨å…µã€mymasteræ˜¯éšä¾¿èµ·çš„åå­—ï¼Œ<code>136.66.66.66</code>æ˜¯ç›‘è§†çš„Masterçš„ipï¼Œ6379æ˜¯ç›‘è§†çš„Masterçš„portï¼Œ2ä»£è¡¨2ä½å“¨å…µåŒæ„æ‰å¯ä»¥ã€‚</li></ul><p>å¯åŠ¨sentinelå“¨å…µå®ä¾‹</p><div class="language-cmd line-numbers-mode" data-highlighter="shiki" data-ext="cmd" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cmd"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">src</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">redis</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">sentinel</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> sentinel</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">-26379.</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>åŒæ ·çš„æµç¨‹ï¼Œå¯ä»¥è‡ªå·±å†é…ç½®ä¸¤ä¸ªsentinelï¼Œç«¯å£26380å’Œ26381ï¼Œåªéœ€è¦å°†ä¸Šè¿°é…ç½®æ–‡ä»¶åå’Œæ–‡ä»¶å†…å®¹é‡Œçš„å¯¹åº”æ•°å­—éƒ½ä¿®æ”¹å³å¯ã€‚</p><p>åŒæ ·å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹sentinelçš„infoä¿¡æ¯</p><div class="language-cmd line-numbers-mode" data-highlighter="shiki" data-ext="cmd" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cmd"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> src</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">redis</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cli</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">p</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 26379</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">127.0.0.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">26379</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">info</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> replication</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ sentinelé›†ç¾¤éƒ½å¯åŠ¨å®Œæ¯•åï¼Œä¼šå°†å“¨å…µé›†ç¾¤çš„å…ƒæ•°æ®ä¿¡æ¯å†™å…¥æ‰€æœ‰sentinelçš„é…ç½®æ–‡ä»¶é‡Œå»(è¿½åŠ åœ¨æ–‡ä»¶çš„æœ€ä¸‹é¢) æˆ‘ä»¬æŸ¥çœ‹ä¸‹å¦‚ä¸‹é…ç½®æ–‡ä»¶sentinel-26379.confï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-properties"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">sentinel known-replica mymaster 166.66.66.66 6380 </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#ä»£è¡¨ä¸»èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">sentinel known-replica mymaster 166.66.66.66 6381 </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#ä»£è¡¨ä¸»èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">sentinel known-sentinel mymaster 166.66.66.66 26380 52d0a5d70c1f9043c56935760f  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#ä»£è¡¨æ„ŸçŸ¥åˆ°çš„å…¶å®ƒå“¨å…µèŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">sentinel known-sentinel mymaster 166.66.66.66 26381 e9f53ebb8e1686438ba8bd5ca6  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#ä»£è¡¨æ„ŸçŸ¥åˆ°çš„å…¶å®ƒå“¨å…µèŠ‚ç‚¹</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹ å½“redisä¸»èŠ‚ç‚¹å¦‚æœæŒ‚äº†ï¼Œå“¨å…µé›†ç¾¤ä¼šé‡æ–°é€‰ä¸¾å‡ºæ–°çš„redisä¸»èŠ‚ç‚¹ï¼ŒåŒæ—¶ä¼šä¿®æ”¹æ‰€æœ‰sentinelèŠ‚ç‚¹é…ç½®æ–‡ä»¶çš„é›†ç¾¤å…ƒæ•°æ®ä¿¡æ¯ï¼Œæ¯”å¦‚6379çš„rediså¦‚æœæŒ‚äº†ï¼Œå‡è®¾é€‰ä¸¾å‡ºçš„æ–°ä¸»èŠ‚ç‚¹æ˜¯6380ï¼Œåˆ™sentinelæ–‡ä»¶é‡Œçš„é›†ç¾¤å…ƒæ•°æ®ä¿¡æ¯ä¼šå˜æˆå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-properties"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">sentinel known-replica mymaster 166.66.66.66 6381 </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#ä»£è¡¨ä¸»èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">sentinel known-sentinel mymaster 166.66.66.66 26380 52d0a5d70c1f9043c56935760f  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#ä»£è¡¨æ„ŸçŸ¥åˆ°çš„å…¶å®ƒå“¨å…µèŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">sentinel known-sentinel mymaster 166.66.66.66 26381 e9f53ebb8e1686438ba8bd5ca6  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#ä»£è¡¨æ„ŸçŸ¥åˆ°çš„å…¶å®ƒå“¨å…µèŠ‚ç‚¹</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŒæ—¶è¿˜ä¼šä¿®æ”¹sentinelæ–‡ä»¶é‡Œä¹‹å‰é…ç½®çš„mymasterå¯¹åº”çš„6379ç«¯å£ï¼Œæ”¹ä¸º6380</p><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-properties"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">sentinel monitor mymaster 166.66.66.66 6380 2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>â€‹ åŸä¸»æœºé‡å¯åä¼šå˜ä¸ºä»æœºï¼Œå½“6379çš„rediså®ä¾‹å†æ¬¡å¯åŠ¨æ—¶ï¼Œå“¨å…µé›†ç¾¤æ ¹æ®é›†ç¾¤å…ƒæ•°æ®ä¿¡æ¯å°±å¯ä»¥å°†6379ç«¯å£çš„redisèŠ‚ç‚¹ä½œä¸ºä»èŠ‚ç‚¹åŠ å…¥é›†ç¾¤ï¼Œåˆ™sentinelæ–‡ä»¶é‡Œçš„é›†ç¾¤å…ƒæ•°æ®ä¿¡æ¯ä¼šå˜æˆå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-properties"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">sentinel known-replica mymaster 166.66.66.66 6379 </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#ä»£è¡¨ä¸»èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">sentinel known-replica mymaster 166.66.66.66 6381 </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#ä»£è¡¨ä¸»èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">sentinel known-sentinel mymaster 166.66.66.66 26380 52d0a5d70c1f9043c56935760f  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#ä»£è¡¨æ„ŸçŸ¥åˆ°çš„å…¶å®ƒå“¨å…µèŠ‚ç‚¹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">sentinel known-sentinel mymaster 166.66.66.66 26381 e9f53ebb8e1686438ba8bd5ca6  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#ä»£è¡¨æ„ŸçŸ¥åˆ°çš„å…¶å®ƒå“¨å…µèŠ‚ç‚¹</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-3-åŸç†è§£æ" tabindex="-1"><a class="header-anchor" href="#_2-3-åŸç†è§£æ"><span>2.3 åŸç†è§£æ</span></a></h4><p>â€‹ å“¨å…µçš„leaderé€‰ä¸¾æµç¨‹ï¼šå½“ä¸€ä¸ªmasteræœåŠ¡å™¨è¢«æŸå“¨å…µè§†ä¸ºä¸‹çº¿çŠ¶æ€åï¼Œè¯¥å“¨å…µä¼šä¸å…¶ä»–å“¨å…µåå•†é€‰å‡ºå“¨å…µçš„leaderè¿›è¡Œæ•…éšœè½¬ç§»å·¥ä½œã€‚æ¯ä¸ªå‘ç°masteræœåŠ¡å™¨è¿›å…¥ä¸‹çº¿çš„å“¨å…µéƒ½å¯ä»¥è¦æ±‚å…¶ä»–å“¨å…µé€‰è‡ªå·±æˆä¸ºå“¨å…µçš„leaderï¼Œé€‰ä¸¾æ˜¯å…ˆåˆ°å…ˆå¾—ã€‚åŒæ—¶æ¯ä¸ªå“¨å…µæ¯æ¬¡é€‰ä¸¾éƒ½ä¼šè‡ªå¢é…ç½®çºªå…ƒ(é€‰ä¸¾å‘¨æœŸ)ï¼Œæ¯ä¸ªçºªå…ƒä¸­åªä¼šé€‰æ‹©ä¸€ä¸ªå“¨å…µ(åŒ…å«è‡ªå·±)æˆä¸ºleaderã€‚å¦‚æœæ‰€æœ‰è¶…è¿‡ä¸€åŠçš„å“¨å…µé€‰ä¸¾æŸå“¨å…µä½œä¸ºleaderï¼Œé‚£ä¹ˆä¹‹åè¯¥å“¨å…µè´Ÿè´£è¿›è¡Œæ•…éšœè½¬ç§»æ“ä½œï¼Œä»å­˜æ´»çš„slaveä¸­é€‰ä¸¾å‡ºæ–°çš„masterï¼Œè¿™ä¸ªé€‰ä¸¾è¿‡ç¨‹è·Ÿé›†ç¾¤çš„masteré€‰ä¸¾å¾ˆç±»ä¼¼ã€‚ å“¨å…µé›†ç¾¤åªæœ‰ä¸€ä¸ªå“¨å…µèŠ‚ç‚¹ï¼Œredisçš„ä¸»ä»ä¹Ÿèƒ½æ­£å¸¸è¿è¡Œä»¥åŠé€‰ä¸¾masterï¼Œå¦‚æœmasteræŒ‚äº†ï¼Œé‚£å”¯ä¸€çš„é‚£ä¸ªå“¨å…µèŠ‚ç‚¹å°±æ˜¯å“¨å…µleaderäº†ï¼Œå¯ä»¥æ­£å¸¸é€‰ä¸¾æ–°masterã€‚ ä¸è¿‡ä¸ºäº†é«˜å¯ç”¨ä¸€èˆ¬éƒ½æ¨èè‡³å°‘éƒ¨ç½²ä¸‰ä¸ªå“¨å…µèŠ‚ç‚¹ã€‚</p><p>â€‹ è‡³äºä¸ºä»€ä¹ˆè¦éƒ¨ç½²ä¸‰ä¸ªå“¨å…µèŠ‚ç‚¹ï¼šä¸»è¦æ˜¯ä¸ºäº†æ»¡è¶³è¶…è¿‡åŠæ•°çš„åŸåˆ™åˆèƒ½èŠ‚çº¦èµ„æºï¼Œå‡è®¾æœ‰2ä¸ªå“¨å…µèŠ‚ç‚¹ï¼Œå½“æœ‰ä¸€ä¸ªèŠ‚ç‚¹æŒ‚äº†æ—¶å€™ï¼Œå°±ç®—å¦ä¸€ä¸ªèŠ‚ç‚¹å‚åŠ é€‰ä¸¾ï¼Œé€‰äº†è‡ªå·±ï¼Œä¹Ÿæ²¡æœ‰è¶…è¿‡1ä¸å¯èƒ½æˆä¸ºå“¨å…µleaderã€‚å‡è®¾æœ‰4ä¸ªå“¨å…µèŠ‚ç‚¹ï¼Œå½“æœ‰ä¸€ä¸ªèŠ‚ç‚¹æŒ‚äº†æ—¶å€™ï¼Œè¿˜æœ‰ä¸‰ä¸ªå“¨å…µèŠ‚ç‚¹ï¼Œéƒ½é€‰æ‹©æŸä¸€ä¸ªå“¨å…µæœ‰æœºä¼šè¶…è¿‡åŠæ•°çš„2çš„ï¼Œå¯ä»¥æˆä¸ºå“¨å…µleaderï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™ç”¨äº†4ä¸ªå“¨å…µèŠ‚ç‚¹æœ‰ç‚¹æµªè´¹èµ„æºã€‚</p><h3 id="ä¸‰-é›†ç¾¤æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#ä¸‰-é›†ç¾¤æ¨¡å¼"><span>ä¸‰ï¼Œé›†ç¾¤æ¨¡å¼</span></a></h3><p>â€‹ åœ¨redis3.0ä»¥å‰çš„ç‰ˆæœ¬è¦å®ç°é›†ç¾¤ä¸€èˆ¬æ˜¯å€ŸåŠ©å“¨å…µsentinelå·¥å…·æ¥ç›‘æ§masterèŠ‚ç‚¹çš„çŠ¶æ€ï¼Œå¦‚æœmasterèŠ‚ç‚¹å¼‚ å¸¸ï¼Œåˆ™ä¼šåšä¸»ä»åˆ‡æ¢ï¼Œå°†æŸä¸€å°slaveä½œä¸ºmasterï¼Œå“¨å…µçš„é…ç½®ç•¥å¾®å¤æ‚ï¼Œå¹¶ä¸”æ€§èƒ½å’Œé«˜å¯ç”¨æ€§ç­‰å„æ–¹é¢è¡¨ç° ä¸€èˆ¬ï¼Œç‰¹åˆ«æ˜¯åœ¨ä¸»ä»åˆ‡æ¢çš„ç¬é—´å­˜åœ¨è®¿é—®ç¬æ–­çš„æƒ…å†µï¼Œè€Œä¸”å“¨å…µæ¨¡å¼åªæœ‰ä¸€ä¸ªä¸»èŠ‚ç‚¹å¯¹å¤–æä¾›æœåŠ¡ï¼Œæ²¡æ³•æ”¯æŒ å¾ˆé«˜çš„å¹¶å‘ï¼Œä¸”å•ä¸ªä¸»èŠ‚ç‚¹å†…å­˜ä¹Ÿä¸å®œè®¾ç½®å¾—è¿‡å¤§ï¼Œå¦åˆ™ä¼šå¯¼è‡´æŒä¹…åŒ–æ–‡ä»¶è¿‡å¤§ï¼Œå½±å“æ•°æ®æ¢å¤æˆ–ä¸»ä»åŒæ­¥çš„æ•ˆç‡ã€‚</p><figure><img src="http://img.zouyh.top/article-img/20240917135018206.png" alt="image-20230303152809120" tabindex="0" loading="lazy"><figcaption>image-20230303152809120</figcaption></figure><p>redisé›†ç¾¤æ˜¯ä¸€ä¸ªç”±å¤šä¸ªä¸»ä»èŠ‚ç‚¹ç¾¤ç»„æˆçš„åˆ†å¸ƒå¼æœåŠ¡å™¨ç¾¤ï¼Œå®ƒå…·æœ‰å¤åˆ¶ã€é«˜å¯ç”¨å’Œåˆ†ç‰‡ç‰¹æ€§ã€‚Redisé›†ç¾¤ä¸éœ€ è¦sentinelå“¨å…µâˆ™ä¹Ÿèƒ½å®ŒæˆèŠ‚ç‚¹ç§»é™¤å’Œæ•…éšœè½¬ç§»çš„åŠŸèƒ½ã€‚éœ€è¦å°†æ¯ä¸ªèŠ‚ç‚¹è®¾ç½®æˆé›†ç¾¤æ¨¡å¼ï¼Œè¿™ç§é›†ç¾¤æ¨¡å¼æ²¡æœ‰ä¸­ å¿ƒèŠ‚ç‚¹ï¼Œå¯æ°´å¹³æ‰©å±•ï¼Œæ®å®˜æ–¹æ–‡æ¡£ç§°å¯ä»¥çº¿æ€§æ‰©å±•åˆ°ä¸Šä¸‡ä¸ªèŠ‚ç‚¹(å®˜æ–¹æ¨èä¸è¶…è¿‡1000ä¸ªèŠ‚ç‚¹)ã€‚redisé›†ç¾¤çš„ æ€§èƒ½å’Œé«˜å¯ç”¨æ€§å‡ä¼˜äºä¹‹å‰ç‰ˆæœ¬çš„å“¨å…µæ¨¡å¼ï¼Œä¸”é›†ç¾¤é…ç½®éå¸¸ç®€å•ã€‚</p><h4 id="_3-1-ç¯å¢ƒæ­å»º" tabindex="-1"><a class="header-anchor" href="#_3-1-ç¯å¢ƒæ­å»º"><span>3.1 ç¯å¢ƒæ­å»º</span></a></h4><h5 id="_3-1-1-å‡†å¤‡å¤šå°redis" tabindex="-1"><a class="header-anchor" href="#_3-1-1-å‡†å¤‡å¤šå°redis"><span>3.1.1 å‡†å¤‡å¤šå°redis</span></a></h5><p>å°†redisçš„é…ç½®æ–‡ä»¶redis.confåˆ°/myredisæ–‡ä»¶å¤¹ä¸­ï¼š</p><div class="language-cmd line-numbers-mode" data-highlighter="shiki" data-ext="cmd" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cmd"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">cp redis.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">conf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">myredis</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/redis.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>ç¼–è¾‘æ‹·è´åçš„redis.confæ–‡ä»¶ï¼ŒæŸ¥æ‰¾<code>bing 127.0.0.1</code>é…ç½®æœ‰æ²¡æœ‰æ³¨é‡Šæ‰ï¼Œæ²¡æœ‰çš„è¯ï¼Œè‡ªå·±æ³¨é‡Šäº†</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>vi /myredis/redis.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>åœ¨/myredisæ–‡ä»¶å¤¹ä¸­ï¼Œæ–°å»ºredis6379.confï¼Œå¡«å†™ä»¥ä¸‹å†…å®¹ï¼š</p><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-properties"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">include /myredis/redis.conf</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">pidfile /var/run/redis_6379.pid</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">daemonize yes</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">port 6379</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">logfile </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;6379.log&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">dir ./6379</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">cluster-enabled yes</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">cluster-config-file nodes-6379.conf</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">cluster-node-timeout 15000</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å¦‚æœè¦è®¾ç½®å¯†ç éœ€è¦å¢åŠ å¦‚ä¸‹é…ç½®ï¼š</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#è®¾ç½®redisè®¿é—®å¯†ç </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">requirepass zyh</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è®¾ç½®é›†ç¾¤èŠ‚ç‚¹é—´è®¿é—®å¯†ç ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">masterauth zyh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è§£é‡Šï¼š</p><ul><li><code>daemonize yes</code>ï¼šdaemonizeå®ˆæŠ¤çº¿ç¨‹ï¼Œé»˜è®¤æ˜¯NOã€daemonizeæ˜¯ç”¨æ¥æŒ‡å®šredisæ˜¯å¦è¦ç”¨å®ˆæŠ¤çº¿ç¨‹çš„æ–¹å¼å¯åŠ¨ï¼Œ</li><li><code>include</code>ï¼šè¡¨ç¤ºå¼•å…¥redis.confçš„é…ç½®ã€‚</li><li><code>pidfile</code> ï¼šä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶å¯åŠ¨åï¼Œredisçš„çº¿ç¨‹idã€‚</li><li><code>port</code>ï¼š ä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶å¯åŠ¨åï¼Œredisçš„ç«¯å£ã€‚</li><li><code>logfile</code>ï¼šä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶å¯åŠ¨åï¼Œæ—¥å¿—ç”Ÿæˆæ–‡ä»¶åç§°ã€‚</li><li><code>dir</code>ï¼šä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶å¯åŠ¨åï¼ŒRDBå’ŒAOFæ•°æ®æŒä¹…åŒ–ç”Ÿæˆçš„æ–‡ä»¶è·¯å¾„</li><li><code>cluster-enabled yes</code>ï¼š æ‰“å¼€é›†ç¾¤æ¨¡å¼</li><li><code>cluster-config-file nodes-6379.conf</code>ï¼š è®¾å®šèŠ‚ç‚¹é…ç½®æ–‡ä»¶å</li><li><code>cluster-node-timeout 15000</code>ï¼š è®¾å®šèŠ‚ç‚¹å¤±è”æ—¶é—´ï¼Œè¶…è¿‡è¯¥æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œé›†ç¾¤è‡ªåŠ¨è¿›è¡Œä¸»ä»åˆ‡æ¢</li></ul><p>åŒæ ·çš„æµç¨‹ï¼Œå¯ä»¥å†æ–°å¢å‡ ä¸ªç«¯å£6380ï¼Œ6381ï¼Œ6382ï¼Œ6383ï¼Œ6384ç­‰ç­‰ï¼Œåªéœ€è¦å°†ä¸Šè¿°é…ç½®æ–‡ä»¶åå’Œæ–‡ä»¶å†…å®¹é‡Œçš„å¯¹åº”æ•°å­—éƒ½ä¿®æ”¹å³å¯ï¼Œåœ¨viå‘½ä»¤è¡Œæ¨¡å¼ä¸‹ä½¿ç”¨<code>%s/6379/6380</code>å‘½ä»¤æ›¿æ¢æ›´å¿« ã€‚</p><p>éƒ½å‡†å¤‡å¥½åï¼Œå¯åŠ¨redisæœåŠ¡å™¨åœ¨/myredisæ–‡ä»¶å¤¹ä¸­ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">redis-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> redis6379.conf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">redis-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> redis6380.conf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">redis-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> redis6381.conf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">redis-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> redis6382.conf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">redis-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> redis6383.conf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">redis-server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> redis6384.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥çœ‹ç³»ç»Ÿè¿›ç¨‹ï¼Œçœ‹çœ‹æœåŠ¡å™¨æ˜¯å¦å¯åŠ¨ï¼š</p><div class="language-cmd line-numbers-mode" data-highlighter="shiki" data-ext="cmd" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cmd"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ps</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ef</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | grep redis</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>åˆ°è¿™å°±å®ç°äº†ï¼Œåœ¨ä¸€å°æœåŠ¡å™¨ä¸­å¯åŠ¨å¤šå°redisã€‚</p><h5 id="_3-1-2-æ„å»ºé›†ç¾¤" tabindex="-1"><a class="header-anchor" href="#_3-1-2-æ„å»ºé›†ç¾¤"><span>3.1.2 æ„å»ºé›†ç¾¤</span></a></h5><p>åœ¨å‰é¢æˆ‘ä»¬å·²ç»å¯åŠ¨äº†6å°redisæœåŠ¡ï¼Œç°åœ¨æˆ‘ä»¬è¦å°†è¿™6å°redisç»„æˆä¸€ä¸ªé›†ç¾¤ï¼Œredis5ä»¥å‰çš„ç‰ˆæœ¬é›†ç¾¤æ˜¯ä¾é rubyè„šæœ¬redisâ€trib.rbå®ç°ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯redis5ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>redis-cli</code>å‘½ä»¤å°±å¯ä»¥ï¼š</p><div class="language-cmd line-numbers-mode" data-highlighter="shiki" data-ext="cmd" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cmd"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">redis</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cli</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> --</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cluster</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> create</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> --</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cluster</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">replicas</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 166.66.66.66</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6379</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 166.66.66.66</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6380</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 166.66.66.66</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6381</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 166.66.66.66</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6382</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 166.66.66.66</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6383</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 166.66.66.66</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6384</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è§£æå‘½ä»¤ï¼š</p><ul><li><p><code>redis-cli --cluster create</code>ï¼šè¡¨ç¤ºæ„å»ºé›†ç¾¤ã€‚</p></li><li><p><code>--cluster-replicas 1</code>ï¼šé›†ç¾¤æ˜¯ç”±ä¸»ä»èŠ‚ç‚¹æ„æˆçš„ï¼Œ<code>--cluster-replicas 1</code>è¡¨ç¤ºæ¯ä¸ªä¸»ä»èŠ‚ç‚¹ä¸­ï¼Œä»èŠ‚ç‚¹çš„ä¸ªæ•°ï¼Œä¾‹å¦‚ä¸Šé¢çš„å‘½ä»¤è¡¨ç¤ºï¼Œä¸€å°ä¸»æœºï¼Œä¸€å°ä»æœºï¼Œæ­£å¥½ä¸‰ç»„ä¸»ä»èŠ‚ç‚¹ã€‚</p></li><li><p><code>166.66.66.66:637*</code>ï¼šè¡¨ç¤ºå‚ä¸æ„å»ºé›†ç¾¤çš„redisæœåŠ¡å™¨ã€‚</p></li></ul><p>éªŒè¯é›†ç¾¤æ˜¯å¦æ„å»ºæˆåŠŸï¼š</p><p>è¿æ¥ä»»æ„ä¸€ä¸ªå®¢æˆ·ç«¯ï¼š</p><div class="language-cmd line-numbers-mode" data-highlighter="shiki" data-ext="cmd" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cmd"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-- â€aè®¿é—®æœåŠ¡ç«¯å¯†ç ï¼Œâ€cè¡¨ç¤ºé›†ç¾¤æ¨¡å¼ï¼ŒæŒ‡å®šipåœ°å€å’Œç«¯å£å·</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">./</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">redis</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">â€cli â€c â€h â€p</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œå¦‚ä¸‹ä¿¡æ¯ï¼š</p><div class="language-cmd line-numbers-mode" data-highlighter="shiki" data-ext="cmd" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cmd"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-- æŸ¥çœ‹é›†ç¾¤ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">cluster info</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-- æŸ¥çœ‹èŠ‚ç‚¹åˆ—è¡¨</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">cluster nodes</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-2-åŸç†è§£æ" tabindex="-1"><a class="header-anchor" href="#_3-2-åŸç†è§£æ"><span>3.2 åŸç†è§£æ</span></a></h4><h5 id="_3-2-1-æ’æ§½" tabindex="-1"><a class="header-anchor" href="#_3-2-1-æ’æ§½"><span>3.2.1 æ’æ§½</span></a></h5><p>â€‹ ä¸€ä¸ª Redis é›†ç¾¤åŒ…å« 16384 ä¸ªæ’æ§½ï¼ˆhash slotï¼‰ï¼Œæ•°æ®åº“ä¸­çš„æ¯ä¸ªé”®éƒ½å±äºè¿™16384ä¸ªæ’æ§½çš„å…¶ä¸­ä¸€ä¸ªï¼Œå½“ Redis Cluster çš„å®¢æˆ·ç«¯æ¥è¿æ¥é›†ç¾¤æ—¶ï¼Œå®ƒä¹Ÿä¼šå¾—åˆ°ä¸€ä»½é›†ç¾¤çš„æ§½ä½é…ç½®ä¿¡æ¯å¹¶å°†å…¶ç¼“å­˜åœ¨å®¢æˆ·ç«¯æœ¬åœ°ã€‚è¿™æ ·å½“å®¢æˆ·ç«¯è¦æŸ¥æ‰¾æŸä¸ª key æ—¶ï¼Œå¯ä»¥ç›´æ¥å®šä½åˆ°ç›®æ ‡èŠ‚ç‚¹ã€‚åŒæ—¶å› ä¸ºæ§½ä½çš„ä¿¡æ¯å¯èƒ½ä¼šå­˜åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¸ ä¸€è‡´çš„æƒ…å†µï¼Œè¿˜éœ€è¦çº æ­£æœºåˆ¶æ¥å®ç°æ§½ä½ä¿¡æ¯çš„æ ¡éªŒè°ƒæ•´ã€‚</p><p>æ§½ä½å®šä½ç®—æ³•ï¼šCluster é»˜è®¤ä¼šå¯¹ key å€¼ä½¿ç”¨ crc16 ç®—æ³•è¿›è¡Œ hash å¾—åˆ°ä¸€ä¸ªæ•´æ•°å€¼ï¼Œç„¶åç”¨è¿™ä¸ªæ•´æ•°å€¼å¯¹ 16384 è¿›è¡Œå–æ¨¡æ¥å¾—åˆ°å…·ä½“æ§½ä½ã€‚ <code>HASH_SLOT = CRC16(key) mod 16384</code></p><p>è·³è½¬é‡å®šä½ï¼šå› ä¸ºæ§½ä½çš„ä¿¡æ¯å¯èƒ½ä¼šå­˜åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¸ ä¸€è‡´çš„æƒ…å†µï¼Œå½“å®¢æˆ·ç«¯å‘ä¸€ä¸ªé”™è¯¯çš„èŠ‚ç‚¹å‘å‡ºäº†æŒ‡ä»¤ï¼Œè¯¥èŠ‚ç‚¹ä¼šå‘ç°æŒ‡ä»¤çš„ key æ‰€åœ¨çš„æ§½ä½å¹¶ä¸å½’è‡ªå·±ç®¡ç†ï¼Œè¿™æ—¶å®ƒä¼šå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªç‰¹æ®Šçš„è·³è½¬æŒ‡ä»¤åŒæ—¶æºå¸¦ç›®æ ‡æ“ä½œçš„èŠ‚ç‚¹åœ°å€ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯å»è¿è¿™ä¸ªèŠ‚ç‚¹å»è·å–æ•°æ®ã€‚å®¢æˆ·ç«¯æ”¶åˆ°æŒ‡ä»¤åé™¤äº†è·³è½¬åˆ°æ­£ç¡®çš„èŠ‚ç‚¹ä¸Šå»æ“ä½œï¼Œè¿˜ä¼šåŒæ­¥æ›´æ–°çº æ­£æœ¬åœ°çš„æ§½ä½æ˜ å°„è¡¨ç¼“å­˜ï¼Œåç»­æ‰€æœ‰ key å°†ä½¿ç”¨æ–°çš„æ§½ ä½æ˜ å°„è¡¨ã€‚ä¾‹å¦‚ï¼š</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>166.66.66.66:6879&gt; set name abc</span></span>
<span class="line"><span>-&gt; Redirected to slot [5798] located at 166.66.66.66:6880 OK</span></span>
<span class="line"><span>166.66.66.66:6880&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-2-2-é€šä¿¡" tabindex="-1"><a class="header-anchor" href="#_3-2-2-é€šä¿¡"><span>3.2.2 é€šä¿¡</span></a></h5><p>redis clusterèŠ‚ç‚¹é—´é‡‡å–gossipåè®®è¿›è¡Œé€šä¿¡ï¼Œgossipåè®®åŒ…å«å¤šç§æ¶ˆæ¯ï¼ŒåŒ…æ‹¬pingï¼Œpongï¼Œmeetï¼Œfailç­‰ç­‰ã€‚</p><ul><li>meetï¼šæŸä¸ªèŠ‚ç‚¹å‘é€meetç»™æ–°åŠ å…¥çš„èŠ‚ç‚¹ï¼Œè®©æ–°èŠ‚ç‚¹åŠ å…¥é›†ç¾¤ä¸­ï¼Œç„¶åæ–°èŠ‚ç‚¹å°±ä¼šå¼€å§‹ä¸å…¶ä»–èŠ‚ç‚¹è¿›è¡Œé€š ä¿¡ï¼›</li><li>pingï¼šæ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šé¢‘ç¹ç»™å…¶ä»–èŠ‚ç‚¹å‘é€pingï¼Œå…¶ä¸­åŒ…å«è‡ªå·±çš„çŠ¶æ€è¿˜æœ‰è‡ªå·±ç»´æŠ¤çš„é›†ç¾¤å…ƒæ•°æ®ï¼Œäº’ç›¸é€šè¿‡ pingäº¤æ¢å…ƒæ•°æ®(ç±»ä¼¼è‡ªå·±æ„ŸçŸ¥åˆ°çš„é›†ç¾¤èŠ‚ç‚¹å¢åŠ å’Œç§»é™¤ï¼Œhash slotä¿¡æ¯ç­‰)ï¼›</li><li>pong: å¯¹pingå’Œmeetæ¶ˆæ¯çš„è¿”å›ï¼ŒåŒ…å«è‡ªå·±çš„çŠ¶æ€å’Œå…¶ä»–ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥ç”¨äºä¿¡æ¯å¹¿æ’­å’Œæ›´æ–°ï¼›</li><li>fail: æŸä¸ªèŠ‚ç‚¹åˆ¤æ–­å¦ä¸€ä¸ªèŠ‚ç‚¹failä¹‹åï¼Œå°±å‘é€failç»™å…¶ä»–èŠ‚ç‚¹ï¼Œé€šçŸ¥å…¶ä»–èŠ‚ç‚¹ï¼ŒæŒ‡å®šçš„èŠ‚ç‚¹å®•æœºäº†ã€‚ gossipåè®®çš„ä¼˜ç‚¹åœ¨äºå…ƒæ•°æ®çš„æ›´æ–°æ¯”è¾ƒåˆ†æ•£ï¼Œä¸æ˜¯é›†ä¸­åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œæ›´æ–°è¯·æ±‚ä¼šé™†é™†ç»­ç»­ï¼Œæ‰“åˆ°æ‰€æœ‰èŠ‚ç‚¹ä¸Šå»æ›´æ–°ï¼Œæœ‰ä¸€å®šçš„å»¶æ—¶ï¼Œé™ä½äº†å‹åŠ›ï¼›ç¼ºç‚¹åœ¨äºå…ƒæ•°æ®æ›´æ–°æœ‰å»¶æ—¶å¯èƒ½å¯¼è‡´é›†ç¾¤çš„ä¸€äº›æ“ä½œä¼šæœ‰ä¸€äº›æ»å</li></ul><p>gossipåè®®çš„ä¼˜ç‚¹åœ¨äºå…ƒæ•°æ®çš„æ›´æ–°æ¯”è¾ƒåˆ†æ•£ï¼Œä¸æ˜¯é›†ä¸­åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œæ›´æ–°è¯·æ±‚ä¼šé™†é™†ç»­ç»­ï¼Œæ‰“åˆ°æ‰€æœ‰èŠ‚ç‚¹ä¸Š å»æ›´æ–°ï¼Œæœ‰ä¸€å®šçš„å»¶æ—¶ï¼Œé™ä½äº†å‹åŠ›ï¼›ç¼ºç‚¹åœ¨äºå…ƒæ•°æ®æ›´æ–°æœ‰å»¶æ—¶å¯èƒ½å¯¼è‡´é›†ç¾¤çš„ä¸€äº›æ“ä½œä¼šæœ‰ä¸€äº›æ»åã€‚</p><p>â€‹ æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªä¸“é—¨ç”¨äºèŠ‚ç‚¹é—´gossipé€šä¿¡çš„ç«¯å£ï¼Œå°±æ˜¯è‡ªå·±æä¾›æœåŠ¡çš„ç«¯å£å·+10000ï¼Œæ¯”å¦‚6379ï¼Œé‚£ä¹ˆç”¨äºèŠ‚ç‚¹é—´é€šä¿¡çš„å°±æ˜¯16379ç«¯å£ã€‚ æ¯ä¸ªèŠ‚ç‚¹æ¯éš”ä¸€æ®µæ—¶é—´éƒ½ä¼šå¾€å¦å¤–å‡ ä¸ªèŠ‚ç‚¹å‘é€pingæ¶ˆæ¯ï¼ŒåŒæ—¶å…¶ä»–å‡ ç‚¹æ¥æ”¶åˆ°pingæ¶ˆæ¯ä¹‹åè¿”å›pongæ¶ˆæ¯ã€‚</p><p>ç½‘ç»œæŠ–åŠ¨ï¼šçœŸå®ä¸–ç•Œçš„æœºæˆ¿ç½‘ç»œå¾€å¾€å¹¶ä¸æ˜¯é£å¹³æµªé™çš„ï¼Œå®ƒä»¬ç»å¸¸ä¼šå‘ç”Ÿå„ç§å„æ ·çš„å°é—®é¢˜ã€‚æ¯”å¦‚ç½‘ç»œæŠ–åŠ¨å°±æ˜¯éå¸¸å¸¸è§ çš„ä¸€ç§ç°è±¡ï¼Œçªç„¶ä¹‹é—´éƒ¨åˆ†è¿æ¥å˜å¾—ä¸å¯è®¿é—®ï¼Œç„¶åå¾ˆå¿«åˆæ¢å¤æ­£å¸¸ã€‚ ä¸ºè§£å†³è¿™ç§é—®é¢˜ï¼ŒRedis Cluster æä¾›äº†ä¸€ç§é€‰é¡¹<code>cluster-node-timeout</code>ï¼Œè¡¨ç¤ºå½“æŸä¸ªèŠ‚ç‚¹æŒç»­ timeout çš„æ—¶é—´å¤±è”æ—¶ï¼Œæ‰å¯ä»¥è®¤å®šè¯¥èŠ‚ç‚¹å‡ºç°æ•…éšœï¼Œéœ€è¦è¿›è¡Œä¸»ä»åˆ‡æ¢ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªé€‰é¡¹ï¼Œç½‘ç»œæŠ–åŠ¨ä¼šå¯¼è‡´ä¸»ä»é¢‘ç¹åˆ‡æ¢ (æ•°æ®çš„é‡æ–°å¤åˆ¶)</p><h5 id="_3-2-3-redisé›†ç¾¤é€‰ä¸¾åŸç†åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_3-2-3-redisé›†ç¾¤é€‰ä¸¾åŸç†åˆ†æ"><span>3.2.3 Redisé›†ç¾¤é€‰ä¸¾åŸç†åˆ†æ</span></a></h5><p>å½“slaveå‘ç°è‡ªå·±çš„masterå˜ä¸ºFAILçŠ¶æ€æ—¶ï¼Œä¾¿å°è¯•è¿›è¡ŒFailoverï¼Œä»¥æœŸæˆä¸ºæ–°çš„masterã€‚ç”±äºæŒ‚æ‰çš„masterå¯èƒ½ä¼šæœ‰å¤šä¸ªslaveï¼Œä»è€Œå­˜åœ¨å¤šä¸ªslaveç«äº‰æˆä¸ºmasterèŠ‚ç‚¹çš„è¿‡ç¨‹ï¼Œ å…¶è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li>slaveå‘ç°è‡ªå·±çš„masterå˜ä¸ºFAIL</li><li>å°†è‡ªå·±è®°å½•çš„é›†ç¾¤currentEpochåŠ 1ï¼Œå¹¶å¹¿æ’­FAILOVER_AUTH_REQUESTä¿¡æ¯</li><li>å…¶ä»–èŠ‚ç‚¹æ”¶åˆ°è¯¥ä¿¡æ¯ï¼Œåªæœ‰masterä¼šå“åº”ï¼Œä¼šåˆ¤æ–­è¯·æ±‚è€…çš„åˆæ³•æ€§ï¼Œå¹¶å‘é€FAILOVER_AUTH_ACKï¼Œå¯¹æ¯ä¸€ä¸ª epochåªå‘é€ä¸€æ¬¡ack</li><li>å°è¯•failoverçš„slaveæ”¶é›†masterè¿”å›çš„FAILOVER_AUTH_ACK</li><li>slaveæ”¶åˆ°è¶…è¿‡åŠæ•°masterçš„ackåå˜æˆæ–°Master</li><li>slaveå¹¿æ’­Pongæ¶ˆæ¯é€šçŸ¥å…¶ä»–é›†ç¾¤èŠ‚ç‚¹</li></ul><p>æ³¨æ„ï¼šä»èŠ‚ç‚¹å¹¶ä¸æ˜¯åœ¨ä¸»èŠ‚ç‚¹ä¸€è¿›å…¥ FAIL çŠ¶æ€å°±é©¬ä¸Šå°è¯•å‘èµ·é€‰ä¸¾ï¼Œè€Œæ˜¯æœ‰ä¸€å®šå»¶è¿Ÿï¼Œä¸€å®šçš„å»¶è¿Ÿç¡®ä¿æˆ‘ä»¬ç­‰å¾… FAILçŠ¶æ€åœ¨é›†ç¾¤ä¸­ä¼ æ’­ï¼Œslaveå¦‚æœç«‹å³å°è¯•é€‰ä¸¾ï¼Œå…¶å®ƒmastersæˆ–è®¸å°šæœªæ„è¯†åˆ°FAILçŠ¶æ€ï¼Œå¯èƒ½ä¼šæ‹’ç»æŠ•ç¥¨ã€‚å»¶è¿Ÿè®¡ç®—å…¬å¼ï¼š<code>DELAY = 500ms + random(0 ~ 500ms) + SLAVE_RANK * 1000ms</code>ï¼ŒSLAVE_RANKè¡¨ç¤ºæ­¤slaveå·²ç»ä»masterå¤åˆ¶æ•°æ®çš„æ€»é‡çš„rankã€‚rankè¶Šå°ä»£è¡¨å·²å¤åˆ¶çš„æ•°æ®è¶Šæ–°ã€‚è¿™ç§æ–¹å¼ä¸‹æŒæœ‰æœ€æ–°æ•°æ®çš„slaveå°†ä¼šé¦–å…ˆå‘èµ·é€‰ä¸¾ï¼ˆç†è®ºä¸Šï¼‰ã€‚</p><h5 id="_3-2-4-é›†ç¾¤è„‘è£‚æ•°æ®ä¸¢å¤±é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#_3-2-4-é›†ç¾¤è„‘è£‚æ•°æ®ä¸¢å¤±é—®é¢˜"><span>3.2.4 é›†ç¾¤è„‘è£‚æ•°æ®ä¸¢å¤±é—®é¢˜</span></a></h5><p>redisé›†ç¾¤æ²¡æœ‰è¿‡åŠæœºåˆ¶ä¼šæœ‰è„‘è£‚é—®é¢˜ï¼Œç½‘ç»œæ³¢åŠ¨å¯¼è‡´æ–°é€‰å‡ºçš„masterå’Œä»¥å‰ç”±äºç½‘ç»œæ³¢åŠ¨ä»¥ä¸ºæ­»äº¡çš„masterèŠ‚ç‚¹éƒ½èƒ½å¯¹å¤–æä¾›å†™æœåŠ¡ï¼Œä¸€æ—¦ç½‘ç»œæ¢å¤ï¼Œå…¶ä¸­ä¸€ä¸ªä¸»èŠ‚ç‚¹å°†å˜ä¸ºä»èŠ‚ç‚¹ï¼Œä½†æ˜¯ï¼Œè¿™ä¸ªä¸»èŠ‚ç‚¹ä¹Ÿå¯¹å¤–æä¾›äº†å†™æœåŠ¡ï¼Œå¦‚æœå˜æˆä»èŠ‚ç‚¹ä¼šæœ‰å¤§é‡æ•°æ®ä¸¢å¤±ã€‚ è§„é¿æ–¹æ³•å¯ä»¥åœ¨redisé…ç½®é‡ŒåŠ ä¸Šå‚æ•°</p><div class="language-properties line-numbers-mode" data-highlighter="shiki" data-ext="properties" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-properties"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # å†™æ•°æ®æˆåŠŸæœ€å°‘åŒæ­¥çš„slaveæ•°é‡ï¼Œè¿™ä¸ªæ•°é‡å¯ä»¥æ¨¡ä»¿å¤§äºåŠæ•°æœºåˆ¶é…ç½®ï¼Œ</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # æ¯”å¦‚ä¸»ä»é›†ç¾¤æ€»å…±ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œé‚£å°±å¯ä»¥é…ç½®1ï¼Œè¿™æ—¶åªè¦ä¸€ä¸ªslaveèŠ‚ç‚¹åŒæ­¥äº†æ•°æ®ï¼ŒåŠ ä¸ŠmasterèŠ‚ç‚¹ï¼Œè¶…è¿‡äº†åŠæ•° </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> minâ€replicasâ€toâ€write 1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼š</p><ul><li>è¿™ç§æ–¹æ³•ä¸å¯èƒ½ç™¾åˆ†ç™¾é¿å…æ•°æ®ä¸¢å¤±ï¼Œå› ä¸ºè™½ç„¶ä¿è¯äº†ç”±ä¸€åŠçš„slaveèŠ‚ç‚¹åŒæ­¥äº†æ•°æ®ï¼Œä½†æ˜¯å¹¶ä¸èƒ½ä¿è¯ï¼ŒmasterèŠ‚ç‚¹æ˜¯ä»è¿™ä¸€åŠçš„slaveèŠ‚ç‚¹ä¸­é€‰å‡ºçš„ã€‚</li><li>è¿™ä¸ªé…ç½®åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¼šå½±å“é›†ç¾¤çš„å¯ç”¨æ€§ï¼Œæ¯”å¦‚slaveè¦æ˜¯å°‘äº1ä¸ªï¼Œè¿™ä¸ªä¸»ä»é›†ç¾¤å°±ç®—masteræ­£å¸¸ä¹Ÿä¸èƒ½æä¾›æœåŠ¡äº†ï¼Œæ‰€ä»¥éœ€è¦å…·ä½“åœºæ™¯æƒè¡¡é€‰æ‹©ã€‚</li></ul><h5 id="_3-2-5-é›†ç¾¤æ˜¯å¦å®Œæ•´æ‰èƒ½å¯¹å¤–æä¾›æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_3-2-5-é›†ç¾¤æ˜¯å¦å®Œæ•´æ‰èƒ½å¯¹å¤–æä¾›æœåŠ¡"><span>3.2.5 é›†ç¾¤æ˜¯å¦å®Œæ•´æ‰èƒ½å¯¹å¤–æä¾›æœåŠ¡</span></a></h5><p>å½“redis.confçš„é…ç½®<code>cluster-require-full-coverage</code>ä¸ºnoæ—¶ï¼Œè¡¨ç¤ºå½“è´Ÿè´£ä¸€ä¸ªæ’æ§½çš„ä¸»åº“ä¸‹çº¿ä¸”æ²¡æœ‰ç›¸åº”çš„ä»åº“è¿›è¡Œæ•…éšœæ¢å¤æ—¶ï¼Œé›†ç¾¤ä»ç„¶å¯ç”¨ï¼ˆæ’æ§½å€¼ä¸è½åœ¨æ•…éšœæ’æ§½åº“å¯ç”¨ï¼‰ï¼Œå¦‚æœä¸ºyesåˆ™é›†ç¾¤ä¸å¯ç”¨ï¼Œä¸ç®¡æ’æ§½å€¼è½ä¸è½åœ¨æ•…éšœæ’æ§½åº“éƒ½ä¸å¯ç”¨ã€‚</p><h5 id="_3-3-5-redisé›†ç¾¤å¯¹æ‰¹é‡æ“ä½œå‘½ä»¤çš„æ”¯æŒ" tabindex="-1"><a class="header-anchor" href="#_3-3-5-redisé›†ç¾¤å¯¹æ‰¹é‡æ“ä½œå‘½ä»¤çš„æ”¯æŒ"><span>3.3.5 Redisé›†ç¾¤å¯¹æ‰¹é‡æ“ä½œå‘½ä»¤çš„æ”¯æŒ</span></a></h5><p>å¯¹äºç±»ä¼¼msetï¼Œmgetè¿™æ ·çš„å¤šä¸ªkeyçš„åŸç”Ÿæ‰¹é‡æ“ä½œå‘½ä»¤ï¼Œredisé›†ç¾¤åªæ”¯æŒæ‰€æœ‰keyè½åœ¨åŒä¸€slotçš„æƒ…å†µï¼Œå¦‚æœæœ‰å¤šä¸ªkeyä¸€å®šè¦ç”¨msetå‘½ä»¤åœ¨redisé›†ç¾¤ä¸Šæ“ä½œï¼Œåˆ™å¯ä»¥åœ¨keyçš„å‰é¢åŠ ä¸Š{XX}ï¼Œè¿™æ ·å‚æ•°æ•°æ®åˆ†ç‰‡hashè®¡ç®—çš„åªä¼šæ˜¯å¤§æ‹¬å·é‡Œçš„å€¼ï¼Œè¿™æ ·èƒ½ç¡®ä¿ä¸åŒçš„keyèƒ½è½åˆ°åŒä¸€sloté‡Œå»ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class="language-cmd line-numbers-mode" data-highlighter="shiki" data-ext="cmd" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cmd"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">mset {user}:name zyh {user}:age </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">18</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å‡è®¾<code>{user}:name</code>å’Œ<code>{user}:age</code>è®¡ç®—çš„hash slotå€¼ä¸ä¸€æ ·ï¼Œä½†æ˜¯è¿™æ¡å‘½ä»¤åœ¨é›†ç¾¤ä¸‹æ‰§è¡Œï¼Œredisåªä¼šå¯¹å¤§æ‹¬å·é‡Œçš„useråšhash slotè®¡ç®—ï¼Œæ‰€ä»¥ç®—å‡ºæ¥çš„slotå€¼è‚¯å®šç›¸åŒï¼Œæœ€åéƒ½èƒ½è½åœ¨åŒä¸€slotã€‚</p></div><!----><!----><!----></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">æœ€è¿‘æ›´æ–°</span><time class="vp-meta-info" datetime="2025-09-06T08:18:22.000Z" data-allow-mismatch>2025/9/6 08:18</time></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 898362059@qq.pcom">zyh1020</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><!----><a class="route-link auto-link next" href="/vuepress/blog/Redis/Redis%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%EF%BC%8C%E9%94%81%E5%92%8C%E4%BA%8B%E5%8A%A1.html" aria-label="Rediså‘å¸ƒè®¢é˜…ï¼Œé”å’Œäº‹åŠ¡"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">Rediså‘å¸ƒè®¢é˜…ï¼Œé”å’Œäº‹åŠ¡<iconify-icon class="vp-icon" icon="fa6-solid:file-lines" sizing="height" height="1em"></iconify-icon></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">è±«ICPå¤‡2022026603å·</div><div class="vp-copyright">Copyright Â© 2025 Ms.Zyh </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script src="/vuepress/assets/js/runtime~app.60ce2f83.js" defer></script><script src="/vuepress/assets/js/5967.2f754431.js" defer></script><script src="/vuepress/assets/js/app.d77a90c1.js" defer></script>
  </body>
</html>
